"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7438],{97438:function(e,a,t){t.r(a),t.d(a,{FeedbackPrompt:function(){return w}});var s=t(57437),r=t(2265),l=t(50116),c=t(27815),i=t(85754),o=t(55340),n=t(39868),d=t(94658),m=t(1657),x=t(42706),h=t(54900),u=t(45179),f=t(49842),b=t(23444),p=t(11981),g=t(45509),N=t(63572),j=t(6771);let v=["wrong_make","wrong_model","wrong_year","price_too_high","price_too_low","missing_features","other"];function y(e){let{open:a,onClose:t,onSubmit:c,carFeatures:o,predictedPrice:n}=e,d=(0,l.useTranslations)("feedback.detailed"),[m,y]=(0,r.useState)([]),[k,w]=(0,r.useState)(""),[_,C]=(0,r.useState)(""),[F,S]=(0,r.useState)(""),[M,D]=(0,r.useState)(),[B,z]=(0,r.useState)(),[E,R]=(0,r.useState)({}),[Z,P]=(0,r.useState)([]),[V,Y]=(0,r.useState)({}),[A,q]=(0,r.useState)([]),[I,T]=(0,r.useState)(!1);(0,r.useEffect)(()=>{a&&H()},[a]);let H=async()=>{T(!0);try{let e=await N.apiClient.getMakes(),a=Array.isArray(e)&&e.length>0?[...e].sort((e,a)=>e.localeCompare(a)):[...j.CAR_MAKES].sort((e,a)=>e.localeCompare(a));P(a);let t=a.map(async e=>{try{let a=await N.apiClient.getModels(e);return{make:e,models:a}}catch(a){return{make:e,models:[]}}}),s=await Promise.all(t),r={};s.forEach(e=>{let{make:a,models:t}=e;r[a]=t}),Y(r)}catch(e){console.error("Error loading makes and models:",e)}finally{T(!1)}};(0,r.useEffect)(()=>{_&&V[_]?(q(V[_]),F&&!V[_].includes(F)&&S("")):q([])},[_,V,F]);let K=e=>{y(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e]),E.reasons&&R(e=>({...e,reasons:""}))};return(0,s.jsx)(x.Vq,{open:a,onOpenChange:t,children:(0,s.jsxs)(x.cZ,{className:"max-w-2xl max-h-[90vh] overflow-y-auto bg-[#1a1d29] border-[#2a2d3a] text-white",children:[(0,s.jsxs)(x.fK,{children:[(0,s.jsx)(x.$N,{className:"text-xl",children:d("title")}),(0,s.jsx)(x.Be,{className:"text-[#94a3b8]",children:d("description")})]}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(f._,{className:"text-base font-medium",children:d("whatWasWrong")}),(0,s.jsx)("div",{className:"space-y-3",children:v.map(e=>(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)(h.X,{id:e,checked:m.includes(e),onCheckedChange:()=>K(e),className:"mt-1"}),(0,s.jsx)(f._,{htmlFor:e,className:"flex-1 cursor-pointer text-sm leading-relaxed",children:d("reasons.".concat(e))})]},e))}),E.reasons&&(0,s.jsxs)("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[(0,s.jsx)(p.Z,{className:"h-4 w-4"}),E.reasons]})]}),m.length>0&&(0,s.jsxs)("div",{className:"space-y-4 p-4 bg-[#2a2d3a] rounded-lg border border-[#3a3d4a]",children:[(0,s.jsxs)(f._,{className:"text-base font-medium text-white",children:[d("whatShouldItHaveBeen")," ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("p",{className:"text-sm text-[#94a3b8] mb-4",children:d("whatShouldItHaveBeenDesc")}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(f._,{htmlFor:"correct_make",className:"text-sm font-medium",children:[d("correctMake")," ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),I?(0,s.jsx)("div",{className:"text-sm text-[#94a3b8]",children:"Loading makes..."}):(0,s.jsxs)(g.Ph,{value:_||void 0,onValueChange:e=>{C(e),S(""),E.correctMake&&R(e=>({...e,correctMake:""}))},children:[(0,s.jsx)(g.i4,{className:"bg-[#1a1d29] border-[#2a2d3a] text-white focus:ring-2 focus:ring-[#8B5CF6]/50 focus:border-[#8B5CF6]",children:(0,s.jsx)(g.ki,{placeholder:"Select make (current: ".concat(o.make,")")})}),(0,s.jsx)(g.Bw,{className:"max-h-[60vh] overflow-y-auto bg-[#1a1d29] border-[#2a2d3a] z-[1200]",children:Z.length>0?Z.map(e=>(0,s.jsx)(g.Ql,{value:e,className:"text-white hover:bg-[#2a2d3a] focus:bg-[#8B5CF6]/20 focus:text-white",children:e},e)):(0,s.jsx)("div",{className:"p-2 text-center text-[#94a3b8] text-sm",children:"No makes available"})})]}),E.correctMake&&(0,s.jsxs)("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[(0,s.jsx)(p.Z,{className:"h-4 w-4"}),E.correctMake]})]}),_&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(f._,{htmlFor:"correct_model",className:"text-sm font-medium",children:[d("correctModel")," ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),A.length>0?(0,s.jsxs)(g.Ph,{value:F||void 0,onValueChange:e=>{S(e),E.correctModel&&R(e=>({...e,correctModel:""}))},children:[(0,s.jsx)(g.i4,{className:"bg-[#1a1d29] border-[#2a2d3a] text-white focus:ring-2 focus:ring-[#8B5CF6]/50 focus:border-[#8B5CF6]",children:(0,s.jsx)(g.ki,{placeholder:"Select model (current: ".concat(o.model,")")})}),(0,s.jsx)(g.Bw,{className:"max-h-[60vh] overflow-y-auto bg-[#1a1d29] border-[#2a2d3a] z-[1200]",children:A.map(e=>(0,s.jsx)(g.Ql,{value:e,className:"text-white hover:bg-[#2a2d3a] focus:bg-[#8B5CF6]/20 focus:text-white",children:e},e))})]}):(0,s.jsx)(u.I,{id:"correct_model",value:F,onChange:e=>{S(e.target.value),E.correctModel&&R(e=>({...e,correctModel:""}))},placeholder:"Enter model (current: ".concat(o.model,")"),className:"bg-[#1a1d29] border-[#2a2d3a] text-white"}),E.correctModel&&(0,s.jsxs)("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[(0,s.jsx)(p.Z,{className:"h-4 w-4"}),E.correctModel]})]}),m.includes("wrong_year")&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(f._,{htmlFor:"correct_year",className:"text-sm font-medium",children:[d("correctYear")," ",(0,s.jsx)("span",{className:"text-[#94a3b8] text-xs",children:"(optional)"})]}),(0,s.jsx)(u.I,{id:"correct_year",type:"number",value:M||"",onChange:e=>D(e.target.value?parseInt(e.target.value):void 0),placeholder:"Enter year (current: ".concat(o.year,")"),min:"1900",max:"2025",className:"bg-[#1a1d29] border-[#2a2d3a] text-white"})]}),(m.includes("price_too_high")||m.includes("price_too_low"))&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(f._,{htmlFor:"correct_price",className:"text-sm font-medium",children:[d("correctPrice")," ",(0,s.jsx)("span",{className:"text-[#94a3b8] text-xs",children:"(optional)"})]}),(0,s.jsx)(u.I,{id:"correct_price",type:"number",value:B||"",onChange:e=>z(e.target.value?parseFloat(e.target.value):void 0),placeholder:"Enter price (predicted: ".concat(n.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}),")"),min:"0",step:"100",className:"bg-[#1a1d29] border-[#2a2d3a] text-white"})]})]}),m.includes("other")&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(f._,{htmlFor:"other_details",className:"text-sm font-medium",children:[d("otherDetails")," ",(0,s.jsx)("span",{className:"text-red-500",children:"*"}),(0,s.jsxs)("span",{className:"text-[#94a3b8] text-xs font-normal ml-2",children:["(",d("otherDetailsHint"),")"]})]}),(0,s.jsx)(b.g,{id:"other_details",value:k,onChange:e=>{w(e.target.value),E.otherDetails&&R(e=>({...e,otherDetails:""}))},placeholder:d("otherDetailsPlaceholder"),rows:4,className:"bg-[#1a1d29] border-[#2a2d3a] resize-none",maxLength:500}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-[#94a3b8]",children:[(0,s.jsxs)("span",{children:[k.length,"/500 ",d("characters")]}),E.otherDetails&&(0,s.jsx)("span",{className:"text-red-500",children:E.otherDetails})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,s.jsx)(i.z,{onClick:t,variant:"outline",className:"flex-1 border-[#2a2d3a] hover:bg-[#2a2d3a]",children:d("cancel")}),(0,s.jsx)(i.z,{onClick:()=>{let e={};if(0===m.length&&(e.reasons=d("errors.selectReason")),m.includes("other")&&(!k||k.length<50?e.otherDetails=d("errors.otherDetailsMin"):k.length>500&&(e.otherDetails=d("errors.otherDetailsMax"))),m.length>0&&(_.trim()||(e.correctMake=d("errors.correctMakeRequired")),F.trim()||(e.correctModel=d("errors.correctModelRequired"))),m.includes("wrong_make")&&!_.trim()&&(e.correctMake=d("errors.correctMakeRequired")),m.includes("wrong_model")&&!F.trim()&&(e.correctModel=d("errors.correctModelRequired")),Object.keys(e).length>0){R(e);return}c({feedback_reasons:m,correct_make:_.trim()||void 0,correct_model:F.trim()||void 0,correct_year:M,correct_price:B,other_details:k.trim()||void 0}),y([]),w(""),C(""),S(""),D(void 0),z(void 0),R({})},className:"flex-1 bg-[#5B7FFF] hover:bg-[#4a6fef]",children:d("submit")})]})]})]})})}var k=t(25703);function w(e){let{predictionId:a,result:t,carFeatures:x,onFeedbackSubmitted:h}=e,u=(0,l.useTranslations)("feedback"),[f,b]=(0,r.useState)(null),[p,g]=(0,r.useState)(null),[j,v]=(0,r.useState)(!1),[w,_]=(0,r.useState)(!1),[C,F]=(0,r.useState)(!1),[S,M]=(0,r.useState)(null),{toast:D}=(0,k.useToast)(),B=t.precision?Math.round(100-t.precision):"high"===t.confidence_level?90:"medium"===t.confidence_level?75:60,z=async e=>{g(e),b(e?5:1),e?await R({rating:5,is_accurate:!0,feedback_type:"accurate"}):v(!0)},E=async e=>{b(e),g(e>=4),e<4?v(!0):await R({rating:e,is_accurate:!0,feedback_type:"accurate"})},R=async e=>{try{_(!0),M(null),await N.apiClient.submitFeedback({prediction_id:a,...e,feedback_type:"accurate"===e.feedback_type||"inaccurate"===e.feedback_type||"partial"===e.feedback_type?e.feedback_type:void 0}),F(!0),D({title:"Thank you!",description:"Your feedback helps us improve.",variant:"default"}),h&&h()}catch(a){console.error("Error submitting feedback:",a);let e=(null==a?void 0:a.message)||"Sorry, couldn't save feedback. Please try again.";M(e),D({title:"Error",description:e,variant:"destructive"})}finally{_(!1)}},Z=async e=>{try{await R({rating:f||void 0,is_accurate:p||void 0,feedback_type:"inaccurate",...e}),v(!1)}catch(e){console.error("Error in detailed feedback submission:",e)}};return C?(0,s.jsx)(c.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29]",children:(0,s.jsxs)(c.aY,{className:"py-6 text-center",children:[(0,s.jsx)("div",{className:"text-green-500 text-2xl mb-2",children:"âœ“"}),(0,s.jsx)("p",{className:"text-white font-medium",children:u("thankYou")||"Thank you! Your feedback helps us improve."})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29]",children:[(0,s.jsx)(c.Ol,{children:(0,s.jsx)(c.ll,{className:"text-lg",children:u("title")})}),(0,s.jsxs)(c.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-[#2a2d3a] rounded-lg",children:[(0,s.jsxs)("span",{className:"text-sm font-medium text-white",children:[u("aiConfidence"),":"]}),(0,s.jsxs)("span",{className:"text-lg font-semibold text-[#5B7FFF]",children:[B,"%"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm text-[#94a3b8]",children:u("starRating")}),(0,s.jsx)("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>(0,s.jsx)("button",{onClick:()=>E(e),disabled:w,className:(0,m.cn)("transition-all duration-200 hover:scale-110",f&&f>=e?"text-yellow-400":"text-[#2a2d3a] hover:text-yellow-400/50"),children:(0,s.jsx)(o.Z,{className:(0,m.cn)("h-8 w-8",f&&f>=e?"fill-current":"")})},e))})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,s.jsxs)(i.z,{onClick:()=>z(!0),disabled:w||!0===p,variant:!0===p?"default":"outline",className:(0,m.cn)("flex-1",!0===p?"bg-green-600 hover:bg-green-700 border-green-600":"border-[#2a2d3a] hover:bg-[#2a2d3a]"),children:[(0,s.jsx)(n.Z,{className:"h-4 w-4 mr-2"}),u("accurate")||"Accurate"]}),(0,s.jsxs)(i.z,{onClick:()=>z(!1),disabled:w||!1===p,variant:!1===p?"default":"outline",className:(0,m.cn)("flex-1",!1===p?"bg-red-600 hover:bg-red-700 border-red-600":"border-[#2a2d3a] hover:bg-[#2a2d3a]"),children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),u("notAccurate")||"Not Accurate"]})]}),S&&(0,s.jsx)("div",{className:"mt-3 p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm text-red-400",children:S})}),w&&(0,s.jsx)("div",{className:"mt-3 text-center",children:(0,s.jsx)("p",{className:"text-sm text-[#94a3b8]",children:"Submitting feedback..."})})]})]}),j&&(0,s.jsx)(y,{open:j,onClose:()=>v(!1),onSubmit:Z,carFeatures:x,predictedPrice:t.predicted_price})]})}},54900:function(e,a,t){t.d(a,{X:function(){return o}});var s=t(57437),r=t(2265),l=t(66062),c=t(1657),i=t(62442);let o=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(l.fC,{ref:a,className:(0,c.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-[#2a2d3a] bg-[#0f1117] ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#5B7FFF] focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-[#5B7FFF] data-[state=checked]:text-white data-[state=checked]:border-[#5B7FFF]",t),...r,children:(0,s.jsx)(l.z$,{className:(0,c.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(i.Z,{className:"h-4 w-4"})})})});o.displayName=l.fC.displayName},42706:function(e,a,t){t.d(a,{$N:function(){return f},Be:function(){return b},Vq:function(){return o},cN:function(){return u},cZ:function(){return x},fK:function(){return h},hg:function(){return n}});var s=t(57437),r=t(2265),l=t(79515),c=t(82549),i=t(1657);let o=l.fC,n=l.xz,d=l.h_;l.x8;let m=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(l.aV,{ref:a,className:(0,i.cn)("fixed inset-0 z-[1100] bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});m.displayName=l.aV.displayName;let x=r.forwardRef((e,a)=>{let{className:t,children:r,...o}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(m,{}),(0,s.jsxs)(l.VY,{ref:a,className:(0,i.cn)("fixed left-[50%] top-[50%] z-[1100] grid w-full max-w-lg max-h-[90vh] overflow-y-auto overscroll-contain translate-x-[-50%] translate-y-[-50%] gap-4 border border-slate-200 dark:border-[#2a2d3a] bg-white dark:bg-[#1a1d29] p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o,children:[r,(0,s.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 text-slate-600 dark:text-[#94a3b8]"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=l.VY.displayName;let h=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};h.displayName="DialogHeader";let u=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};u.displayName="DialogFooter";let f=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(l.Dx,{ref:a,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight text-slate-900 dark:text-white",t),...r})});f.displayName=l.Dx.displayName;let b=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(l.dk,{ref:a,className:(0,i.cn)("text-sm text-slate-600 dark:text-[#94a3b8]",t),...r})});b.displayName=l.dk.displayName},23444:function(e,a,t){t.d(a,{g:function(){return c}});var s=t(57437),r=t(2265),l=t(1657);let c=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-lg border border-slate-200 dark:border-white/10 bg-white dark:bg-white/[0.03] backdrop-blur-sm px-4 py-3 text-base text-slate-900 dark:text-white/90 ring-offset-background placeholder:text-slate-400 dark:placeholder:text-white/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500/30 focus-visible:ring-offset-2 focus-visible:border-indigo-500 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-300 hover:border-indigo-500/50 dark:hover:border-indigo-500/50 hover:bg-slate-50 dark:hover:bg-white/[0.05] resize-none",t),ref:a,...r})});c.displayName="Textarea"}}]);