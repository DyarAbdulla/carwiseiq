"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6478,5922,5498],{31478:function(e,t,i){i.d(t,{C:function(){return s}});var n=i(57437),r=i(2265),o=i(1657);let s=r.forwardRef((e,t)=>{let{className:i,variant:r="default",...s}=e,a={default:"bg-[#5B7FFF] text-white",success:"bg-green-600 text-white",warning:"bg-yellow-600 text-white",destructive:"bg-red-600 text-white",secondary:"bg-[#2a2d3a] text-[#94a3b8]",outline:"border border-[#2a2d3a] text-white"};return(0,n.jsx)("div",{ref:t,className:(0,o.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",a[r]||a.default,i),...s})});s.displayName="Badge"},85754:function(e,t,i){i.d(t,{z:function(){return a}});var n=i(57437),r=i(2265),o=i(67256),s=i(1657);let a=r.forwardRef((e,t)=>{let{className:i,variant:r="default",size:a="default",asChild:l=!1,...u}=e,d=l?o.g7:"button";return(0,n.jsx)(d,{className:(0,s.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{default:"bg-[#5B7FFF] text-white hover:bg-[#4a6fff]",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-slate-300 dark:border-[#2a2d3a] bg-transparent hover:bg-slate-100 dark:hover:bg-[#2a2d3a] text-slate-900 dark:text-white",secondary:"bg-slate-100 dark:bg-[#2a2d3a] text-slate-900 dark:text-white hover:bg-slate-200 dark:hover:bg-[#3a3d4a]",ghost:"hover:bg-slate-100 dark:hover:bg-[#2a2d3a] text-slate-900 dark:text-white",link:"text-[#5B7FFF] underline-offset-4 hover:underline"}[r],{default:"h-10 sm:h-10 px-4 py-2 min-h-[48px] sm:min-h-[40px]",sm:"h-9 sm:h-9 rounded-md px-3 min-h-[48px] sm:min-h-[36px]",lg:"h-11 sm:h-11 rounded-md px-8 min-h-[48px] sm:min-h-[44px]",icon:"h-10 w-10 sm:h-10 sm:w-10 min-h-[48px] min-w-[48px] sm:min-h-[40px] sm:min-w-[40px]"}[a],i),ref:t,...u})});a.displayName="Button"},25703:function(e,t,i){i.r(t),i.d(t,{ToastProvider:function(){return a},useToast:function(){return l}});var n=i(57437),r=i(2265),o=i(1657);let s=r.createContext({toast:()=>{}});function a(e){let{children:t}=e,[i,a]=r.useState([]),l=r.useCallback(e=>{var t;let i=Math.random().toString(36).substring(7);a(t=>[...t,{...e,id:i}]),setTimeout(()=>{a(e=>e.filter(e=>e.id!==i))},null!==(t=e.duration)&&void 0!==t?t:5e3)},[]);return(0,n.jsxs)(s.Provider,{value:{toast:l},children:[t,(0,n.jsx)("div",{className:"fixed bottom-0 right-0 z-[1200] flex w-full flex-col-reverse gap-2 p-4 sm:flex-col md:max-w-[420px]",children:i.map(e=>(0,n.jsxs)("div",{className:(0,o.cn)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md p-6 pr-8 shadow-lg transition-all","destructive"===e.variant?"border border-red-500/50 bg-red-950/30":"border border-[#2a2d3a] bg-[#1a1d29]"),children:[(0,n.jsxs)("div",{className:"grid gap-1",children:[e.title&&(0,n.jsx)("div",{className:(0,o.cn)("text-sm font-semibold","destructive"===e.variant?"text-red-200":"text-white"),children:e.title}),e.description&&(0,n.jsx)("div",{className:(0,o.cn)("text-sm","destructive"===e.variant?"text-red-300/90":"text-[#94a3b8]"),children:e.description})]}),(0,n.jsx)("button",{onClick:()=>a(t=>t.filter(t=>t.id!==e.id)),className:"absolute right-2 top-2 rounded-md p-1 text-[#94a3b8] opacity-0 transition-opacity hover:text-white focus:opacity-100 focus:outline-none group-hover:opacity-100",children:"\xd7"})]},e.id))})]})}function l(){return r.useContext(s)||{toast:e=>{"destructive"===e.variant&&console.error("Error:",e.description)}}}},35498:function(e,t,i){i.d(t,{activityHelpers:function(){return l},j:function(){return o}});var n=i(45922);let r="carwiseiq_activity_log";function o(e){try{let t=JSON.parse(localStorage.getItem(r)||"[]"),i=Array.isArray(t)?t:[];if(e)return i.filter(t=>!t.user_id||t.user_id===e);return i}catch(e){return[]}}let s=!1;async function a(e){var t,i,o,a;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u={type:e,entity_id:(null===(t=l.entity_id)||void 0===t?void 0:t.toString())||null,metadata:l};try{let{data:{session:t}}=await n.supabase.auth.getSession(),l=null==t?void 0:null===(i=t.user)||void 0===i?void 0:i.id;if(!function(e){try{let t=JSON.parse(localStorage.getItem(r)||"[]"),i={...e,id:"local_".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2)),created_at:new Date().toISOString()};t.unshift(i),localStorage.setItem(r,JSON.stringify(t.slice(0,200)))}catch(e){}}({...u,user_id:l}),s||!l)return;let{error:d}=await n.supabase.from("user_activity").insert({user_id:l,type:e,entity_id:u.entity_id,metadata:u.metadata});if(!d)return;("PGRST205"===d.code||(null===(o=d.message)||void 0===o?void 0:o.includes("Could not find the table"))||(null===(a=d.message)||void 0===a?void 0:a.includes("404")))&&(s=!0)}catch(e){}}let l={logPrediction:e=>{var t;return a("prediction",{entity_id:(null===(t=e.predictionId)||void 0===t?void 0:t.toString())||null,car_make:e.make,car_model:e.model,car_year:e.year,predicted_price:e.predictedPrice})},logCompare:(e,t)=>a("compare",{entity_id:e.join(","),comparison_count:t,compared_ids:e.map(e=>e.toString())}),logViewListing:(e,t)=>a("view_listing",{entity_id:e.toString(),listing_title:t}),logFavorite:(e,t)=>a("favorite",{entity_id:e.toString(),action:t?"added":"removed"}),logCreateListing:(e,t,i)=>a("create_listing",{entity_id:e.toString(),listing_title:t,listing_price:i}),logEditListing:(e,t)=>a("edit_listing",{entity_id:e.toString(),listing_title:t}),logMarkSold:(e,t)=>a("mark_sold",{entity_id:e.toString(),listing_title:t}),logPredictionCreated:e=>l.logPrediction(e),logPredictionSaved:e=>a("prediction",{entity_id:e.toString()}),logComparisonSaved:(e,t)=>l.logCompare(t,e),logComparisonViewed:e=>l.logCompare(e,e.length),logListingViewed:(e,t)=>l.logViewListing(e,t),logListingCreated:(e,t,i)=>l.logCreateListing(e,t,i),logListingEdited:(e,t)=>l.logEditListing(e,t),logListingSold:(e,t)=>l.logMarkSold(e,t),logListingAvailable:(e,t)=>a("edit_listing",{entity_id:e.toString(),listing_title:t,action:"marked_available"}),logFavoriteAdded:e=>l.logFavorite(e,!0),logFavoriteRemoved:e=>l.logFavorite(e,!1)}},45922:function(e,t,i){i.d(t,{supabase:function(){return n}});let n=(0,i(33226).eI)("https://fehkzrrahgyesxzrwlme.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZlaGt6cnJhaGd5ZXN4enJ3bG1lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkxNzcwNjEsImV4cCI6MjA4NDc1MzA2MX0.AI8QaX8nOP8UwcfmgbGN2EN4jmK94i98Kpd3ZtPDZRQ",{auth:{lock:(e,t,i)=>i()}})},57245:function(e,t,i){i.d(t,{_:function(){return g}});var n=i(2265),r=i(45922);let o={session:null,sessionLoaded:!1,user:null},s=new Set,a=!1,l=null,u=()=>{s.forEach(e=>e())},d=null,c=async()=>{if(!a)return d||(d=(async()=>{if(a)return;a=!0;try{let{data:{session:e},error:t}=await r.supabase.auth.getSession();t&&console.error("[useAuthSession] getSession error:",t),o={session:e?{user:e.user}:null,sessionLoaded:!0,user:(null==e?void 0:e.user)||null},u()}catch(e){console.error("[useAuthSession] getSession exception:",e),o={session:null,sessionLoaded:!0,user:null},u()}l=r.supabase.auth.onAuthStateChange((e,t)=>{o={session:t?{user:t.user}:null,sessionLoaded:!0,user:(null==t?void 0:t.user)||null},u()}).data.subscription;let e=async()=>{try{let{data:{session:e}}=await r.supabase.auth.getSession();o={session:e?{user:e.user}:null,sessionLoaded:!0,user:(null==e?void 0:e.user)||null},u()}catch(e){console.error("[useAuthSession] Focus refresh error:",e)}},t=async()=>{"visible"===document.visibilityState&&await e()};window.addEventListener("focus",e),document.addEventListener("visibilitychange",t),window.addEventListener("beforeunload",()=>{l&&(l.unsubscribe(),l=null),window.removeEventListener("focus",e),document.removeEventListener("visibilitychange",t)})})())};function g(){let[e,t]=(0,n.useState)(o),i=(0,n.useRef)(!0);(0,n.useEffect)(()=>(i.current=!0,()=>{i.current=!1}),[]),(0,n.useEffect)(()=>{let e=()=>{i.current&&t({...o})};return s.add(e),c().then(()=>{i.current&&t({...o})}).catch(e=>{console.error("[useAuthSession] Initialization error:",e),i.current&&t({...o})}),i.current&&t({...o}),()=>{s.delete(e)}},[]);let a=(0,n.useCallback)(async()=>{try{let{data:{session:e}}=await r.supabase.auth.getSession();o={session:e?{user:e.user}:null,sessionLoaded:!0,user:(null==e?void 0:e.user)||null},u()}catch(e){console.error("[useAuthSession] Manual refresh error:",e)}},[]);return{session:e.session,user:e.user,sessionLoaded:e.sessionLoaded,isAuthenticated:!!e.user,refreshSession:a}}},1657:function(e,t,i){i.d(t,{cb:function(){return d},cn:function(){return o},gQ:function(){return u},uf:function(){return a},wo:function(){return c},xG:function(){return s}});var n=i(57042),r=i(74769);function o(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,r.m6)((0,n.W)(t))}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function a(e){return new Intl.NumberFormat("en-US").format(e)}function l(e){return e<=0||!isFinite(e)?0:Math.round(235.214583/e*10)/10}function u(e,t){let i=l(e),n=l(t);return"".concat(i," / ").concat(n," L/100km")}function d(e){return null!=e&&"string"==typeof e&&/\.(mp4|mov|avi)(\?|$)/i.test(e)}function c(e,t){var i;if(null==e||"string"!=typeof e||!e)return"";if(e.startsWith("http://")||e.startsWith("https://"))return e;let n=(null!==(i=null!=t?t:"http://localhost:8000")&&void 0!==i?i:"").replace(/\/$/,"");return n?n+(e.startsWith("/")?e:"/"+e):e}}}]);