(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6708],{80607:function(e,t,a){Promise.resolve().then(a.bind(a,77646))},77646:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ed}});var i=a(57437),r=a(2265),l=a(50116),n=a(24033),s=a(85754),o=a(61865),d=a(38110),c=a(93134);a(4380);var u=a(45179),m=a(49842),p=a(45509),h=a(76683),x=a(40992),g=a(63572),f=a(6771),v=a(25703),y=a(72700),b=a(4479),w=a(81291),j=a(17158),N=a(64280),k=a(98777),S=a(81809);c.Ry({make:c.Z_().min(1,"Make is required"),model:c.Z_().min(1,"Model is required"),trim:c.Z_().optional(),year:c.Rx().min(1900).max(2025)}),c.Ry({mileage:c.Rx().min(0).max(1e6),engine_size:c.Rx({required_error:"Engine size is required"}).min(.5).max(10),cylinders:c.Rx().min(2).max(12),fuel_type:c.Z_().min(1)}),c.Ry({condition:c.Z_().min(1),location:c.Z_().min(1)});let E=c.Ry({year:c.Rx().min(1900).max(2025),mileage:c.Rx().min(0).max(1e6),engine_size:c.Rx({required_error:"Engine size is required"}).min(.5,{message:"Engine size must be at least 0.5L"}).max(10,{message:"Engine size must be at most 10.0L"}),cylinders:c.Rx().min(2).max(12),make:c.Z_().min(1),model:c.Z_().min(1),trim:c.Z_().optional(),condition:c.Z_().min(1),fuel_type:c.Z_().min(1),location:c.Z_().min(1),color:c.Z_().optional()});function _(e){let{onSubmit:t,loading:a=!1,prefillData:n=null,onFormChange:c,onStepChange:_,formId:C}=e;(0,r.useEffect)(()=>{},[C,t]);let z=(0,l.useTranslations)("predict.form"),{toast:F}=(0,v.useToast)()||{toast:()=>{}},[V,I]=(0,r.useState)(1),T=(e,t)=>{try{let a=z(e);return"string"==typeof a?a:t||e}catch(a){return t||e}},[D,M]=(0,r.useState)([]),[P,A]=(0,r.useState)({}),[R,L]=(0,r.useState)([]),[Z,B]=(0,r.useState)([]),[G,O]=(0,r.useState)([]),[q,H]=(0,r.useState)(f.t9),[Y,U]=(0,r.useState)(f.kd),[Q,W]=(0,r.useState)(f.ws),[$,J]=(0,r.useState)(f.QG),[X,K]=(0,r.useState)(f.ST.make||""),[ee,et]=(0,r.useState)(f.ST.model||""),[ea,ei]=(0,r.useState)([]),[er,el]=(0,r.useState)([]),[en,es]=(0,r.useState)([]),[eo,ed]=(0,r.useState)([]),[ec,eu]=(0,r.useState)(!0),[em,ep]=(0,r.useState)(!1),[eh,ex]=(0,r.useState)(!1),[eg,ef]=(0,r.useState)(!1),[ev,ey]=(0,r.useState)(!1),[eb,ew]=(0,r.useState)(!1),[ej,eN]=(0,r.useState)(!1),[ek,eS]=(0,r.useState)(!1),eE=(0,b.C)(3e5),e_=(0,r.useRef)(new Map),eC=(0,o.cI)({resolver:(0,d.F)(E),shouldUnregister:!1,defaultValues:n?{year:n.year,mileage:n.mileage,engine_size:n.engine_size,cylinders:n.cylinders,make:n.make,model:n.model,trim:n.trim||"",condition:n.condition,fuel_type:n.fuel_type,location:n.location,color:n.color||""}:{year:f.ST.year,mileage:f.ST.mileage,engine_size:f.ST.engine_size,cylinders:f.ST.cylinders,make:f.ST.make,model:f.ST.model,trim:"",condition:f.ST.condition,fuel_type:f.ST.fuel_type,location:f.ST.location,color:""}}),ez=eC.watch("make"),eF=eC.watch("model"),eV=eC.watch("year"),eI=eC.watch("engine_size");eC.watch("mileage"),eC.watch("cylinders"),eC.watch("fuel_type"),eC.watch("condition"),eC.watch("location"),(0,r.useEffect)(()=>{ez&&ez!==X?K(ez):!ez&&X&&K("")},[ez,X]),(0,r.useEffect)(()=>{(!X||!ee)&&(X&&ee||(em||(eC.getValues("trim"),eC.setValue("trim","",{shouldDirty:!0,shouldTouch:!0}),eC.clearErrors("trim")),B([])))},[X,ee,eC,em]);let eT=(0,y.N)(ez,1e3),eD=(0,y.N)(eF,1e3),eM=(0,y.N)(eI,1e3);(0,r.useEffect)(()=>{(async()=>{try{let e=await g.apiClient.getAllEngineSizes();ei(e),!eC.getValues("engine_size")&&e.length>0&&eC.setValue("engine_size",e[0].size)}catch(e){console.error("Error loading all engine sizes:",e),ei([1,1.2,1.4,1.5,1.6,1.8,2,2.5,3,3.5,4,5,6].map(e=>({size:e,display:e===Math.floor(e)?"".concat(Math.floor(e),"L"):"".concat(e,"L")})))}})()},[]),(0,r.useEffect)(()=>{e_.current.forEach(e=>e.abort()),e_.current.clear(),eT&&eD&&""!==eT.trim()&&""!==eD.trim()?(eG(eT,eD),eO(eT,eD),eH(eT,eD),eY(eT,eD)):(el(ea),ed([]),B([]),em||(eC.getValues("trim"),eC.setValue("trim","",{shouldValidate:!0}),eC.clearErrors("trim")),1===V&&eC.trigger(["make","model","trim","year"]),eZ())},[eT,eD,ea]),(0,r.useEffect)(()=>{eT&&eD&&eM&&""!==eT.trim()&&""!==eD.trim()?eq(eT,eD,eM):es([])},[eT,eD,eM]);let eP=(0,r.useRef)({}),eA=(0,r.useRef)(!1);(0,r.useEffect)(()=>{if(!c||eA.current)return;let e={make:ez,model:eF,year:eV};(eP.current.make!==e.make||eP.current.model!==e.model||eP.current.year!==e.year)&&(e.make||e.model||e.year)&&(C&&c&&c(C,{make:e.make,model:e.model,year:e.year}),eP.current=e)},[ez,eF,eV,C,c]),(0,r.useEffect)(()=>{var e,t,a,i,r,l;if(!n)return;let s=eC.getValues(),o=s.make&&s.model,d=s.trim&&"string"==typeof s.trim&&""!==s.trim.trim(),c=!n.make&&!n.model&&!n.year,u=!n.trim||"string"==typeof n.trim&&""===n.trim.trim();if(o&&c||d&&u)return;eA.current=!0;let m={make:n.make||n.makeValue||"",model:n.model||n.modelValue||"",year:n.year||n.yearValue||2020,mileage:null!==(t=null!==(e=n.mileage)&&void 0!==e?e:n.mileageValue)&&void 0!==t?t:0,engine_size:null!==(i=null!==(a=n.engine_size)&&void 0!==a?a:n.engineSize)&&void 0!==i?i:2,cylinders:null!==(l=null!==(r=n.cylinders)&&void 0!==r?r:n.cylindersValue)&&void 0!==l?l:4,trim:n.trim||n.trimValue||"",condition:n.condition||n.conditionValue||"Good",fuel_type:n.fuel_type||n.fuelType||"Gasoline",location:n.location||n.locationValue||"",color:n.color||n.colorValue||""},p={year:m.year,mileage:m.mileage,engine_size:m.engine_size,cylinders:m.cylinders,make:m.make,model:m.model,trim:m.trim,condition:m.condition,fuel_type:m.fuel_type,location:m.location,color:m.color};eP.current={make:m.make,model:m.model,year:m.year},eC.reset(p),eC.getValues("trim"),K(m.make),et(m.model),eL(m.make,!0),eC.trigger(),requestAnimationFrame(()=>{eA.current=!1})},[n]),(0,r.useEffect)(()=>{let e=!0;return(async()=>{if(e){var t,a;eu(!0);let i=null!==(t=(await Promise.all([eB(),eU(),eZ()]))[1])&&void 0!==t?t:[];if(e){let e=(null===(a=eC.getValues("location"))||void 0===a?void 0:a.trim())||"";if(!(e&&(null==i?void 0:i.some(t=>t.trim().toLowerCase()===e.toLowerCase())))&&(null==i?void 0:i.length)>0){let e=i[0];eC.setValue("location",e,{shouldValidate:!0,shouldDirty:!1})}let t=f.ST.make||eC.getValues("make"),r=f.ST.model||eC.getValues("model");t&&""!==t.trim()&&(K(t),eL(t),r&&""!==r.trim()&&(et(r),await eG(t,r))),ea.length>0&&el(ea),eu(!1)}}})(),()=>{e=!1}},[]);let eR=(0,r.useCallback)(async e=>{if(!e||""===e.trim()){L([]),eS(!1);return}let t="models:".concat(C||"default",":").concat(e),a=e_.current.get(t);a&&a.abort();let i=new AbortController;e_.current.set(t,i),eS(!0);try{let a=await g.apiClient.getModels(e);if(i.signal.aborted||X!==e){e_.current.delete(t),eS(!1);return}let r=Array.isArray(a)?a:a?[a]:[];r.length>0?(A(t=>({...t,[e]:r})),L(r)):L([])}catch(a){if("AbortError"===a.name){e_.current.delete(t),eS(!1);return}console.error("[Compare] Error loading models for ".concat(C,":").concat(e,":"),a),L([]),eS(!1)}finally{e_.current.get(t)===i&&(e_.current.delete(t),X===e&&eS(!1))}},[X,C]),eL=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||""===e.trim()){L([]),eS(!1),t||(eC.setValue("model",""),et(""));return}let a=P[e];a&&Array.isArray(a)&&a.length>0?(L([...a]),eS(!1)):eR(e),t||(eC.setValue("model",""),et(""),B([]),eC.clearErrors("trim"))},[P,eC,eR,C]);(0,r.useEffect)(()=>{X?eL(X):(L([]),eS(!1))},[X,eL]),(0,r.useEffect)(()=>{Array.isArray(R)||L([])},[R]);let eZ=async()=>{ex(!0);try{let e=await g.apiClient.getMetadata();e.conditions.length>0&&H(e.conditions),e.fuel_types.length>0&&U(e.fuel_types),e.year_range&&W(e.year_range),e.mileage_range&&J(e.mileage_range)}catch(e){}finally{ex(!1)}},eB=async()=>{try{let e=await g.apiClient.getMakes(),t=Array.isArray(e)?e:[];M(t.length>0?t:[]);let a=t.map(async e=>{try{let t=await g.apiClient.getModels(e),a=Array.isArray(t)?t:[];return{make:e,models:a}}catch(t){return console.error("Error loading models for ".concat(e,":"),t),{make:e,models:[]}}}),i=await Promise.all(a),r={};i.forEach(e=>{let{make:t,models:a}=e,i=Array.isArray(a)?a:[];r[t]=i.length>0?i:[]}),A(r);let l=f.ST.make||eC.getValues("make");l&&r[l]&&Array.isArray(r[l])&&r[l].length>0&&L([...r[l]])}catch(e){console.error("Error loading makes and models:",e),M([]),A({}),L([])}},eG=async(e,t)=>{if(em)return;if(!e||!t||""===e.trim()||""===t.trim()){eC.getValues("trim"),B([]),eC.setValue("trim",""),eC.clearErrors("trim");return}let a="trims:".concat(e,":").concat(t),i=e_.current.get(a);i&&i.abort();let r=new AbortController;e_.current.set(a,r),ep(!0);try{let i=await eE.getOrFetch(a,async()=>{try{return await g.apiClient.getTrims(e,t)}catch(e){throw e.name,e}});if(r.signal.aborted)return;i.length>0?(eC.getValues("trim"),B(i)):(B([]),eC.setValue("trim","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0})),eC.clearErrors("trim")}catch(e){if("AbortError"===e.name)return;console.error("Error loading trims:",e),B([]),eC.setValue("trim","",{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),eC.clearErrors("trim")}finally{e_.current.delete(a),ep(!1)}},eO=async(e,t)=>{if(eg||!e||!t||""===e.trim()||""===t.trim()){el(ea);return}let a="engines:".concat(e,":").concat(t),i=e_.current.get(a);i&&i.abort();let r=new AbortController;e_.current.set(a,r),ef(!0);try{let i=await eE.getOrFetch(a,async()=>{try{return await g.apiClient.getAvailableEngines(e,t)}catch(e){throw e.name,e}});if(r.signal.aborted)return;i.length>0?(el(i),1===i.length&&i[0].size&&(eC.setValue("engine_size",i[0].size),await eq(e,t,i[0].size))):el(ea)}catch(e){if("AbortError"===e.name)return;console.error("Error loading engines:",e),el(ea)}finally{e_.current.delete(a),ef(!1)}},eq=async(e,t,a)=>{if(ev||!e||!t||""===e.trim()||""===t.trim()||!a){es([]);return}let i="cylinders:".concat(e,":").concat(t,":").concat(a),r=e_.current.get(i);r&&r.abort();let l=new AbortController;e_.current.set(i,l),ey(!0);try{let r=await eE.getOrFetch(i,async()=>{try{return await g.apiClient.getAvailableCylinders(e,t,a)}catch(e){throw e.name,e}});if(l.signal.aborted)return;es(r),1===r.length&&r[0]?eC.setValue("cylinders",r[0]):r.length>0&&!r.includes(eC.getValues("cylinders"))&&r[0]&&eC.setValue("cylinders",r[0])}catch(e){if("AbortError"===e.name)return;console.error("Error loading cylinders:",e),es([4])}finally{e_.current.delete(i),ey(!1)}},eH=async(e,t)=>{if(eb||!e||!t||""===e.trim()||""===t.trim()){ed([]);return}let a="colors:".concat(e,":").concat(t),i=e_.current.get(a);i&&i.abort();let r=new AbortController;e_.current.set(a,r),ew(!0);try{let i=await eE.getOrFetch(a,async()=>{try{return await g.apiClient.getAvailableColors(e,t)}catch(e){throw e.name,e}});if(r.signal.aborted)return;ed(i)}catch(e){if("AbortError"===e.name)return;console.error("Error loading colors:",e),ed(["White","Black","Silver","Gray","Red","Blue","Green","Gold","Brown","Orange","Yellow","Purple","Beige","Other"])}finally{e_.current.delete(a),ew(!1)}},eY=async(e,t)=>{if(!e||!t||""===e.trim()||""===t.trim()){try{let e=await eE.getOrFetch("metadata",()=>g.apiClient.getMetadata());e.fuel_types.length>0&&U(e.fuel_types)}catch(e){U(f.kd)}return}if(ej)return;let a="fuelTypes:".concat(e,":").concat(t),i=e_.current.get(a);i&&i.abort();let r=new AbortController;e_.current.set(a,r),eN(!0);try{let i=await eE.getOrFetch(a,async()=>{try{return await g.apiClient.getAvailableFuelTypes(e,t)}catch(e){throw e.name,e}});if(r.signal.aborted)return;if(i.length>0){U(i);let e=eC.getValues("fuel_type");1===i.length?eC.setValue("fuel_type",i[0]):e&&!i.includes(e)&&eC.setValue("fuel_type",i[0])}else try{let e=await eE.getOrFetch("metadata",()=>g.apiClient.getMetadata());e.fuel_types.length>0?U(e.fuel_types):U(f.kd)}catch(e){U(f.kd)}}catch(e){if("AbortError"===e.name)return;console.error("Error loading fuel types:",e);try{let e=await eE.getOrFetch("metadata",()=>g.apiClient.getMetadata());e.fuel_types.length>0?U(e.fuel_types):U(f.kd)}catch(e){U(f.kd)}}finally{e_.current.delete(a),eN(!1)}},eU=async()=>{let e=["Baghdad","Erbil","Basra","Mosul","Dubai","California","Texas","New York"];try{let t=await g.apiClient.getLocations(),a=(null==t?void 0:t.length)>0?t:e;return O(a),a}catch(t){return O(e),e}},eQ=async()=>{if(1===V){let e=await eC.trigger(["make","model","trim","year"],{shouldFocus:!0}),t=Object.entries(eC.formState.errors).filter(e=>{let[t]=e;return["make","model","trim","year"].includes(t)}).filter(e=>{let[t,a]=e;return a});if(!e||t.length>0){let e=t.map(e=>{let[t,a]=e;return"".concat(t,": ").concat((null==a?void 0:a.message)||"required")});F({title:"Please fill in all required fields",description:e.length>0?"Missing: ".concat(e.join(", ")):"Please fill in Make, Model, Trim, and Year",variant:"destructive"});return}}else if(2===V){let e=await eC.trigger(["mileage","engine_size","cylinders","fuel_type"],{shouldFocus:!0}),t=Object.entries(eC.formState.errors).filter(e=>{let[t]=e;return["mileage","engine_size","cylinders","fuel_type"].includes(t)}).filter(e=>{let[t,a]=e;return a});if(!e||t.length>0){let e=t.map(e=>{let[t,a]=e;return"".concat(t,": ").concat((null==a?void 0:a.message)||"required")});F({title:"Please fill in all required fields",description:e.length>0?"Missing: ".concat(e.join(", ")):"Please fill in all Step 2 fields",variant:"destructive"});return}}let e=Math.min(V+1,3);I(e),C&&_&&_(C,e),window.scrollTo({top:0,behavior:"smooth"})},eW=(0,r.useRef)(V);(0,r.useEffect)(()=>{C&&_&&V!==eW.current&&(eW.current=V,_(C,V))},[C,_,V]);let e$=async e=>{let a=["Gasoline","Diesel","Electric","Hybrid","Plug-in Hybrid","Other"],i=String(e.fuel_type).trim();if(!a.includes(i)){console.error("❌ [PredictionForm] Invalid fuel type:",{formId:C,fuelType:i,validFuelTypes:a}),eC.setError("fuel_type",{type:"manual",message:"Fuel type must be one of: ".concat(a.join(", "))}),F({title:"Invalid Fuel Type",description:"Fuel type must be one of: ".concat(a.join(", ")),variant:"destructive"});return}let r={...e,trim:String(e.trim).trim(),year:Number(e.year),mileage:Number(e.mileage),engine_size:Number(e.engine_size),cylinders:Number(e.cylinders),make:String(e.make).trim(),model:String(e.model).trim(),condition:String(e.condition).trim(),fuel_type:i,location:String(e.location).trim(),color:e.color&&""!==e.color.trim()?String(e.color).trim():void 0},l=["make","model","trim","year","mileage","engine_size","cylinders","condition","fuel_type","location"].filter(e=>{let t=r[e];return!!(null==t||"number"==typeof t&&isNaN(t))||"string"==typeof t&&""===t.trim()});if(l.length>0){console.error("❌ [PredictionForm] Missing required fields:",{formId:C,missingFields:l,cleanedData:r}),F({title:"Missing Required Fields",description:"Please fill in: ".concat(l.join(", ")),variant:"destructive"});return}try{if(!t){console.error("❌ [PredictionForm] onSubmit is not defined!",{formId:C}),F({title:"Submission Error",description:"Form submission handler is not configured",variant:"destructive"});return}await t(r)}catch(e){console.error("❌ [PredictionForm] Error calling onSubmit:",{formId:C,error:e,errorStack:e instanceof Error?e.stack:void 0}),F({title:"Submission Error",description:e instanceof Error?e.message:"Failed to submit form",variant:"destructive"})}},eJ=async()=>{if(!t){console.error("❌ [PredictionForm] onSubmit is undefined!",{formId:C}),F({title:"Submission Error",description:"Form submission handler is not configured. Please refresh the page.",variant:"destructive"});return}eC.getValues(),eC.formState.errors,eC.formState.touchedFields,eC.formState.dirtyFields,eC.formState.isValid;let e=eC.getValues("trim");if(!e||"string"==typeof e&&""===e.trim()){let e=eC.watch("trim");e&&""!==e.trim()?(eC.setValue("trim",e,{shouldValidate:!1,shouldDirty:!0,shouldTouch:!0}),eC.getValues("trim")):console.error("[TRIM DEBUG] [handleFinalSubmit] Trim is empty and watched value is also empty!")}eC.getValues("trim");let a=await eC.trigger(void 0,{shouldFocus:!0}),i=eC.formState.errors;if(eC.getValues(),!a){let e=Object.entries(i).filter(e=>{let[t,a]=e;return a}).map(e=>{let[t]=e;return t}),t=e.some(e=>["make","model","trim","year"].includes(e)),a=e.some(e=>["mileage","engine_size","cylinders","fuel_type"].includes(e));t?(I(1),C&&_&&_(C,1),window.scrollTo({top:0,behavior:"smooth"})):a&&(I(2),C&&_&&_(C,2),window.scrollTo({top:0,behavior:"smooth"}));let r=Object.entries(i).filter(e=>{let[t,a]=e;return a}).map(e=>{let[t,a]=e;return"".concat(t,": ").concat((null==a?void 0:a.message)||"required")});F({title:"Validation Failed",description:r.length>0?"Missing: ".concat(r.join(", ")):"Please fill in all required fields",variant:"destructive"});return}await eC.handleSubmit(async e=>{await (null==t?void 0:t(e))})()},eX=()=>{let e=eC.getValues();if(1===V){let t="string"==typeof e.make&&""!==e.make.trim(),a="string"==typeof e.model&&""!==e.model.trim(),i="number"==typeof e.year&&e.year>=1900&&e.year<=2025;return t&&a&&i}if(2===V){let t="number"==typeof e.mileage&&e.mileage>=0&&!isNaN(e.mileage),a="number"==typeof e.engine_size&&e.engine_size>0&&!isNaN(e.engine_size),i="number"==typeof e.cylinders&&e.cylinders>=2&&!isNaN(e.cylinders),r="string"==typeof e.fuel_type&&""!==e.fuel_type.trim();return t&&a&&i&&r}return 3===V&&!!(e.condition&&e.location)};return(0,i.jsxs)("form",{onSubmit:eC.handleSubmit(e$),className:"space-y-6 overflow-visible relative",children:[(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsxs)("span",{className:"text-sm font-medium text-slate-400",children:["Step ",V," of 3"]}),(0,i.jsx)("div",{className:"flex gap-2",children:[1,2,3].map(e=>(0,i.jsx)("div",{className:"h-2 w-8 rounded-full transition-all duration-300 ".concat(e===V?"bg-indigo-500":e<V?"bg-green-500":"bg-white/10")},e))})]}),(0,i.jsx)("div",{className:"h-1 bg-white/10 rounded-full overflow-hidden",children:(0,i.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-300",style:{width:"".concat(V/3*100,"%")}})})]}),(0,i.jsxs)("div",{className:"min-h-[400px] relative",children:[(0,i.jsxs)("div",{className:"space-y-6 transition-all duration-300 ".concat(1===V?"relative opacity-100 translate-x-0 z-10":"absolute inset-0 opacity-0 -translate-x-4 pointer-events-none z-0"),children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-white",children:T("vehicleDetails","Vehicle Details")}),(0,i.jsx)("p",{className:"text-sm text-slate-400",children:T("vehicleDetailsDesc","Let's start with the basics.")})]}),(0,i.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,i.jsxs)(k.E.div,{className:"space-y-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},children:[(0,i.jsx)(S.I,{content:S.l.make,children:(0,i.jsx)(m._,{htmlFor:"".concat(C||"form","-make"),children:z("make")})}),(0,i.jsx)(h.V,{id:"".concat(C||"form","-make"),name:"make",value:eC.watch("make")||"",onValueChange:e=>{e&&e!==X?(eC.setValue("make",e),K(e)):e||(eC.setValue("make",""),K(""),L([]))},options:Array.isArray(D)?D:[],placeholder:ec?"Loading...":"Type to search makes...",disabled:ec,emptyMessage:"No makes available",searchPlaceholder:"Type to search..."},"".concat(C||"form","-make-").concat(X||"none"))]}),(0,i.jsxs)(k.E.div,{className:"space-y-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.05},children:[(0,i.jsx)(S.I,{content:S.l.model,children:(0,i.jsx)(m._,{htmlFor:"".concat(C||"form","-model"),children:z("model")})}),(0,i.jsx)(h.V,{id:"".concat(C||"form","-model"),name:"model",value:eC.watch("model")||"",onValueChange:e=>{eC.setValue("model",e),et(e),el([]),es([]),B([]),eC.clearErrors("trim")},options:Array.isArray(R)&&R.length>0?R:[],placeholder:ez?ek?"Loading models...":R.length>0?"Type to search models...":"No models available":"Select make first",disabled:!ez||ek,emptyMessage:ez?ek?"Loading models...":"No models found for ".concat(ez):"Select a make first",searchPlaceholder:"Type to search..."},"".concat(C||"form","-model-").concat(X||"none"))]}),(0,i.jsxs)(k.E.div,{className:"space-y-2 sm:col-span-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.15},children:[(0,i.jsx)(S.I,{content:S.l.trim,children:(0,i.jsx)(m._,{htmlFor:"".concat(C||"form","-trim"),children:"Trim"})}),(0,i.jsxs)(p.Ph,{id:"".concat(C||"form","-trim"),value:eC.watch("trim")||"",onValueChange:e=>{eC.setValue("trim",e,{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),eC.clearErrors("trim"),eC.getValues("trim"),setTimeout(()=>{let t=eC.getValues("trim");t!==e&&(console.error("[TRIM DEBUG] [Select] VALUE NOT PERSISTED! Expected:",e,"Got:",t),console.error("[TRIM DEBUG] [Select] Retrying setValue..."),eC.setValue("trim",e,{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}))},100)},disabled:!X||!ee||em,children:[(0,i.jsx)(p.i4,{className:eC.formState.errors.trim?"border-red-500":"",children:(0,i.jsx)(p.ki,{placeholder:em?"Loading trims...":X&&ee?Z.length>0?"Select trim level":"No trims available":"Select make and model first"})}),(0,i.jsx)(p.Bw,{className:"max-h-[300px]",children:em?(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"Loading trims..."}):Z.length>0?Z.map(e=>(0,i.jsx)(p.Ql,{value:e,className:"text-white",children:e},e)):X&&ee?(0,i.jsxs)("div",{className:"p-2 text-center text-[#94a3b8] text-xs",children:["No trim variants found for ",X," ",ee," in our dataset."]}):(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"Select make and model first"})})]}),eC.formState.errors.trim&&(0,i.jsx)("p",{className:"text-sm text-red-400 mt-1",children:eC.formState.errors.trim.message}),!eC.formState.errors.trim&&X&&ee&&Z.length>0&&(0,i.jsx)("p",{className:"text-xs text-[#94a3b8] mt-1",children:"ℹ️ Trim level is required and affects price prediction."})]}),(0,i.jsxs)(k.E.div,{className:"space-y-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:[(0,i.jsx)(S.I,{content:S.l.year,children:(0,i.jsxs)(m._,{htmlFor:"".concat(C||"form","-year"),children:[z("year"),": ",eC.watch("year")]})}),(0,i.jsx)(x.i,{id:"".concat(C||"form","-year"),name:"year",value:[eC.watch("year")],onValueChange:e=>{let[t]=e;return eC.setValue("year",t)},min:Q.min,max:Q.max,step:1,className:"w-full"}),eC.formState.errors.year&&(0,i.jsx)("p",{className:"text-sm text-red-400",children:eC.formState.errors.year.message})]})]})]}),(0,i.jsxs)("div",{className:"space-y-6 transition-all duration-300 ".concat(2===V?"relative opacity-100 translate-x-0 z-10":"absolute inset-0 opacity-0 -translate-x-4 pointer-events-none z-0"),children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Engine & Usage"}),(0,i.jsx)("p",{className:"text-sm text-slate-400",children:"Tell us a bit more about the car's specs."})]}),(0,i.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,i.jsxs)(k.E.div,{className:"space-y-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1},children:[(0,i.jsx)(S.I,{content:S.l.mileage,children:(0,i.jsxs)(m._,{htmlFor:"".concat(C||"form","-mileage"),children:[z("mileage")," (km)"]})}),(0,i.jsx)(u.I,{id:"".concat(C||"form","-mileage"),type:"number",className:"border-white/20 md:border-white/10 bg-white/5 ".concat(eC.formState.errors.mileage?"border-red-500":""),...eC.register("mileage",{valueAsNumber:!0})}),eC.formState.errors.mileage&&(0,i.jsx)("p",{className:"text-sm text-red-400",children:eC.formState.errors.mileage.message})]}),(0,i.jsxs)(k.E.div,{className:"space-y-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.25},children:[(0,i.jsx)(S.I,{content:S.l.engine_size,children:(0,i.jsxs)(m._,{htmlFor:"".concat(C||"form","-engine_size"),children:[z("engineSize")," ",(0,i.jsx)("span",{className:"text-red-400",children:"*"})]})}),(0,i.jsxs)(p.Ph,{id:"".concat(C||"form","-engine_size"),name:"engine_size",value:null!=eC.watch("engine_size")&&eC.watch("engine_size")>0?eC.watch("engine_size").toString():"",onValueChange:e=>{if(e&&""!==e){let t=parseFloat(e);eC.setValue("engine_size",t),eC.clearErrors("engine_size"),X&&ee&&eq(X,ee,t)}},disabled:eg||0===ea.length&&0===er.length,children:[(0,i.jsx)(p.i4,{className:eC.formState.errors.engine_size?"border-red-500":"",children:(0,i.jsx)(p.ki,{placeholder:eg?"Loading...":ea.length>0||er.length>0?"Select engine size":"Loading engine sizes..."})}),(0,i.jsx)(p.Bw,{className:"max-h-[300px]",children:eg?(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"Loading engines..."}):er.length>0||ea.length>0?(er.length>0?er:ea).map(e=>(0,i.jsx)(p.Ql,{value:e.size.toString(),className:"text-white",children:e.display},e.size)):(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"No engine sizes available"})})]}),eC.formState.errors.engine_size&&(0,i.jsx)("p",{className:"text-sm text-red-400 mt-1",children:eC.formState.errors.engine_size.message}),!eC.formState.errors.engine_size&&(0,i.jsx)("p",{className:"text-xs text-[#94a3b8] mt-1",children:"ℹ️ Engine size is required and affects price prediction."})]}),(0,i.jsxs)(k.E.div,{className:"space-y-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.3},children:[(0,i.jsx)(S.I,{content:S.l.cylinders,children:(0,i.jsx)(m._,{htmlFor:"".concat(C||"form","-cylinders"),children:z("cylinders")})}),(0,i.jsxs)(p.Ph,{id:"".concat(C||"form","-cylinders"),name:"cylinders",value:null!=eC.watch("cylinders")&&0!==eC.watch("cylinders")?eC.watch("cylinders").toString():"",onValueChange:e=>{e&&""!==e&&eC.setValue("cylinders",parseInt(e))},disabled:!X||!ee||!eI||ev||0===en.length,children:[(0,i.jsx)(p.i4,{children:(0,i.jsx)(p.ki,{placeholder:ev?"Loading...":en.length>0?"Select cylinders":X&&ee&&eI?"No cylinders available":"Select make, model, and engine first"})}),(0,i.jsx)(p.Bw,{children:ev?(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"Loading cylinders..."}):en.length>0?en.map(e=>(0,i.jsx)(p.Ql,{value:e.toString(),className:"text-white",children:e},e)):X&&ee&&eI?(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"No cylinders found"}):(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"Select make, model, and engine first"})})]})]}),(0,i.jsxs)(k.E.div,{className:"space-y-2 sm:col-span-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.35},children:[(0,i.jsx)(S.I,{content:S.l.fuel_type,children:(0,i.jsx)(m._,{htmlFor:"".concat(C||"form","-fuel_type"),children:z("fuelType")})}),(0,i.jsxs)(p.Ph,{id:"".concat(C||"form","-fuel_type"),name:"fuel_type",value:eC.watch("fuel_type"),onValueChange:e=>{eC.setValue("fuel_type",e),eC.formState.errors.fuel_type&&eC.clearErrors("fuel_type")},disabled:!X||!ee||ej,children:[(0,i.jsx)(p.i4,{className:eC.formState.errors.fuel_type?"border-red-500":"",children:(0,i.jsx)(p.ki,{placeholder:ej?"Loading...":X&&ee?Y.length>0?"Select fuel type":"No fuel types available":"Select make and model first"})}),(0,i.jsx)(p.Bw,{children:ej?(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"Loading fuel types..."}):Y.length>0?Y.map(e=>(0,i.jsx)(p.Ql,{value:e,className:"text-white",children:e},e)):X&&ee?(0,i.jsxs)("div",{className:"p-2 text-center text-[#94a3b8]",children:["No fuel types found for ",X," ",ee]}):(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"Select make and model first"})})]}),eC.formState.errors.fuel_type&&(0,i.jsx)("p",{className:"text-sm text-red-400 mt-1",children:eC.formState.errors.fuel_type.message})]})]})]}),(0,i.jsxs)("div",{className:"space-y-6 transition-all duration-300 ".concat(3===V?"relative opacity-100 translate-x-0 z-10":"absolute inset-0 opacity-0 -translate-x-4 pointer-events-none z-0"),children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Final Details"}),(0,i.jsx)("p",{className:"text-sm text-slate-400",children:"Where is the car located?"})]}),(0,i.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,i.jsxs)(k.E.div,{className:"space-y-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.4},children:[(0,i.jsx)(S.I,{content:S.l.condition,children:(0,i.jsx)(m._,{htmlFor:"".concat(C||"form","-condition"),children:z("condition")})}),(0,i.jsxs)(p.Ph,{id:"".concat(C||"form","-condition"),name:"condition",value:eC.watch("condition")||"",onValueChange:e=>{eC.setValue("condition",e,{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),eC.clearErrors("condition"),3===V&&eC.trigger(["condition","location"])},children:[(0,i.jsx)(p.i4,{children:(0,i.jsx)(p.ki,{placeholder:"Select condition"})}),(0,i.jsx)(p.Bw,{children:q.map(e=>(0,i.jsx)(p.Ql,{value:e,className:"text-white",children:e},e))})]}),eC.formState.errors.condition&&(0,i.jsx)("p",{className:"text-sm text-red-400",children:eC.formState.errors.condition.message})]}),(0,i.jsxs)(k.E.div,{className:"space-y-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3,delay:.45},children:[(0,i.jsx)(S.I,{content:S.l.location,children:(0,i.jsx)(m._,{htmlFor:"".concat(C||"form","-location"),children:z("location")})}),(0,i.jsxs)(p.Ph,{id:"".concat(C||"form","-location"),name:"location",value:eC.watch("location")||"",onValueChange:e=>{eC.setValue("location",e,{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),eC.clearErrors("location"),3===V&&eC.trigger(["condition","location"])},disabled:ec,children:[(0,i.jsx)(p.i4,{children:(0,i.jsx)(p.ki,{placeholder:ec?"Loading locations...":"Select location"})}),(0,i.jsx)(p.Bw,{className:"max-h-[300px]",children:ec?(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"Loading locations..."}):G.length>0?G.map(e=>(0,i.jsx)(p.Ql,{value:e,className:"text-white",children:e},e)):(0,i.jsx)("div",{className:"p-2 text-center text-[#94a3b8]",children:"No locations available"})})]},"location-select"),eC.formState.errors.location&&(0,i.jsx)("p",{className:"text-sm text-red-400",children:eC.formState.errors.location.message})]})]})]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-white/10",children:[(0,i.jsxs)(s.z,{type:"button",variant:"outline",onClick:()=>{let e=eC.getValues("trim"),t=Math.max(V-1,1);I(t),C&&_&&_(C,t),e&&setTimeout(()=>{eC.getValues("trim"),eC.setValue("trim",e,{shouldValidate:!0,shouldDirty:!0,shouldTouch:!0}),eC.clearErrors("trim"),eC.getValues("trim")},100),window.scrollTo({top:0,behavior:"smooth"})},disabled:1===V,className:"border-white/20 md:border-white/10 bg-white/5 hover:bg-white/10 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,i.jsx)(w.Z,{className:"w-4 h-4 mr-2"}),"Back"]}),V<3?(0,i.jsxs)(s.z,{type:"button",onClick:eQ,disabled:!eX(),className:"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-400 hover:to-purple-500 text-white shadow-lg shadow-indigo-500/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-indigo-500 disabled:hover:to-purple-600",children:["Next",(0,i.jsx)(j.Z,{className:"w-4 h-4 ml-2 rtl:rotate-180"})]}):(0,i.jsxs)(s.z,{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),eJ()},disabled:a||!eX(),className:"bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-400 hover:to-purple-500 text-white shadow-lg shadow-indigo-500/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-indigo-500 disabled:hover:to-purple-600",children:[a&&(0,i.jsx)(N.Z,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Analyzing Market Data...":"Predict Price"]})]})]})}var C=a(28203),z=a(22112),F=a(27708),V=a(35157),I=a(35817),T=a(9883),D=a(86264),M=a(92851),P=a(8957),A=a(82549),R=a(29251),L=a(49036),Z=a(62167),B=a(1657),G=a(80048);let O={toyota:180,honda:190,ford:200,bmw:250,mercedes:260,nissan:180,chevrolet:200,hyundai:170,kia:170,audi:240};function q(e){var t,a;let i=(null!==(t=e.make)&&void 0!==t?t:"").toLowerCase().replace(/\s+/g,""),r="number"==typeof e.year?e.year:new Date().getFullYear();return{horsepower:Math.round((null!==(a=O[i])&&void 0!==a?a:180)*Math.min(1.2,.8+(r-2015)*.02)),fuelEconomy:{city:24,highway:32},reliabilityRating:75,acceleration:7.5,torque:200,topSpeed:130,transmission:e.transmission||"Automatic",drivetrain:"FWD"}}function H(e){let{data:t}=e;return(null==t?void 0:t.length)?(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Price & Specs"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-4",children:t.map((e,t)=>{var a,r;return(0,i.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl px-4 py-3 min-w-[120px] hover:bg-white/10 transition-colors",children:[(0,i.jsx)("p",{className:"text-xs uppercase tracking-wider text-gray-400 mb-1 truncate",children:e.name}),(0,i.jsxs)("p",{className:"text-white text-lg font-semibold",children:["$",null!==(r=null===(a=e.price)||void 0===a?void 0:a.toLocaleString())&&void 0!==r?r:"—"]}),null!=e.horsepower&&(0,i.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[e.horsepower," hp"]})]},t)})})]}):null}function Y(e){let{columnLabels:t,rows:a,bestDealIndex:r,mostExpensiveIndex:l,highlightBestInRow:n,showIcons:s}=e;if(!(null==a?void 0:a.length)||!(null==t?void 0:t.length))return null;let o=(e,t)=>{var a;let i;return null==t?"—":(i=e.format?e.format(t):"number"==typeof t&&(null===(a=e.label)||void 0===a?void 0:a.toLowerCase().includes("price"))?(0,B.xG)(t):String(t),e.suffix&&!i.endsWith(e.suffix)&&(i+=e.suffix),i||"—")};return(0,i.jsxs)("div",{className:"overflow-x-auto relative",children:[void 0!==r&&(0,i.jsx)("div",{className:"absolute inset-0 -z-10 pointer-events-none",style:{background:"linear-gradient(to right, transparent ".concat(100/t.length*r,"%, rgba(34, 197, 94, 0.1) ").concat(100/t.length*r,"%, rgba(34, 197, 94, 0.1) ").concat(100/t.length*(r+1),"%, transparent ").concat(100/t.length*(r+1),"%)")}}),(0,i.jsxs)("table",{className:"w-full text-sm",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"border-b border-white/5",children:[(0,i.jsx)("th",{className:"text-left py-3 pr-4 text-xs uppercase tracking-wider text-gray-400 font-semibold",children:"Spec"}),t.map((e,t)=>(0,i.jsxs)("th",{className:"text-left py-3 px-2 text-white font-semibold max-w-[140px] truncate relative ".concat(t===r?"text-green-400":""),children:[e,t===r&&(0,i.jsx)("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full animate-pulse"})]},t))]})}),(0,i.jsx)("tbody",{children:a.map((e,t)=>(0,i.jsxs)("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors group",children:[(0,i.jsx)("td",{className:"py-3 pr-4 text-gray-400 font-medium",children:e.label}),e.values.map((t,a)=>{let s=n&&r===a,d=n&&l===a;return(0,i.jsx)("td",{className:"py-3 px-2 max-w-[140px] truncate ".concat(s?"text-green-400 font-semibold":d?"text-amber-400":"text-white"),children:o(e,t)},a)})]},t))})]})]})}function U(e){let{cars:t,bestDealIndex:a}=e;return(null==t?void 0:t.length)?(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Value Analysis"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-4",children:t.map((e,t)=>(0,i.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border rounded-xl px-4 py-3 min-w-[120px] hover:bg-white/10 transition-colors relative ".concat(t===a?"border-green-500/50 shadow-lg shadow-green-500/20":"border-white/10"),children:[t===a&&(0,i.jsx)("div",{className:"absolute inset-0 -z-10 bg-gradient-radial from-green-500/20 via-green-500/10 to-transparent blur-xl rounded-xl opacity-50"}),(0,i.jsx)("p",{className:"text-xs uppercase tracking-wider text-gray-400 mb-1 truncate",children:e.name}),(0,i.jsx)("p",{className:"text-white text-lg font-semibold",children:(0,B.xG)(e.price)}),null!=e.horsepower&&(0,i.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[e.horsepower," hp"]})]},t))})]}):null}function Q(e){let{cars:t,bestDealIndex:a}=e;return(null==t?void 0:t.length)?(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Ownership Costs"}),(0,i.jsx)("div",{className:"flex flex-wrap gap-4",children:t.map((e,t)=>(0,i.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm border rounded-xl px-4 py-3 min-w-[120px] hover:bg-white/10 transition-colors relative ".concat(t===a?"border-green-500/50 shadow-lg shadow-green-500/20":"border-white/10"),children:[t===a&&(0,i.jsx)("div",{className:"absolute inset-0 -z-10 bg-gradient-radial from-green-500/20 via-green-500/10 to-transparent blur-xl rounded-xl opacity-50"}),(0,i.jsx)("p",{className:"text-xs uppercase tracking-wider text-gray-400 mb-1 truncate",children:e.name}),(0,i.jsx)("p",{className:"text-white text-lg font-semibold",children:(0,B.xG)(e.price)}),null!=e.mileage&&(0,i.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:[e.mileage.toLocaleString()," km"]})]},t))})]}):null}function W(e){let{cars:t,bestDealIndex:a,mostExpensiveIndex:r,savings:l}=e;return(null==t?void 0:t.length)?(0,i.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:t.map((e,t)=>(0,i.jsxs)("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl p-6 relative ".concat(t===a?"border-green-500/50 shadow-lg shadow-green-500/20":t===r?"border-amber-500/50":""),children:[t===a&&(0,i.jsx)("div",{className:"absolute inset-0 -z-10 bg-gradient-radial from-green-500/20 via-green-500/10 to-transparent blur-xl rounded-2xl opacity-50"}),(0,i.jsx)("p",{className:"text-xs uppercase tracking-wider text-gray-400 mb-2 truncate",children:e.name}),(0,i.jsx)("p",{className:"text-white text-2xl font-bold mb-1",children:(0,B.xG)(e.price)}),null!=l&&null!=l[t]&&l[t]>0&&(0,i.jsxs)("p",{className:"text-xs text-green-400 font-medium",children:["Save ",(0,B.xG)(l[t])]})]},t))}):null}function $(e){let{cars:t,bestDealIndex:a,bestForPerformance:r,bestForEconomy:l,bestForReliability:n}=e;if(!(null==t?void 0:t.length))return null;let s=t[null!=a?a:0];return s?(0,i.jsxs)("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl p-6 mb-6",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white mb-3",children:"Smart Recommendations"}),(0,i.jsxs)("p",{className:"text-gray-300 text-sm",children:["Best value: ",(0,i.jsx)("span",{className:"text-green-400 font-semibold",children:s.name}),null!=s.price&&" at $".concat(s.price.toLocaleString()),"."]})]}):null}var J=a(86443);function X(e){let{data:t,onSuccess:a,onError:r,variant:l="outline",className:n}=e;return(0,i.jsxs)(s.z,{variant:l,className:n,onClick:()=>{try{window.print(),null==a||a()}catch(e){null==r||r(e instanceof Error?e:Error("Export failed"))}},children:[(0,i.jsx)(I.Z,{className:"mr-2 h-4 w-4"}),"Export PDF"]})}var K=a(29764);function ee(e){let{mode:t,ids:a,predictionState:r,onCopy:l,variant:n="outline",className:o}=e;return(0,i.jsxs)(s.z,{variant:n,className:o,onClick:()=>{try{var e;let i=window.location.pathname.split("/")[1]||"en",r="".concat(window.location.origin,"/").concat(i,"/compare");"marketplace"===t&&(null==a?void 0:a.length)&&(r+="?ids=".concat(a.join(","))),null===(e=navigator.clipboard)||void 0===e||e.writeText(r).then(()=>null==l?void 0:l())}catch(e){null==l||l()}},children:[(0,i.jsx)(K.Z,{className:"mr-2 h-4 w-4"}),"Share"]})}var et=a(93930),ea=a(92295),ei=a(38244);let er="compare_history";function el(){try{let e=localStorage.getItem(er);if(!e)return[];let t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(e){return[]}}function en(e){let t=el(),a={...e,id:"ch-".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,9)),createdAt:Date.now()};t.unshift(a),t.length>50&&(t.length=50),function(e){try{localStorage.setItem(er,JSON.stringify(e))}catch(e){}}(t)}function es(e){let{canSave:t,onSave:a,onLoad:l,variant:n="outline",className:o}=e,[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(""),p=el();return(0,i.jsxs)(et.h_,{children:[(0,i.jsx)(et.$F,{asChild:!0,children:(0,i.jsxs)(s.z,{variant:n,className:o,children:[(0,i.jsx)(ea.Z,{className:"mr-2 h-4 w-4"}),"Save / History"]})}),(0,i.jsxs)(et.AW,{align:"end",className:"w-56",children:[t&&(0,i.jsxs)("div",{className:"px-2 py-2 border-b border-[#2a2d3a]",children:[(0,i.jsx)("input",{type:"text",placeholder:"Name this comparison",value:u,onChange:e=>m(e.target.value),className:"w-full rounded bg-[#1a1d29] border border-[#2a2d3a] px-2 py-1.5 text-sm text-white placeholder:text-[#64748b]"}),(0,i.jsx)(s.z,{size:"sm",className:"mt-2 w-full",onClick:()=>{u.trim()&&(a(u.trim()),c(!1),m(""))},disabled:!u.trim(),children:"Save"})]}),p.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"px-2 py-1 text-xs text-[#94a3b8]",children:"History"}),p.slice(0,10).map(e=>{var t;return(0,i.jsxs)(et.Xi,{onClick:()=>l(e),className:"text-sm",children:[(0,i.jsx)(ei.Z,{className:"mr-2 h-4 w-4"}),e.name]},null!==(t=e.id)&&void 0!==t?t:e.name)})]}),0===p.length&&!t&&(0,i.jsx)("div",{className:"px-2 py-4 text-sm text-[#94a3b8]",children:"No saved comparisons"})]})]})}var eo=a(35498);function ed(){var e;let t=(0,n.useSearchParams)(),a=(null==t?void 0:null===(e=t.get("ids"))||void 0===e?void 0:e.split(",").map(e=>parseInt(e.trim())).filter(e=>!isNaN(e)))||[],o=a.length>0,[d,c]=(0,r.useState)(!1),[u,p]=(0,r.useState)([{id:"1",features:null,prediction:null,loading:!1,currentStep:1}]),[h,x]=(0,r.useState)([]),[f,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),S=(0,l.useTranslations)("compare"),E=(0,l.useTranslations)("common"),O=(0,v.useToast)()||{toast:()=>{}},K=(0,n.useRouter)(),et=(0,l.useLocale)();(0,r.useEffect)(()=>{c(!0)},[]),(0,r.useEffect)(()=>{var e,i;if(!d||!t||a.length>0)return;let r=function(e){if(!e)return null;let t=e.get("type"),a=e.get("d");if("pred"!==t||!a)return null;try{var i,r;let e=JSON.parse(decodeURIComponent(atob(a)));if((null==e?void 0:e.mode)==="prediction"&&(null==e?void 0:null===(r=e.state)||void 0===r?void 0:null===(i=r.cars)||void 0===i?void 0:i.length))return{mode:"prediction",state:e.state}}catch(e){}return null}(t);(null==r?void 0:r.mode)==="prediction"&&(null===(i=r.state)||void 0===i?void 0:null===(e=i.cars)||void 0===e?void 0:e.length)&&(p(r.state.cars.map((e,t)=>({id:"load-".concat(t,"-").concat(Date.now()),features:e.features,prediction:e.prediction,loading:!1,currentStep:1}))),K.replace("/".concat(et,"/compare")))},[d,t,a.length,K,et]);let ea=(0,r.useCallback)(async()=>{y(!0);try{let e=a.map(e=>g.apiClient.getListing(e)),t=(await Promise.all(e)).filter(e=>e&&e.id).map(e=>{var t,a;return{id:e.id,listing_id:e.id,make:e.make,model:e.model,year:e.year,price:e.price,mileage:e.mileage,condition:e.condition,fuel_type:e.fuel_type,transmission:e.transmission,color:e.color,features:e.features||[],image_url:null===(a=e.images)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.url,location_city:e.location_city,description:e.description}});x(t),t.length>=2&&eo.activityHelpers.logCompare(t.map(e=>e.id),t.length)}catch(e){console.error("Error loading listings:",e),(null==O?void 0:O.toast)&&O.toast({title:"Error",description:"Failed to load listings for comparison",variant:"destructive"})}finally{y(!1)}},[a,O]),ei=a.join(",");(0,r.useEffect)(()=>{o&&a.length>0&&ea()},[o,ei,a.length,ea]);let er=u.every(e=>e.prediction&&e.features),el=u.length>1,ed=(0,r.useMemo)(()=>{if(!er||!el)return null;let e=u.map((e,t)=>{var a,i;return{...e,index:t+1,price:(null===(a=e.prediction)||void 0===a?void 0:a.predicted_price)||0,confidence:(null===(i=e.prediction)||void 0===i?void 0:i.confidence_range)||0}}).sort((e,t)=>e.price-t.price),t=e[0].index-1,a=e[e.length-1].index-1,i=e.reduce((e,t)=>e+t.price,0)/e.length,r=u.map((t,i)=>{var r;if(i===a)return 0;let l=(null===(r=t.prediction)||void 0===r?void 0:r.predicted_price)||0;return e[e.length-1].price-l}),l=u[t],n=l.features&&l.prediction?"Based on the comparison, **Car ".concat(t+1," (").concat(l.features.make," ").concat(l.features.model,")** offers the best value. At ").concat((0,B.xG)(l.prediction.predicted_price),", it's ").concat((0,B.xG)(r[t])," less expensive than the most expensive option. ").concat("Excellent"===l.features.condition||"Very Good"===l.features.condition?"Its excellent condition also ensures good long-term reliability.":""," This represents the best balance of price and features among your options."):"";return{bestDealIndex:t,mostExpensiveIndex:a,avgPrice:i,savings:r,recommendation:n,carsWithPrices:e}},[u,er,el]),ec=(0,r.useMemo)(()=>u.map(e=>e.features?q({make:e.features.make,model:e.features.model,year:e.features.year,engine_size:e.features.engine_size,cylinders:e.features.cylinders,fuel_type:e.features.fuel_type}):null),[u]),eu=(0,r.useMemo)(()=>ed?u.map((e,t)=>{var a,i,r,l;let n=ec[t],s=null==n?void 0:n.fuelEconomy;return{name:"Car ".concat(t+1),shortName:e.features?"".concat(e.features.make," ").concat(e.features.model).slice(0,14):"Car ".concat(t+1),price:(null===(a=e.prediction)||void 0===a?void 0:a.predicted_price)||0,horsepower:null==n?void 0:n.horsepower,fuelEconomy:s?Math.round((s.city+s.highway)/2):void 0,acceleration:null==n?void 0:n.acceleration,value:(null==n?void 0:n.horsepower)&&(null===(i=e.prediction)||void 0===i?void 0:i.predicted_price)?Math.round(e.prediction.predicted_price/n.horsepower):void 0,economy:s?Math.round((s.city+s.highway)/2):void 0,fullName:"".concat((null===(r=e.features)||void 0===r?void 0:r.make)||""," ").concat((null===(l=e.features)||void 0===l?void 0:l.model)||"").trim()||"Car ".concat(t+1),isBestDeal:t===ed.bestDealIndex,isMostExpensive:t===ed.mostExpensiveIndex}}):[],[u,ed,ec]),em=(0,r.useMemo)(()=>{if(!er||!ed)return[];let e=[{label:"Make & Model",values:u.map(e=>e.features?"".concat(e.features.make," ").concat(e.features.model):"—")},{label:"Year",values:u.map(e=>{var t,a;return null!==(a=null===(t=e.features)||void 0===t?void 0:t.year)&&void 0!==a?a:"—"}),icon:C.Z},{label:"Mileage",values:u.map(e=>{var t,a;return null!==(a=null===(t=e.features)||void 0===t?void 0:t.mileage)&&void 0!==a?a:null}),suffix:" km",format:e=>Number(e).toLocaleString()},{label:"Condition",values:u.map(e=>{var t,a;return null!==(a=null===(t=e.features)||void 0===t?void 0:t.condition)&&void 0!==a?a:"—"})},{label:"Fuel Type",values:u.map(e=>{var t,a;return null!==(a=null===(t=e.features)||void 0===t?void 0:t.fuel_type)&&void 0!==a?a:"—"}),icon:z.Z},{label:"Engine",values:u.map(e=>{var t;return(null===(t=e.features)||void 0===t?void 0:t.engine_size)?"".concat(e.features.engine_size,"L"):"—"}),icon:F.Z},{label:"Cylinders",values:u.map(e=>{var t,a;return null!==(a=null===(t=e.features)||void 0===t?void 0:t.cylinders)&&void 0!==a?a:"—"})},{label:"Horsepower",values:u.map((e,t)=>{var a,i;return null!==(i=null===(a=ec[t])||void 0===a?void 0:a.horsepower)&&void 0!==i?i:null}),higherIsBetter:!0,suffix:" hp",icon:V.Z},{label:"Torque",values:u.map((e,t)=>{var a,i;return null!==(i=null===(a=ec[t])||void 0===a?void 0:a.torque)&&void 0!==i?i:null}),higherIsBetter:!0,suffix:" lb-ft"},{label:"0-60 mph",values:u.map((e,t)=>{var a,i;return null!==(i=null===(a=ec[t])||void 0===a?void 0:a.acceleration)&&void 0!==i?i:null}),suffix:" s"},{label:"Top Speed",values:u.map((e,t)=>{var a,i;return null!==(i=null===(a=ec[t])||void 0===a?void 0:a.topSpeed)&&void 0!==i?i:null}),higherIsBetter:!0,suffix:" mph"},{label:"Transmission",values:u.map((e,t)=>{var a,i;return null!==(i=null===(a=ec[t])||void 0===a?void 0:a.transmission)&&void 0!==i?i:"—"})},{label:"Drivetrain",values:u.map((e,t)=>{var a,i;return null!==(i=null===(a=ec[t])||void 0===a?void 0:a.drivetrain)&&void 0!==i?i:"—"})},{label:"Fuel Economy",values:u.map((e,t)=>{var a;let i=null===(a=ec[t])||void 0===a?void 0:a.fuelEconomy;return i?(0,B.gQ)(i.city,i.highway):"—"})},{label:"Predicted Price",values:u.map(e=>{var t,a;return null!==(a=null===(t=e.prediction)||void 0===t?void 0:t.predicted_price)&&void 0!==a?a:null}),format:e=>(0,B.xG)(Number(e))},{label:"Confidence",values:u.map(e=>{var t,a;return null!==(a=null===(t=e.prediction)||void 0===t?void 0:t.confidence_range)&&void 0!==a?a:null}),higherIsBetter:!0,suffix:"%"},{label:"Savings vs Highest",values:ed.savings,format:e=>(0,B.xG)(Number(e)),suffix:""}];return j?e.filter(e=>{let t=e.values.map(e=>String(null!=e?e:""));return new Set(t).size>1}):e},[u,ed,ec,er,j]),ep=()=>{if(u.length>=4){(null==O?void 0:O.toast)&&O.toast({title:"Limit reached",description:"You can compare up to ".concat(4," cars."),variant:"default"});return}p([...u,{id:Date.now().toString(),features:null,prediction:null,loading:!1,currentStep:1}])},eh=e=>{u.length>1&&p(u.filter(t=>t.id!==e))},ex=(0,r.useCallback)((e,t)=>{p(a=>{let i=a.find(t=>t.id===e);return i&&i.currentStep!==t?a.map(a=>a.id===e?{...a,currentStep:t}:a):a})},[]),eg=(0,r.useCallback)((e,t)=>{p(a=>a.map(a=>{if(a.id===e){var i;if(!t)return{...a};let e=void 0!==t.model&&(null===(i=a.features)||void 0===i?void 0:i.model)!==t.model,r={...a.features?{...a.features}:{},...t,...e?{trim:""}:{}};return{...a,features:r}}return a}))},[]),ef=(0,r.useCallback)((e,t)=>ev(e,t),[]),ev=async(e,t)=>{if(!e){console.error("❌ [Compare] Missing car id:",{id:e}),(null==O?void 0:O.toast)&&O.toast({title:(null==E?void 0:E("error"))||"Error",description:"Car ID is missing",variant:"destructive"});return}if(!t||"object"!=typeof t){console.error("❌ [Compare] Invalid input:",{id:e,features:t,featuresType:typeof t}),(null==O?void 0:O.toast)&&O.toast({title:(null==E?void 0:E("error"))||"Error",description:"Invalid car features provided",variant:"destructive"});return}let a=["make","model","trim","year","mileage","engine_size","cylinders","condition","fuel_type","location"],i=a.filter(e=>{let a=t[e];return null==a||""===a||"number"==typeof a&&isNaN(a)});if(i.length>0){console.error("❌ [Compare] Missing required fields:",{id:e,missingFields:i,features:t,fieldValues:a.map(e=>({field:e,value:t[e]}))}),(null==O?void 0:O.toast)&&O.toast({title:"Missing Required Fields",description:"Car ".concat(e,": Please fill in: ").concat(i.join(", ")),variant:"destructive"});return}p(a=>a.find(t=>t.id===e)?a.map(t=>t.id===e?{...t,loading:!0}:t):(console.error("❌ [Compare] Car not found in state:",{id:e,availableCarIds:a.map(e=>e.id)}),a.length>0)?(console.warn("⚠️ [Compare] Car not found, using first car as fallback:",a[0].id),a.map((e,t)=>0===t?{...e,loading:!0}:e)):(console.warn("⚠️ [Compare] No cars exist, creating new car with id:",e),[{id:e,features:t,prediction:null,loading:!0,currentStep:1}]));try{let a=await g.apiClient.predictPrice(t);if(!a||"object"!=typeof a||"number"!=typeof a.predicted_price)throw Error("Invalid prediction result: missing predicted_price");p(i=>i.find(t=>t.id===e)?i.map(i=>i.id===e?{...i,features:{...t},prediction:{...a},loading:!1}:i):i.length>0?(console.warn("⚠️ [Compare] Car still not found in final update, using first car:",i[0].id),i.map((e,i)=>0===i?{...e,features:{...t},prediction:{...a},loading:!1}:e)):(console.warn("⚠️ [Compare] No cars exist in final update, creating new car:",e),[{id:e,features:{...t},prediction:{...a},loading:!1,currentStep:1}])),(null==O?void 0:O.toast)&&O.toast({title:(null==E?void 0:E("success"))||"Success",description:"Car ".concat(e,": Predicted ").concat((0,B.xG)(a.predicted_price))})}catch(t){var r,l;console.error("❌ [Compare] Prediction failed:",{id:e,error:t,errorMessage:null==t?void 0:t.message,errorStack:null==t?void 0:t.stack,errorResponse:null==t?void 0:null===(r=t.response)||void 0===r?void 0:r.data,errorStatus:null==t?void 0:null===(l=t.response)||void 0===l?void 0:l.status}),(null==O?void 0:O.toast)&&O.toast({title:(null==E?void 0:E("error"))||"Error",description:"Car ".concat(e,": ").concat((null==t?void 0:t.message)||"Failed to predict price. Please check all fields are filled correctly."),variant:"destructive"}),p(t=>t.find(t=>t.id===e)?t.map(t=>t.id===e?{...t,loading:!1}:t):t.length>0?t.map((e,t)=>0===t?{...e,loading:!1}:e):t)}},ey=e=>!!e&&!!(e.make&&e.model&&e.year&&null!=e.mileage&&null!=e.engine_size&&null!=e.cylinders&&e.condition&&e.fuel_type&&e.location),eb=async()=>{try{let e=u.filter(e=>{let t=ey(e.features),a=!e.prediction,i=!e.loading;return t&&a&&i});if(0===e.length){let e=u.filter(e=>e.features&&!ey(e.features)&&!e.prediction),t=u.filter(e=>e.prediction);e.length>0?(null==O?void 0:O.toast)&&O.toast({title:"Incomplete Car Details",description:"Please fill in all required fields (Make, Model, Year, Mileage, Engine Size, Cylinders, Condition, Fuel Type, Location) for ".concat(e.length," car").concat(e.length>1?"s":""),variant:"default"}):t.length===u.length&&u.length>0?(null==O?void 0:O.toast)&&O.toast({title:"All Cars Predicted",description:"All cars already have predictions",variant:"default"}):(null==O?void 0:O.toast)&&O.toast({title:"No Cars to Predict",description:"Please add cars and fill in their details first",variant:"default"});return}w(!0),p(t=>t.map(t=>e.some(e=>e.id===t.id)?{...t,loading:!0}:t));try{let t=e.map(async e=>{if(!e.features)return{id:e.id,success:!1,error:"No features"};try{let t=await g.apiClient.predictPrice(e.features);if(t&&"object"==typeof t&&"number"==typeof t.predicted_price)return{id:e.id,success:!0,result:t,features:e.features};throw Error("Invalid prediction result: missing predicted_price")}catch(t){return console.error("❌ [Compare] Prediction failed for car ".concat(e.id,":"),t),{id:e.id,success:!1,error:(null==t?void 0:t.message)||"Prediction failed",features:e.features}}}),a=await Promise.all(t);p(e=>e.map(e=>{let t=a.find(t=>t.id===e.id);return t&&t.success&&t.result&&t.features?{...e,prediction:t.result,features:t.features,loading:!1}:t&&!t.success?{...e,loading:!1}:e}));let i=a.filter(e=>e.success).length,r=a.filter(e=>!e.success).length;if(i>0&&(null==O?void 0:O.toast)&&O.toast({title:(null==E?void 0:E("success"))||"Success",description:"Successfully predicted ".concat(i," car").concat(i>1?"s":"").concat(r>0?". ".concat(r," failed."):"")}),r>0){let e=a.filter(e=>!e.success);console.error("❌ [Compare] Failed predictions:",e),(null==O?void 0:O.toast)&&O.toast({title:"Some Predictions Failed",description:"".concat(r," car").concat(r>1?"s":""," failed to predict. Please check the details and try again."),variant:"destructive"})}}catch(e){console.error("❌ [Compare] Predict All failed:",e),(null==O?void 0:O.toast)&&O.toast({title:(null==E?void 0:E("error"))||"Error",description:(null==e?void 0:e.message)||"Failed to predict all cars",variant:"destructive"})}finally{w(!1),p(e=>e.map(e=>({...e,loading:!1})))}}catch(e){console.error("❌ [Compare] Predict All outer error:",e),w(!1),p(e=>e.map(e=>({...e,loading:!1}))),(null==O?void 0:O.toast)&&O.toast({title:(null==E?void 0:E("error"))||"Error",description:(null==e?void 0:e.message)||"An unexpected error occurred",variant:"destructive"})}},ew=e=>{var t,a;if(o&&eN&&h.length>=2)en({name:e,mode:"marketplace",ids:h.map(e=>e.id)}),eo.activityHelpers.logCompare(h.map(e=>e.id),h.length),null==O||null===(t=O.toast)||void 0===t||t.call(O,{title:"Saved",description:"Comparison saved to history."});else if(!o&&er&&el){en({name:e,mode:"prediction",state:{cars:u.map(e=>({features:e.features,prediction:e.prediction}))}});let t=u.map((e,t)=>e.features?"".concat(e.features.make,"-").concat(e.features.model,"-").concat(t):"car-".concat(t));eo.activityHelpers.logCompare(t,u.length),null==O||null===(a=O.toast)||void 0===a||a.call(O,{title:"Saved",description:"Comparison saved to history."})}},ej=e=>{var t,a,i;"marketplace"===e.mode&&(null===(t=e.ids)||void 0===t?void 0:t.length)?K.replace("/".concat(et,"/compare?ids=").concat(e.ids.join(","))):"prediction"===e.mode&&(null===(i=e.state)||void 0===i?void 0:null===(a=i.cars)||void 0===a?void 0:a.length)&&(p(e.state.cars.map((e,t)=>({id:"h-".concat(t,"-").concat(Date.now()),features:e.features,prediction:e.prediction,loading:!1}))),K.replace("/".concat(et,"/compare")))},eN=(0,r.useMemo)(()=>{var e;if(!o||h.length<2)return null;let t=[...h].sort((e,t)=>e.price-t.price),a=h.findIndex(e=>e.id===t[0].id),i=h.findIndex(e=>e.id===t[t.length-1].id),r=h.reduce((e,t)=>e+t.price,0)/h.length,l=h.map(e=>{let t=e.features.length,a=r/e.price*(1+.1*t);return{id:e.id,valueScore:a}}).sort((e,t)=>t.valueScore-e.valueScore);return{bestDealIndex:a,mostExpensiveIndex:i,avgPrice:r,winnerId:null===(e=l[0])||void 0===e?void 0:e.id,savings:h.map(e=>t[t.length-1].price-e.price)}},[h,o]);(0,r.useMemo)(()=>{if(!o)return[];let e=new Set;return h.forEach(t=>{t.features.forEach(t=>e.add(t))}),Array.from(e).sort()},[h,o]);let ek=(0,r.useMemo)(()=>h.map(e=>q({make:e.make,model:e.model,year:e.year,transmission:e.transmission,fuel_type:e.fuel_type})),[h]),eS=(0,r.useMemo)(()=>!eN||h.length<2?[]:h.map((e,t)=>{let a=ek[t],i=null==a?void 0:a.fuelEconomy;return{name:"".concat(e.make," ").concat(e.model),shortName:"".concat(e.make," ").concat(e.model).slice(0,14),price:e.price,horsepower:null==a?void 0:a.horsepower,fuelEconomy:i?Math.round((i.city+i.highway)/2):void 0,fullName:"".concat(e.make," ").concat(e.model," ").concat(e.year),isBestDeal:t===eN.bestDealIndex,isMostExpensive:t===eN.mostExpensiveIndex}}),[h,eN,ek]),eE=(0,r.useMemo)(()=>{if(!eN||h.length<2)return[];let e=[{label:"Make & Model",values:h.map(e=>"".concat(e.make," ").concat(e.model))},{label:"Year",values:h.map(e=>e.year)},{label:"Mileage",values:h.map(e=>e.mileage),suffix:" km",format:e=>Number(e).toLocaleString()},{label:"Condition",values:h.map(e=>e.condition)},{label:"Fuel Type",values:h.map(e=>e.fuel_type)},{label:"Transmission",values:h.map(e=>e.transmission)},{label:"Horsepower",values:h.map((e,t)=>{var a,i;return null!==(i=null===(a=ek[t])||void 0===a?void 0:a.horsepower)&&void 0!==i?i:null}),higherIsBetter:!0,suffix:" hp"},{label:"Fuel Economy",values:h.map((e,t)=>{var a;let i=null===(a=ek[t])||void 0===a?void 0:a.fuelEconomy;return i?(0,B.gQ)(i.city,i.highway):"—"})},{label:"Price",values:h.map(e=>e.price),format:e=>(0,B.xG)(Number(e))},{label:"Savings vs Highest",values:eN.savings,format:e=>(0,B.xG)(Number(e))}];return j?e.filter(e=>new Set(e.values.map(e=>String(null!=e?e:""))).size>1):e},[h,eN,ek,j]),e_=(0,r.useMemo)(()=>{if(o&&eN&&h.length>=2){var e,t,a,i,r;let l=eN.bestDealIndex;return{mode:"marketplace",columnLabels:h.map(e=>"".concat(e.make," ").concat(e.model)),specRows:eE,summary:h.map((e,t)=>{var a;return{name:"".concat(e.make," ").concat(e.model),price:e.price,savings:null!==(a=eN.savings[t])&&void 0!==a?a:0}}),chartSummary:eS,recommendation:"Best value: ".concat(null===(e=h[l])||void 0===e?void 0:e.make," ").concat(null===(t=h[l])||void 0===t?void 0:t.model," at ").concat((0,B.xG)(null!==(i=null===(a=h[l])||void 0===a?void 0:a.price)&&void 0!==i?i:0),". Save ").concat((0,B.xG)(null!==(r=eN.savings[l])&&void 0!==r?r:0)," vs most expensive.")}}return!o&&ed&&em.length>0?{mode:"prediction",columnLabels:u.map((e,t)=>e.features?"".concat(e.features.make," ").concat(e.features.model):"Car ".concat(t+1)),specRows:em,summary:u.map((e,t)=>{var a,i,r;return{name:e.features?"".concat(e.features.make," ").concat(e.features.model):"Car ".concat(t+1),price:null!==(i=null===(a=e.prediction)||void 0===a?void 0:a.predicted_price)&&void 0!==i?i:0,savings:null!==(r=ed.savings[t])&&void 0!==r?r:0}}),chartSummary:eu,recommendation:ed.recommendation||""}:null},[o,eN,h,eE,eS,ed,em,u,eu]);return d?(0,i.jsx)(k.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container px-4 sm:px-6 lg:px-8 py-6 md:py-10 relative",children:(0,i.jsxs)("div",{className:"mx-auto max-w-7xl relative",children:[(0,i.jsx)(k.E.div,{animate:{opacity:[.5,.7,.5]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},className:"absolute top-0 left-1/2 -translate-x-1/2 -z-10 w-[1200px] h-[600px] bg-gradient-radial from-purple-500/25 via-indigo-500/20 to-transparent blur-3xl opacity-60 pointer-events-none"}),(0,i.jsx)("div",{className:"absolute top-1/4 right-0 -z-10 w-[800px] h-[400px] bg-gradient-radial from-pink-500/15 via-purple-500/10 to-transparent blur-3xl opacity-40 pointer-events-none"}),(0,i.jsx)("div",{className:"absolute bottom-0 left-0 -z-10 w-[600px] h-[300px] bg-gradient-radial from-blue-500/15 to-transparent blur-3xl opacity-30 pointer-events-none"}),(0,i.jsx)("div",{className:"absolute inset-0 -z-10 opacity-[0.02] pointer-events-none",style:{backgroundImage:"linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),\n                              linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)",backgroundSize:"50px 50px"}}),(0,i.jsxs)(k.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"mb-8 md:mb-12 text-center relative",children:[(0,i.jsxs)("div",{className:"relative inline-block",children:[(0,i.jsx)("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-bold mb-3 bg-gradient-to-r from-white via-indigo-200 to-purple-200 bg-clip-text text-transparent",children:(S&&"function"==typeof S?S("title"):null)||"Compare Cars"}),(0,i.jsx)("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 w-24 h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-full blur-sm opacity-60"})]}),(0,i.jsx)(k.E.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.6},className:"text-sm md:text-base text-[#94a3b8] mt-4 max-w-2xl mx-auto",children:o?"Compare marketplace listings side by side":(S&&"function"==typeof S?S("description"):null)||"Compare multiple cars side by side"})]}),o&&(0,i.jsx)(i.Fragment,{children:f?(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(G.YE,{}),(0,i.jsx)(G.YE,{}),(0,i.jsx)(G.YE,{})]}):0===h.length?(0,i.jsx)("div",{className:"py-12 text-center",children:(0,i.jsx)("p",{className:"text-white/70",children:"No listings found for comparison"})}):(0,i.jsxs)("div",{className:"space-y-6",children:[eN&&h.length>=2&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(W,{cars:h.map((e,t)=>({name:"".concat(e.make," ").concat(e.model),price:e.price,index:t})),bestDealIndex:eN.bestDealIndex,mostExpensiveIndex:eN.mostExpensiveIndex,savings:eN.savings}),(0,i.jsx)($,{cars:h.map((e,t)=>{var a,i,r;return{name:"".concat(e.make," ").concat(e.model),index:t,price:e.price,horsepower:null===(a=ek[t])||void 0===a?void 0:a.horsepower,fuelEconomy:(null===(i=ek[t])||void 0===i?void 0:i.fuelEconomy)?(ek[t].fuelEconomy.city+ek[t].fuelEconomy.highway)/2:void 0,savings:eN.savings[t],reliability:null===(r=ek[t])||void 0===r?void 0:r.reliabilityRating}}),bestDealIndex:eN.bestDealIndex,savings:eN.savings,bestForPerformance:h.reduce((e,t,a)=>{var i,r,l,n;return(null!==(l=null===(i=ek[a])||void 0===i?void 0:i.horsepower)&&void 0!==l?l:0)>(null!==(n=null===(r=ek[e])||void 0===r?void 0:r.horsepower)&&void 0!==n?n:0)?a:e},0),bestForEconomy:h.reduce((e,t,a)=>{var i,r;let l=null===(i=ek[a])||void 0===i?void 0:i.fuelEconomy,n=null===(r=ek[e])||void 0===r?void 0:r.fuelEconomy;return(l?(l.city+l.highway)/2:0)>(n?(n.city+n.highway)/2:0)?a:e},0),bestForReliability:h.reduce((e,t,a)=>{var i,r,l,n;return(null!==(l=null===(i=ek[a])||void 0===i?void 0:i.reliabilityRating)&&void 0!==l?l:0)>(null!==(n=null===(r=ek[e])||void 0===r?void 0:r.reliabilityRating)&&void 0!==n?n:0)?a:e},0)}),eS.length>0&&(0,i.jsx)(H,{data:eS}),eE.length>0&&(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Specifications & Comparison"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(J.r,{id:"mk-hl-diff",checked:j,onCheckedChange:e=>N(!!e)}),(0,i.jsx)(m._,{htmlFor:"mk-hl-diff",className:"text-sm text-[#94a3b8] cursor-pointer",children:"Highlight differences only"})]})]}),(0,i.jsx)(Y,{columnLabels:h.map(e=>"".concat(e.make," ").concat(e.model)),rows:eE,bestDealIndex:eN.bestDealIndex,mostExpensiveIndex:eN.mostExpensiveIndex,highlightBestInRow:!0,showIcons:!1})]}),(0,i.jsx)(U,{cars:h.map((e,t)=>{var a,i;return{name:"".concat(e.make," ").concat(e.model),price:e.price,horsepower:null!==(i=null===(a=ek[t])||void 0===a?void 0:a.horsepower)&&void 0!==i?i:0,mileage:e.mileage}}),bestDealIndex:eN.bestDealIndex}),(0,i.jsx)(Q,{cars:h.map((e,t)=>{var a,i,r,l,n,s;return{name:"".concat(e.make," ").concat(e.model),price:e.price,mileage:e.mileage,fuelEconomyCity:null!==(n=null===(i=ek[t])||void 0===i?void 0:null===(a=i.fuelEconomy)||void 0===a?void 0:a.city)&&void 0!==n?n:25,fuelEconomyHighway:null!==(s=null===(l=ek[t])||void 0===l?void 0:null===(r=l.fuelEconomy)||void 0===r?void 0:r.highway)&&void 0!==s?s:33,fuelType:e.fuel_type}}),bestDealIndex:eN.bestDealIndex})]}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-2 justify-end bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-3",children:[eN&&h.length>=2&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(X,{data:e_,onSuccess:()=>{var e;return null==O?void 0:null===(e=O.toast)||void 0===e?void 0:e.call(O,{title:"Exported",description:"PDF saved."})},onError:e=>{var t;return null==O?void 0:null===(t=O.toast)||void 0===t?void 0:t.call(O,{title:"Export failed",description:e.message,variant:"destructive"})},variant:"outline",className:"border-white/10 bg-white/5 hover:bg-white/10 text-white"}),(0,i.jsx)(ee,{mode:"marketplace",ids:h.map(e=>e.id),onCopy:()=>{var e;return null==O?void 0:null===(e=O.toast)||void 0===e?void 0:e.call(O,{title:"Link copied",description:"Comparison link copied to clipboard."})},variant:"outline",className:"border-white/10 bg-white/5 hover:bg-white/10 text-white"}),(0,i.jsx)(es,{canSave:h.length>=2,onSave:ew,onLoad:ej,variant:"outline",className:"border-white/10 bg-white/5 hover:bg-white/10 text-white"})]}),(0,i.jsxs)(s.z,{onClick:()=>{window.print()},variant:"outline",className:"border-white/10 bg-white/5 hover:bg-white/10 text-white",children:[(0,i.jsx)(I.Z,{className:"me-2 h-4 w-4"}),"Print"]})]})]})}),!o&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(k.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"mb-8 flex flex-wrap gap-3 justify-between items-center bg-gradient-to-r from-white/5 via-white/5 to-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-5 shadow-xl shadow-indigo-500/10",children:[(0,i.jsx)(k.E.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,i.jsxs)(s.z,{onClick:()=>{try{ep()}catch(e){console.error("Error adding car:",e)}},className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white border-0 shadow-lg shadow-indigo-500/30 hover:shadow-indigo-500/50 transition-all duration-300",children:[(0,i.jsx)(T.Z,{className:"mr-2 h-4 w-4"}),(S&&"function"==typeof S?S("addCar"):null)||"Add Car"]})}),(0,i.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,i.jsx)(k.E.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"relative",children:(0,i.jsx)(s.z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),eb().catch(e=>{console.error("❌ [Compare] predictAll error:",e)})},className:"bg-gradient-to-r from-[#5B7FFF] via-indigo-500 to-purple-600 hover:from-[#5B7FFF]/90 hover:via-indigo-400 hover:to-purple-500 text-white border-0 shadow-lg shadow-[#5B7FFF]/40 hover:shadow-[#5B7FFF]/60 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",disabled:b||0===u.length||u.every(e=>!ey(e.features)||e.prediction),type:"button",children:b?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(D.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Predicting All..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(M.Z,{className:"mr-2 h-4 w-4"}),(S&&"function"==typeof S?S("predictAll"):null)||"Predict All"]})})}),er&&el&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(X,{data:e_,onSuccess:()=>{var e;return null==O?void 0:null===(e=O.toast)||void 0===e?void 0:e.call(O,{title:"Exported",description:"PDF saved."})},onError:e=>{var t;return null==O?void 0:null===(t=O.toast)||void 0===t?void 0:t.call(O,{title:"Export failed",description:e.message,variant:"destructive"})},variant:"outline",className:"border-white/10 bg-white/5 hover:bg-white/10 text-white"}),(0,i.jsx)(ee,{mode:"prediction",predictionState:{cars:u.map(e=>({features:e.features,prediction:e.prediction}))},onCopy:()=>{var e;return null==O?void 0:null===(e=O.toast)||void 0===e?void 0:e.call(O,{title:"Link copied",description:"Comparison link copied to clipboard."})},variant:"outline",className:"border-white/10 bg-white/5 hover:bg-white/10 text-white"}),(0,i.jsx)(es,{canSave:er&&el,onSave:ew,onLoad:ej,variant:"outline",className:"border-white/10 bg-white/5 hover:bg-white/10 text-white"})]})]})]}),(0,i.jsx)(Z.M,{children:er&&el&&ed&&(0,i.jsx)(k.E.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},exit:{opacity:0},className:"mb-6",children:(0,i.jsx)(W,{cars:u.map((e,t)=>{var a;return{name:e.features?"".concat(e.features.make," ").concat(e.features.model):"Car ".concat(t+1),price:(null===(a=e.prediction)||void 0===a?void 0:a.predicted_price)||0,index:t}}),bestDealIndex:ed.bestDealIndex,mostExpensiveIndex:ed.mostExpensiveIndex,savings:ed.savings})})}),(0,i.jsx)(Z.M,{children:er&&el&&ed&&(0,i.jsx)(k.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},className:"mb-6",children:(0,i.jsx)($,{cars:u.map((e,t)=>{var a,i,r,l;return{name:e.features?"".concat(e.features.make," ").concat(e.features.model):"Car ".concat(t+1),index:t,price:(null===(a=e.prediction)||void 0===a?void 0:a.predicted_price)||0,horsepower:null===(i=ec[t])||void 0===i?void 0:i.horsepower,fuelEconomy:(null===(r=ec[t])||void 0===r?void 0:r.fuelEconomy)?(ec[t].fuelEconomy.city+ec[t].fuelEconomy.highway)/2:void 0,savings:ed.savings[t],reliability:null===(l=ec[t])||void 0===l?void 0:l.reliabilityRating}}),bestDealIndex:ed.bestDealIndex,savings:ed.savings,bestForPerformance:u.reduce((e,t,a)=>{var i,r,l,n;return(null!==(l=null===(i=ec[a])||void 0===i?void 0:i.horsepower)&&void 0!==l?l:0)>(null!==(n=null===(r=ec[e])||void 0===r?void 0:r.horsepower)&&void 0!==n?n:0)?a:e},0),bestForEconomy:u.reduce((e,t,a)=>{var i,r;let l=null===(i=ec[a])||void 0===i?void 0:i.fuelEconomy,n=null===(r=ec[e])||void 0===r?void 0:r.fuelEconomy;return(l?(l.city+l.highway)/2:0)>(n?(n.city+n.highway)/2:0)?a:e},0),bestForReliability:u.reduce((e,t,a)=>{var i,r,l,n;return(null!==(l=null===(i=ec[a])||void 0===i?void 0:i.reliabilityRating)&&void 0!==l?l:0)>(null!==(n=null===(r=ec[e])||void 0===r?void 0:r.reliabilityRating)&&void 0!==n?n:0)?a:e},0)})})}),(0,i.jsx)(Z.M,{children:eu.length>0&&el&&(0,i.jsx)(k.E.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0},className:"mb-6",children:(0,i.jsx)(H,{data:eu})})}),(0,i.jsx)(Z.M,{children:er&&el&&ed&&em.length>0&&(0,i.jsxs)(k.E.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},exit:{opacity:0},className:"mb-6 space-y-6",children:[(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4",children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Specifications & Comparison"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(J.r,{id:"highlight-diff",checked:j,onCheckedChange:e=>N(!!e)}),(0,i.jsx)(m._,{htmlFor:"highlight-diff",className:"text-sm text-[#94a3b8] cursor-pointer",children:"Highlight differences only"})]})]}),(0,i.jsx)(Y,{columnLabels:u.map((e,t)=>e.features?"".concat(e.features.make," ").concat(e.features.model):"Car ".concat(t+1)),rows:em,bestDealIndex:ed.bestDealIndex,mostExpensiveIndex:ed.mostExpensiveIndex,highlightBestInRow:!0,showIcons:!0})]}),(0,i.jsx)(U,{cars:u.map((e,t)=>{var a,i,r,l,n;return{name:e.features?"".concat(e.features.make," ").concat(e.features.model):"Car ".concat(t+1),price:(null===(a=e.prediction)||void 0===a?void 0:a.predicted_price)||0,horsepower:null!==(l=null===(i=ec[t])||void 0===i?void 0:i.horsepower)&&void 0!==l?l:0,mileage:null!==(n=null===(r=e.features)||void 0===r?void 0:r.mileage)&&void 0!==n?n:0}}),bestDealIndex:ed.bestDealIndex}),(0,i.jsx)(Q,{cars:u.map((e,t)=>{var a,i,r,l,n,s,o,d,c,u;return{name:e.features?"".concat(e.features.make," ").concat(e.features.model):"Car ".concat(t+1),price:(null===(a=e.prediction)||void 0===a?void 0:a.predicted_price)||0,mileage:null!==(d=null===(i=e.features)||void 0===i?void 0:i.mileage)&&void 0!==d?d:0,fuelEconomyCity:null!==(c=null===(l=ec[t])||void 0===l?void 0:null===(r=l.fuelEconomy)||void 0===r?void 0:r.city)&&void 0!==c?c:25,fuelEconomyHighway:null!==(u=null===(s=ec[t])||void 0===s?void 0:null===(n=s.fuelEconomy)||void 0===n?void 0:n.highway)&&void 0!==u?u:33,fuelType:null===(o=e.features)||void 0===o?void 0:o.fuel_type}}),bestDealIndex:ed.bestDealIndex})]})}),(0,i.jsx)(k.E.div,{layout:!0,className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.2},children:(0,i.jsx)(Z.M,{children:u.map((e,t)=>{var a,r,l,n,o,d,c;let m=(null==ed?void 0:ed.bestDealIndex)===t,p=(null==ed?void 0:ed.mostExpensiveIndex)===t,h=e.features&&ey(e.features),x=Math.round((null!==(n=e.currentStep)&&void 0!==n?n:1)/3*100);return(0,i.jsx)(k.E.div,{layout:!0,initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-20},transition:{duration:.4,delay:.1*t},whileHover:{y:-8,scale:1.02},className:"group",children:(0,i.jsxs)("div",{className:"relative bg-gradient-to-br from-white/5 via-white/5 to-white/3 backdrop-blur-xl border-2 rounded-3xl p-6 transition-all duration-500 overflow-visible ".concat(m&&er?"border-green-500/60 shadow-2xl shadow-green-500/30":p&&er?"border-red-500/50 shadow-xl shadow-red-500/20":"border-white/10 hover:border-indigo-500/50 hover:shadow-2xl hover:shadow-indigo-500/20"),children:[(0,i.jsx)("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-r from-indigo-500/20 via-purple-500/20 to-pink-500/20 opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10 blur-xl"}),m&&er&&(0,i.jsx)(k.E.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 -z-10 bg-gradient-radial from-green-500/30 via-green-500/15 to-transparent blur-3xl rounded-3xl"}),!e.prediction&&(0,i.jsx)("div",{className:"absolute top-16 left-4 z-10 pointer-events-none",children:(0,i.jsxs)("div",{className:"relative w-10 h-10",children:[(0,i.jsxs)("svg",{className:"transform -rotate-90 w-10 h-10",children:[(0,i.jsx)("circle",{cx:"20",cy:"20",r:"16",stroke:"currentColor",strokeWidth:"2.5",fill:"none",className:"text-white/10"}),(0,i.jsx)(k.E.circle,{cx:"20",cy:"20",r:"16",stroke:"url(#gradient-".concat(e.id,")"),strokeWidth:"2.5",fill:"none",strokeLinecap:"round",strokeDasharray:"".concat(2*Math.PI*16),initial:{strokeDashoffset:2*Math.PI*16},animate:{strokeDashoffset:2*Math.PI*16*(1-x/100)},transition:{duration:.3}}),(0,i.jsx)("defs",{children:(0,i.jsxs)("linearGradient",{id:"gradient-".concat(e.id),x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,i.jsx)("stop",{offset:"0%",stopColor:"#5B7FFF"}),(0,i.jsx)("stop",{offset:"100%",stopColor:"#9333EA"})]})})]}),(0,i.jsxs)("span",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-bold text-white",children:[x,"%"]})]})}),(0,i.jsxs)("div",{className:"pb-3 mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500/20 to-purple-500/20 flex items-center justify-center border border-white/10",children:(0,i.jsx)("span",{className:"text-lg font-bold bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:t+1})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-white text-lg font-bold",children:(null===(a=e.features)||void 0===a?void 0:a.make)&&(null===(r=e.features)||void 0===r?void 0:r.model)?"".concat(e.features.make," ").concat(e.features.model):"Car ".concat(t+1)}),(null===(l=e.features)||void 0===l?void 0:l.year)&&(0,i.jsx)("p",{className:"text-xs text-gray-400",children:e.features.year})]}),m&&er&&(0,i.jsxs)(k.E.span,{initial:{scale:0},animate:{scale:1},className:"px-3 py-1 bg-gradient-to-r from-green-500/30 to-emerald-500/30 text-green-300 text-xs font-semibold rounded-full flex items-center gap-1.5 shadow-lg shadow-green-500/30 border border-green-500/30",children:[(0,i.jsx)(P.Z,{className:"h-3 w-3"}),"Best Deal"]})]}),u.length>1&&(0,i.jsx)(k.E.div,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"relative z-20",children:(0,i.jsx)(s.z,{variant:"ghost",size:"icon",onClick:()=>eh(e.id),className:"h-8 w-8 text-[#94a3b8] hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-all relative z-20",style:{pointerEvents:"auto"},children:(0,i.jsx)(A.Z,{className:"h-4 w-4"})})})]}),e.prediction&&(0,i.jsx)(k.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-3 p-3 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 rounded-xl border border-indigo-500/20",children:(0,i.jsx)("span",{className:"text-lg font-bold bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:(0,B.xG)(e.prediction.predicted_price)})})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[h||e.prediction?null:(0,i.jsxs)(k.E.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,i.jsx)(k.E.div,{animate:{y:[0,-10,0],rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"mb-4",children:(0,i.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-indigo-500/20 to-purple-500/20 flex items-center justify-center border-2 border-dashed border-indigo-500/30",children:(0,i.jsx)(R.Z,{className:"h-10 w-10 text-indigo-400/50"})})}),(0,i.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"Add car details to get started"}),(0,i.jsx)("p",{className:"text-xs text-gray-500",children:"Fill in the form below to compare"})]}),(0,i.jsx)(_,{formId:e.id,onSubmit:t=>ef(e.id,t),onStepChange:ex,onFormChange:(t,a)=>{t===e.id&&eg(t,a)},prefillData:e.features?{make:e.features.make||"",model:e.features.model||"",year:e.features.year||2020,mileage:null!==(o=e.features.mileage)&&void 0!==o?o:0,engine_size:null!==(d=e.features.engine_size)&&void 0!==d?d:2,cylinders:null!==(c=e.features.cylinders)&&void 0!==c?c:4,trim:e.features.trim||"",condition:e.features.condition||"Good",fuel_type:e.features.fuel_type||"Gasoline",location:e.features.location||"",color:e.features.color||""}:null,loading:e.loading||!1},e.id),e.prediction&&e.features&&(0,i.jsxs)(k.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-4 pt-4 border-t border-white/10 space-y-3",children:[(0,i.jsxs)("div",{className:"p-5 bg-gradient-to-br from-indigo-500/10 via-purple-500/10 to-pink-500/10 backdrop-blur-sm rounded-2xl border border-indigo-500/30 shadow-lg",children:[(0,i.jsxs)("div",{className:"text-xs uppercase tracking-wider text-gray-400 mb-3 flex items-center gap-2",children:[(0,i.jsx)(M.Z,{className:"h-3 w-3"}),"Predicted Price"]}),(0,i.jsx)("div",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:(0,B.xG)(e.prediction.predicted_price)}),e.prediction.confidence_range&&(0,i.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-300 mt-3",children:[(0,i.jsx)(L.Z,{className:"h-3 w-3 text-indigo-400"}),"Confidence: ",(0,i.jsxs)("span",{className:"font-semibold text-indigo-300",children:[e.prediction.confidence_range,"%"]})]})]}),e.prediction.deal_analysis&&(0,i.jsx)("div",{className:"p-3 bg-white/5 backdrop-blur-sm rounded-xl border border-white/10",children:(0,i.jsxs)("p",{className:"text-sm capitalize flex items-center gap-2",children:[(0,i.jsx)("span",{className:"font-semibold text-white",children:"Deal Rating:"}),(0,i.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("good"===e.prediction.deal_analysis.toLowerCase()||"excellent"===e.prediction.deal_analysis.toLowerCase()?"bg-green-500/20 text-green-300":"fair"===e.prediction.deal_analysis.toLowerCase()?"bg-yellow-500/20 text-yellow-300":"bg-red-500/20 text-red-300"),children:e.prediction.deal_analysis})]})})]})]})]})},e.id)})})})]})]})}):null}},80048:function(e,t,a){"use strict";a.d(t,{MQ:function(){return s},Tb:function(){return n},YE:function(){return l}});var i=a(57437),r=a(27815);function l(){return(0,i.jsxs)(r.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29] animate-pulse",children:[(0,i.jsx)("div",{className:"h-48 bg-[#2a2d3a] rounded-t-lg"}),(0,i.jsxs)(r.Ol,{children:[(0,i.jsx)("div",{className:"h-6 bg-[#2a2d3a] rounded w-3/4 mb-2"}),(0,i.jsx)("div",{className:"h-4 bg-[#2a2d3a] rounded w-1/2"})]}),(0,i.jsx)(r.aY,{children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"h-4 bg-[#2a2d3a] rounded w-full"}),(0,i.jsx)("div",{className:"h-4 bg-[#2a2d3a] rounded w-5/6"}),(0,i.jsx)("div",{className:"h-10 bg-[#2a2d3a] rounded w-full mt-4"})]})})]})}function n(){return(0,i.jsxs)("div",{className:"space-y-6 animate-pulse",children:[(0,i.jsx)("div",{className:"h-96 bg-[#2a2d3a] rounded-lg"}),(0,i.jsxs)(r.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29]",children:[(0,i.jsxs)(r.Ol,{children:[(0,i.jsx)("div",{className:"h-8 bg-[#2a2d3a] rounded w-3/4 mb-2"}),(0,i.jsx)("div",{className:"h-6 bg-[#2a2d3a] rounded w-1/2"})]}),(0,i.jsx)(r.aY,{children:(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(e=>(0,i.jsx)("div",{className:"h-16 bg-[#2a2d3a] rounded"},e))})})]})]})}function s(){return(0,i.jsxs)(r.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29] animate-pulse",children:[(0,i.jsx)(r.Ol,{children:(0,i.jsx)("div",{className:"h-6 bg-[#2a2d3a] rounded w-1/3"})}),(0,i.jsx)(r.aY,{children:(0,i.jsx)("div",{className:"h-64 bg-[#2a2d3a] rounded"})})]})}},93930:function(e,t,a){"use strict";a.d(t,{$F:function(){return u},AW:function(){return m},VD:function(){return h},Xi:function(){return p},h_:function(){return c}});var i=a(57437),r=a(2265),l=a(20949),n=a(17158),s=a(62442),o=a(76369),d=a(1657);let c=l.fC,u=l.xz;l.ZA,l.Uv,l.Tr,l.Ee,r.forwardRef((e,t)=>{let{className:a,inset:r,children:s,...o}=e;return(0,i.jsxs)(l.fF,{ref:t,className:(0,d.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",a),...o,children:[s,(0,i.jsx)(n.Z,{className:"ml-auto h-4 w-4 rtl:rotate-180"})]})}).displayName=l.fF.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,i.jsx)(l.tu,{ref:t,className:(0,d.cn)("z-[1000] min-w-[8rem] max-h-[60vh] overflow-y-auto overscroll-contain rounded-md border border-[#2a2d3a] bg-[#1a1d29] p-1 text-white shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=l.tu.displayName;let m=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,i.jsx)(l.Uv,{children:(0,i.jsx)(l.VY,{ref:t,sideOffset:r,className:(0,d.cn)("z-[1000] min-w-[8rem] max-h-[60vh] overflow-y-auto overscroll-contain rounded-md border border-[#2a2d3a] bg-[#1a1d29] p-1 text-white shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});m.displayName=l.VY.displayName;let p=r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,i.jsx)(l.ck,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-[#2a2d3a] focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",a),...n})});p.displayName=l.ck.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:n,...o}=e;return(0,i.jsxs)(l.oC,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-[#2a2d3a] focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:n,...o,children:[(0,i.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(l.wU,{children:(0,i.jsx)(s.Z,{className:"h-4 w-4"})})}),r]})}).displayName=l.oC.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,i.jsxs)(l.Rk,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-[#2a2d3a] focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,i.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(l.wU,{children:(0,i.jsx)(o.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=l.Rk.displayName,r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,i.jsx)(l.__,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold text-[#94a3b8]",r&&"pl-8",a),...n})}).displayName=l.__.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,i.jsx)(l.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-[#2a2d3a]",a),...r})});h.displayName=l.Z0.displayName},86443:function(e,t,a){"use strict";a.d(t,{r:function(){return s}});var i=a(57437),r=a(2265),l=a(92376),n=a(1657);let s=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,i.jsx)(l.fC,{className:(0,n.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500 focus-visible:ring-offset-2 focus-visible:ring-offset-gray-900 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-[#8B5CF6] data-[state=unchecked]:bg-gray-700",a),...r,ref:t,children:(0,i.jsx)(l.bU,{className:(0,n.cn)("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});s.displayName=l.fC.displayName}},function(e){e.O(0,[7895,116,263,4829,6376,3226,7169,7633,8777,555,9782,3802,1236,4049,8898,3572,3775,1572,2971,4938,1744],function(){return e(e.s=80607)}),_N_E=e.O()}]);