(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2e3],{49039:function(e,t,a){Promise.resolve().then(a.bind(a,31881))},31881:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ea}});var r=a(57437),l=a(2265),s=a(24033),i=a(61396),n=a.n(i),o=a(16691),d=a.n(o),c=a(50116),m=a(85754),h=a(63572),x=a(45922),u=a(28203),b=a(96142),g=a(12741),p=a(32176),f=a(53505),w=a(81291),v=a(17158),j=a(35157),N=a(22112),k=a(29409),y=a(22505),S=a(20597),C=a(1806),z=a(27815),_=a(1657),Z=a(29251),L=a(98777);function E(e){let{listingId:t,make:a,model:i,year:n,price:o}=e,x=(0,s.useRouter)(),u=(0,c.useLocale)()||"en",[b,g]=(0,l.useState)([]),[p,f]=(0,l.useState)(!0),[j,N]=(0,l.useState)(0);(0,l.useEffect)(()=>{k()},[t,a,i,n,o]);let k=async()=>{f(!0);try{let e=((await h.apiClient.searchListings({makes:a,models:i,min_year:n-2,max_year:n+2,min_price:.7*o,max_price:1.3*o,page:1,page_size:6})).items||[]).filter(e=>e.id!==t).slice(0,6).map(e=>{var t,a;return{id:e.id,listing_id:e.id,make:e.make,model:e.model,year:e.year,price:e.price,mileage:e.mileage,condition:e.condition,image_url:null===(a=e.images)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.url,location_city:e.location_city}});g(e)}catch(e){console.error("Error loading similar cars:",e)}finally{f(!1)}},y=b.slice(j,j+4),S=j>0,C=j+4<b.length;return p?(0,r.jsx)(z.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29]",children:(0,r.jsx)(z.aY,{className:"py-8 text-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#5B7FFF] mx-auto"})})}):0===b.length?null:(0,r.jsx)(z.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29]",children:(0,r.jsxs)(z.aY,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white",children:"Similar Cars"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(m.z,{variant:"ghost",size:"icon",onClick:()=>N(Math.max(0,j-1)),disabled:!S,className:"text-white hover:bg-[#2a2d3a]",children:(0,r.jsx)(w.Z,{className:"h-4 w-4"})}),(0,r.jsx)(m.z,{variant:"ghost",size:"icon",onClick:()=>N(Math.min(b.length-4,j+1)),disabled:!C,className:"text-white hover:bg-[#2a2d3a]",children:(0,r.jsx)(v.Z,{className:"h-4 w-4 rtl:rotate-180"})})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:y.map((e,t)=>(0,r.jsx)(L.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1*t},children:(0,r.jsxs)(z.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29] hover:border-[#5B7FFF]/50 transition-all cursor-pointer",onClick:()=>x.push("/".concat(u,"/buy-sell/").concat(e.listing_id)),children:[(0,r.jsx)("div",{className:"relative h-32 bg-gradient-to-br from-[#5B7FFF]/20 to-[#8B5CF6]/20",children:e.image_url?(0,r.jsx)(d(),{src:(0,_.wo)(e.image_url),alt:"".concat(e.make," ").concat(e.model," ").concat(e.year),fill:!0,className:"object-cover",sizes:"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 25vw",loading:"lazy"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center","aria-label":"".concat(e.make," ").concat(e.model),children:(0,r.jsx)(Z.Z,{className:"h-12 w-12 text-white/50","aria-hidden":"true"})})}),(0,r.jsxs)(z.aY,{className:"p-3",children:[(0,r.jsxs)("h4",{className:"text-sm font-semibold text-white truncate",children:[e.make," ",e.model]}),(0,r.jsxs)("p",{className:"text-xs text-[#94a3b8] mb-2",children:[e.year," • ",e.mileage.toLocaleString()," km"]}),(0,r.jsx)("p",{className:"text-lg font-bold text-[#5B7FFF]",children:(0,_.xG)(e.price)})]})]})},e.id))})]})})}var A=a(42706),I=a(29764),F=a(1798),M=a(83039),D=a(27461),R=a(1295),T=a(56224),q=a(13546),O=a(25703);function P(e){let{listing:t,url:s}=e,[i,n]=(0,l.useState)(!1),[o,d]=(0,l.useState)(null),c=(0,O.useToast)()||{toast:()=>{}},h="Check out this ".concat(t.year," ").concat(t.make," ").concat(t.model," for ").concat(t.price.toLocaleString(),"!"),x=async e=>{let a=encodeURIComponent(s),r=encodeURIComponent(h),l={whatsapp:"https://wa.me/?text=".concat(r,"%20").concat(a),facebook:"https://www.facebook.com/sharer/sharer.php?u=".concat(a),twitter:"https://twitter.com/intent/tweet?text=".concat(r,"&url=").concat(a),linkedin:"https://www.linkedin.com/sharing/share-offsite/?url=".concat(a),email:"mailto:?subject=".concat(encodeURIComponent("".concat(t.year," ").concat(t.make," ").concat(t.model)),"&body=").concat(r,"%20").concat(a)}[e];l&&window.open(l,"_blank","width=600,height=400")},u=async()=>{try{await navigator.clipboard.writeText(s),(null==c?void 0:c.toast)&&c.toast({title:"Link copied",description:"Listing link copied to clipboard"}),n(!1)}catch(e){console.error("Failed to copy:",e)}},b=async()=>{try{let e=(await a.e(5298).then(a.t.bind(a,75298,19))).default,t=await e.toDataURL(s,{width:300});d(t)}catch(e){console.error("Error generating QR code:",e),d("https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=".concat(encodeURIComponent(s)))}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(m.z,{onClick:()=>n(!0),variant:"outline",className:"backdrop-blur-xl bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all",children:[(0,r.jsx)(I.Z,{className:"h-4 w-4 mr-2"}),"Share"]}),(0,r.jsx)(A.Vq,{open:i,onOpenChange:n,children:(0,r.jsxs)(A.cZ,{className:"bg-[#1a1d29] border-[#2a2d3a] text-white",children:[(0,r.jsxs)(A.fK,{children:[(0,r.jsx)(A.$N,{children:"Share Listing"}),(0,r.jsxs)(A.Be,{className:"text-[#94a3b8]",children:["Share this ",t.year," ",t.make," ",t.model]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[(0,r.jsxs)(m.z,{onClick:()=>x("whatsapp"),variant:"outline",className:"border-[#2a2d3a] bg-[#1a1d29] hover:bg-[#2a2d3a] text-white justify-start",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"WhatsApp"]}),(0,r.jsxs)(m.z,{onClick:()=>x("facebook"),variant:"outline",className:"border-[#2a2d3a] bg-[#1a1d29] hover:bg-[#2a2d3a] text-white justify-start",children:[(0,r.jsx)(F.Z,{className:"h-4 w-4 mr-2"}),"Facebook"]}),(0,r.jsxs)(m.z,{onClick:()=>x("twitter"),variant:"outline",className:"border-[#2a2d3a] bg-[#1a1d29] hover:bg-[#2a2d3a] text-white justify-start",children:[(0,r.jsx)(M.Z,{className:"h-4 w-4 mr-2"}),"Twitter"]}),(0,r.jsxs)(m.z,{onClick:()=>x("linkedin"),variant:"outline",className:"border-[#2a2d3a] bg-[#1a1d29] hover:bg-[#2a2d3a] text-white justify-start",children:[(0,r.jsx)(D.Z,{className:"h-4 w-4 mr-2"}),"LinkedIn"]}),(0,r.jsxs)(m.z,{onClick:()=>x("email"),variant:"outline",className:"border-[#2a2d3a] bg-[#1a1d29] hover:bg-[#2a2d3a] text-white justify-start",children:[(0,r.jsx)(R.Z,{className:"h-4 w-4 mr-2"}),"Email"]}),(0,r.jsxs)(m.z,{onClick:u,variant:"outline",className:"border-[#2a2d3a] bg-[#1a1d29] hover:bg-[#2a2d3a] text-white justify-start",children:[(0,r.jsx)(T.Z,{className:"h-4 w-4 mr-2"}),"Copy Link"]}),(0,r.jsxs)(m.z,{onClick:b,variant:"outline",className:"border-[#2a2d3a] bg-[#1a1d29] hover:bg-[#2a2d3a] text-white justify-start col-span-2",children:[(0,r.jsx)(q.Z,{className:"h-4 w-4 mr-2"}),"Generate QR Code"]})]}),o&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-[#2a2d3a] rounded-lg text-center",children:[(0,r.jsx)("img",{src:o,alt:"QR Code",className:"mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-sm text-[#94a3b8]",children:"Scan to view listing"})]})]})})]})}var B=a(80048);function V(e){var t,a,l,s;let{listing:i}=e;if(!i)return null;let n={"@context":"https://schema.org","@type":"Vehicle",name:[null==i?void 0:i.year,null==i?void 0:i.make,null==i?void 0:i.model].filter(e=>null!=e&&""!==e).map(e=>String(e)).join(" ").trim()||"Vehicle",offers:{"@type":"Offer",price:Number(null!==(t=null==i?void 0:i.price)&&void 0!==t?t:0),priceCurrency:"USD",availability:"https://schema.org/InStock",url:window.location.href},mileageFromOdometer:{"@type":"QuantitativeValue",value:Number(null!==(a=null==i?void 0:i.mileage)&&void 0!==a?a:0),unitCode:"KM"}};return(null==i?void 0:i.id)!=null&&(n.identifier=String(i.id)),(null==i?void 0:i.make)!=null&&""!==i.make&&(n.brand={"@type":"Brand",name:String(i.make)}),(null==i?void 0:i.model)!=null&&""!==i.model&&(n.model=String(i.model)),(null==i?void 0:i.year)!=null&&(n.productionDate=String(i.year)),(null==i?void 0:i.transmission)!=null&&""!==i.transmission&&(n.vehicleConfiguration=String(i.transmission)),(null==i?void 0:i.fuel_type)!=null&&""!==i.fuel_type&&(n.fuelType=String(i.fuel_type)),(null==i?void 0:i.condition)!=null&&""!==i.condition&&(n.itemCondition="https://schema.org/".concat(String(i.condition),"Condition")),(null==i?void 0:i.location_city)&&(n.availableAtOrFrom={"@type":"Place",name:String(null!==(l=i.location_city)&&void 0!==l?l:"")}),(null==i?void 0:i.description)&&(n.description=String(null!==(s=i.description)&&void 0!==s?s:"")),(null==i?void 0:i.images)&&i.images.length>0&&(n.image=i.images.map(e=>(0,_.wo)(null==e?void 0:e.url)).filter(Boolean)),(0,r.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(n)}})}var W=a(86095),Y=a(6678),H=a(82549),U=a(62167),$=a(38438);function K(e){let{images:t,currentIndex:a,isOpen:s,onClose:i,onNavigate:n,getImageUrl:o=e=>e||"",isVideoUrl:c=()=>!1}=e,[m,h]=(0,l.useState)(a),[x,u]=(0,l.useState)(null);(0,l.useEffect)(()=>{s&&(h(a),u(null))},[a,s]),(0,l.useEffect)(()=>{let e=e=>{s&&("Escape"===e.key?i():"ArrowLeft"===e.key?(e.preventDefault(),b()):"ArrowRight"===e.key&&(e.preventDefault(),g()))};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[s,m,t.length,i]);let b=()=>{let e=(m-1+t.length)%t.length;h(e),null==n||n(e)},g=()=>{let e=(m+1)%t.length;h(e),null==n||n(e)},p=t[m],f=(null==p?void 0:p.url)?o(p.url):"",j=null!=p&&!!p.url&&c(p.url);return s&&p?(0,r.jsx)(U.M,{children:s&&(0,r.jsxs)(L.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/95 z-[1100] flex items-center justify-center p-4",onClick:i,children:[(0,r.jsx)("button",{onClick:i,className:"absolute top-4 right-4 z-[1200] p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-200 backdrop-blur-sm border border-white/10","aria-label":"Close gallery",children:(0,r.jsx)(H.Z,{className:"w-5 h-5"})}),t.length>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),b()},className:"absolute left-4 top-1/2 -translate-y-1/2 z-[1200] p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-200 backdrop-blur-sm border border-white/10 touch-manipulation","aria-label":"Previous image",children:(0,r.jsx)(w.Z,{className:"w-6 h-6"})}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),g()},className:"absolute right-4 top-1/2 -translate-y-1/2 z-[1200] p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors duration-200 backdrop-blur-sm border border-white/10 touch-manipulation","aria-label":"Next image",children:(0,r.jsx)(v.Z,{className:"w-6 h-6 rtl:rotate-180"})}),(0,r.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-[1200] bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full text-white text-sm font-medium border border-white/10",children:[m+1," / ",t.length]})]}),(0,r.jsx)(L.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2},className:"relative max-w-[95vw] max-h-[90vh] flex items-center justify-center",onClick:e=>e.stopPropagation(),children:f?j?(0,r.jsx)("video",{src:f,controls:!0,playsInline:!0,className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl",onClick:e=>e.stopPropagation()}):(0,r.jsx)("div",{className:"relative w-full h-full max-w-[95vw] max-h-[90vh] flex items-center justify-center",children:x===m?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center w-full h-full bg-gray-900/50 rounded-lg p-8",children:[(0,r.jsx)($.Z,{className:"w-16 h-16 text-gray-400 mb-4"}),(0,r.jsx)("p",{className:"text-gray-400 text-lg",children:"Image failed to load"}),(0,r.jsx)(d(),{src:"/images/cars/default-car.jpg",alt:"Fallback image",width:800,height:600,className:"max-w-full max-h-[70vh] object-contain rounded-lg mt-4",quality:85})]}):(0,r.jsx)(d(),{src:f,alt:"Image ".concat(m+1),width:1920,height:1080,className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl",onClick:e=>e.stopPropagation(),quality:90,priority:0===m,unoptimized:f.startsWith("blob:")||f.startsWith("data:"),onError:()=>{console.error("[ImageGalleryLightbox] Image load error:",f),u(m)}})}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-lg bg-gray-900/50 rounded-lg p-8",children:"No image available"})},m),t.length>1&&(0,r.jsx)("div",{className:"absolute bottom-16 left-1/2 -translate-x-1/2 z-[1200] max-w-[90vw] overflow-x-auto py-2",children:(0,r.jsx)("div",{className:"flex gap-2 px-4",children:t.map((e,t)=>{let a=(null==e?void 0:e.url)?o(e.url):"",l=null!=e&&!!e.url&&c(e.url);return(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),h(t),null==n||n(t)},className:"flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 transition-all ".concat(t===m?"border-indigo-500 ring-2 ring-indigo-500/50 shadow-lg shadow-indigo-500/30":"border-white/20 hover:border-white/40"),"aria-label":"View image ".concat(t+1),children:a?l?(0,r.jsx)("video",{src:a,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}):(0,r.jsx)(d(),{src:a,alt:"",width:64,height:64,className:"w-full h-full object-cover",quality:75,unoptimized:a.startsWith("blob:")||a.startsWith("data:"),onError:e=>{let t=e.target;t.src="/images/cars/default-car.jpg",t.onerror=null}}):(0,r.jsx)("div",{className:"w-full h-full bg-gray-700/50 flex items-center justify-center text-gray-400 text-xs",children:"—"})},t)})})})]})}):null}var Q=a(53905),G=a(20173),J=a(82104);function X(e){let{listingId:t,isSold:a,onMarkSold:l,onMarkAvailable:s,togglingSold:i,className:o=""}=e,d=(0,c.useLocale)()||"en",h=(0,c.useTranslations)("listing");return(0,r.jsxs)("div",{className:o,children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:h("manageListing")||"Manage Listing"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(m.z,{variant:"outline",asChild:!0,className:"w-full border-white/10 text-gray-300 hover:bg-white/5 backdrop-blur-sm min-h-[44px]",children:(0,r.jsxs)(n(),{href:"/".concat(d,"/my-listings?edit=").concat(t),children:[(0,r.jsx)(Q.Z,{className:"h-4 w-4 mr-2"}),h("editListing")]})}),a?(0,r.jsxs)(m.z,{variant:"secondary",onClick:s,disabled:i,className:"w-full border-white/10 text-emerald-400 hover:bg-emerald-500/10 backdrop-blur-sm min-h-[44px]",children:[(0,r.jsx)(J.Z,{className:"h-4 w-4 mr-2"}),h("markAsAvailable")]}):(0,r.jsxs)(m.z,{variant:"destructive",onClick:l,disabled:i,className:"w-full backdrop-blur-sm min-h-[44px]",children:[(0,r.jsx)(G.Z,{className:"h-4 w-4 mr-2"}),h("markAsSold")]})]})]})}var ee=a(35498);function et(e){if(!e)return"";let t=String(e).replace(/\D/g,"");if(t.length<10)return"";let a=t.replace(/^964/,"").slice(-10);return a.length<10?"":"+964 ".concat(a.slice(0,3)," ").concat(a.slice(3,6)," ").concat(a.slice(6))}function ea(){var e,t,a,i;let o=(0,s.useParams)(),z=(0,s.useRouter)(),Z=(0,c.useLocale)(),L=(0,c.useTranslations)("listing"),I=(0,c.useTranslations)("common"),{toast:F}=(0,O.useToast)(),{user:M,isAuthenticated:D}=(0,W.a)(),{user:R}=(0,Y.useAuthContext)(),T=null==o?void 0:o.id,[q,H]=(0,l.useState)(null),[U,$]=(0,l.useState)(!0),[Q,G]=(0,l.useState)(0),[J,ea]=(0,l.useState)(!1),[er,el]=(0,l.useState)(!1),[es,ei]=(0,l.useState)([]),[en,eo]=(0,l.useState)(!1),[ed,ec]=(0,l.useState)(!1),[em,eh]=(0,l.useState)(!1),[ex,eu]=(0,l.useState)(!1),[eb,eg]=(0,l.useState)(null),ep=(0,l.useRef)(null),ef=(0,l.useCallback)(async()=>{if(!T||!String(T).trim()){$(!1),eg(L("invalidId")),F({title:I("error"),description:L("invalidId"),variant:"destructive"});return}ep.current&&ep.current.abort();let e=new AbortController;ep.current=e,$(!0),eg(null);let t=setTimeout(()=>{console.error("⏰ Timeout after 10s - listing fetch too slow"),e.abort(),eg("Request timeout - please refresh"),$(!1)},1e4);try{if(/^\d+$/.test(String(T||"").trim())){let a=parseInt(T,10),r=await h.apiClient.getListing(a);if(clearTimeout(t),e.signal.aborted)return;if(!r)throw Error("Listing not found");H({...r,fromSupabase:!1}),el(r.is_saved||!1);let l=r.title||"".concat(r.year," ").concat(r.make," ").concat(r.model);ee.activityHelpers.logViewListing(a,l);try{let t=await h.apiClient.getPriceHistory(a,30);e.signal.aborted||ei(t.history||[])}catch(e){}}else{let{data:a,error:r}=await x.supabase.from("car_listings").select("*").eq("id",String(T).trim()).single();if(clearTimeout(t),e.signal.aborted)return;if(r||!a)throw Error("Listing not found");let l=function(e){let t=e.images||[],a=t.map(e=>{var t;return"string"==typeof e?{url:e}:{url:null!==(t=null==e?void 0:e.url)&&void 0!==t?t:e}}),r=t[0],l="string"==typeof r?r:null==r?void 0:r.url,s=String(e.location||"").split(",").map(e=>e.trim()).filter(Boolean),i=s[s.length-1]||"",n=s.length>2?s[1]:"",o=s[0]||"",d=String(e.condition||""),c=d?d.charAt(0).toUpperCase()+d.slice(1).toLowerCase():"";return{...e,images:a,cover_image:l,location_city:o,location_state:n,location_country:i,location:e.location,mileage_unit:"km",color:e.color||"",features:Array.isArray(e.features)?e.features:[],phone:e.phone||void 0,phone_country_code:e.phone_country_code||void 0,whatsapp:e.whatsapp||void 0,vin:e.vin||void 0,trim:e.trim||"",condition:c}}(a);H({...l,fromSupabase:!0}),ei([]);let s=l.title||"".concat(l.year," ").concat(l.make," ").concat(l.model);ee.activityHelpers.logViewListing(String(T),s)}}catch(r){if(clearTimeout(t),r instanceof Error&&"AbortError"===r.name)return;let a=r instanceof Error?r.message:void 0;console.error("❌ Error loading listing:",r),e.signal.aborted||(eg(a||L("loadError")),F({title:I("error"),description:a||L("loadError"),variant:"destructive"}),H(null))}finally{clearTimeout(t),$(!1)}},[T,F,L,I]);if((0,l.useEffect)(()=>{eu(!1),G(0),H(null),$(!0)},[T]),(0,l.useEffect)(()=>(T?ef():($(!1),eg(L("invalidId")),F({title:I("error"),description:L("invalidId"),variant:"destructive"})),()=>{ep.current&&ep.current.abort()}),[T,ef,F,L,I]),U)return(0,r.jsxs)("div",{className:"relative min-h-screen text-gray-100",children:[(0,r.jsx)("div",{className:"absolute inset-0 -z-10 overflow-hidden pointer-events-none",children:(0,r.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[1000px] h-[600px] bg-gradient-radial from-indigo-500/15 via-purple-500/10 to-transparent blur-3xl"})}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 pt-8 pb-12 md:pt-12 md:pb-16",children:(0,r.jsx)(B.Tb,{})})]});if(!q)return(0,r.jsxs)("div",{className:"relative min-h-screen flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 -z-10 overflow-hidden pointer-events-none",children:(0,r.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[1000px] h-[600px] bg-gradient-radial from-indigo-500/15 via-purple-500/10 to-transparent blur-3xl"})}),(0,r.jsxs)("div",{className:"backdrop-blur-xl bg-white/80 dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-8 max-w-md text-center shadow-2xl",children:[(0,r.jsx)("p",{className:"text-slate-900 dark:text-white text-xl mb-2 font-semibold",children:eb||L("notFound")}),eb&&(0,r.jsx)("p",{className:"text-slate-600 dark:text-gray-400 text-sm mb-6",children:L("loadError")}),(0,r.jsxs)("div",{className:"flex gap-3 justify-center",children:[eb&&(0,r.jsx)(m.z,{onClick:()=>{eg(null),ef()},className:"bg-indigo-600 hover:bg-indigo-500 h-11 px-6 font-medium shadow-lg shadow-indigo-500/20",children:"Retry"}),(0,r.jsx)(m.z,{onClick:()=>z.push("/".concat(Z,"/buy-sell")),variant:"outline",className:"border-white/10 text-gray-300 hover:bg-white/5 h-11 px-6",children:L("backToMarketplace")})]})]})]});let ew=q.images||[],ev=ew.map(e=>{var t;return"string"==typeof e?{url:e}:{url:null!==(t=null==e?void 0:e.url)&&void 0!==t?t:""}}).filter(e=>e.url),ej=Math.min(Q,Math.max(0,ev.length-1)),eN=ev[ej]||ev[0]||null,ek=(null==eN?void 0:eN.url)||q.cover_image||("string"==typeof ew[0]?ew[0]:null===(e=ew[0])||void 0===e?void 0:e.url),ey=ek?(0,_.wo)(ek):"",eS=(0,_.cb)(ek),eC=q.phone||function(e){if(!e||"string"!=typeof e)return null;let t=e.match(/\+?[\d][\d\s\-]{9,}/);if(!t)return null;let a=t[0].replace(/\D/g,"");if(a.length<10)return null;let r=a.replace(/^964/,"");return"+964".concat(r.slice(-10))}(q.description),ez=q.whatsapp||eC,e_=function(e){if(!e||"string"!=typeof e)return"";let t=e;return(t=(t=t.replace(/(Contact|WhatsApp|Tel|Phone|Call me|Reach me):\s*[^\n]+/gi,"")).replace(/\+\d[\d\s\-]{8,}/g,"")).replace(/\n{3,}/g,"\n\n").trim()}(q.description),eZ=!!(eC||ez),eL=function(e){if(!e)return"";let t=String(e).replace(/\D/g,"");if(t.length<10)return"";let a=t.startsWith("964")?t:"964"+t.slice(-10);return"tel:+".concat(a)}(eC),eE=function(e){if(!e)return"";let t=String(e).replace(/\D/g,"");if(t.length<10)return"";let a=t.startsWith("964")?t:"964"+t.slice(-10);return"https://wa.me/".concat(a)}(ez),eA=!!(null==q?void 0:q.fromSupabase)&&!!(null==R?void 0:R.id)&&String(q.user_id)===String(R.id),eI=!!(null==q?void 0:q.is_sold),eF=async()=>{if(!eA||!(null==q?void 0:q.fromSupabase)||!(null==R?void 0:R.id)){F({title:L("unauthorizedManage"),variant:"destructive"});return}eh(!0);try{let{error:e}=await x.supabase.from("car_listings").update({is_sold:!0}).eq("id",q.id).eq("user_id",R.id);if(e)throw e;let t=q.title||"".concat(q.year," ").concat(q.make," ").concat(q.model);ee.activityHelpers.logMarkSold(String(q.id),t),eo(!1),F({title:L("markAsSold"),description:L("confirmMarkSoldSuccess")}),await ef()}catch(t){let e=t instanceof Error?t.message:"Failed";F({title:L("unauthorizedManage"),description:e,variant:"destructive"})}finally{eh(!1)}},eM=async()=>{if(!eA||!(null==q?void 0:q.fromSupabase)||!(null==R?void 0:R.id)){F({title:L("unauthorizedManage"),variant:"destructive"});return}eh(!0);try{let{error:e}=await x.supabase.from("car_listings").update({is_sold:!1}).eq("id",q.id).eq("user_id",R.id);if(e)throw e;ec(!1),F({title:L("markAsAvailable"),description:L("confirmMarkAvailableSuccess")}),await ef()}catch(t){let e=t instanceof Error?t.message:"Failed";F({title:L("unauthorizedManage"),description:e,variant:"destructive"})}finally{eh(!1)}},eD=(0,r.jsxs)("div",{className:"backdrop-blur-sm bg-white/5 border border-white/10 rounded-2xl p-5 md:p-6 mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-4 md:mb-5",children:L("contactSeller")}),(0,r.jsxs)("div",{className:"space-y-4 mb-5",children:[(0,r.jsxs)("div",{className:"text-sm text-slate-700 dark:text-gray-300 space-y-2.5",children:[(0,r.jsxs)("p",{className:"flex items-center gap-2 text-sm md:text-base",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 shrink-0 text-gray-400"}),(0,r.jsx)("span",{children:new Date(q.created_at).toLocaleDateString()})]}),(0,r.jsxs)("p",{className:"flex items-center gap-2 text-sm md:text-base",children:[(0,r.jsx)(b.Z,{className:"h-4 w-4 shrink-0 text-gray-400"}),(0,r.jsx)("span",{children:[q.location_city,q.location_state,q.location_country].filter(Boolean).join(", ")||q.location||"—"})]})]}),eZ?(0,r.jsxs)("div",{className:"space-y-3 md:space-y-4",children:[eC&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-400 dark:text-gray-500 text-xs mb-2 font-medium uppercase tracking-wide",children:L("phone")}),(0,r.jsxs)("a",{href:eL,className:"flex items-center gap-2 text-white dark:text-white font-semibold text-base md:text-lg hover:text-indigo-400 focus:outline-none focus:underline transition-colors",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5 shrink-0 text-emerald-400"}),et(eC)]})]}),ez&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-slate-600 dark:text-gray-400 text-xs mb-2 font-medium uppercase tracking-wide",children:"WhatsApp"}),(0,r.jsxs)("a",{href:eE,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-slate-900 dark:text-white font-semibold text-base md:text-lg hover:text-emerald-600 dark:hover:text-emerald-400 focus:outline-none focus:underline transition-colors",children:[(0,r.jsx)(p.Z,{className:"h-5 w-5 shrink-0 text-emerald-400"}),et(ez)]})]})]}):(0,r.jsx)("p",{className:"text-gray-400 text-sm py-3",children:L("contactNotAvailable")})]}),(0,r.jsxs)("div",{className:"pt-4 border-t border-white/10 space-y-3",children:[(0,r.jsxs)("p",{className:"text-amber-400/90 text-xs flex items-start gap-2 leading-relaxed",style:{fontSize:"clamp(12px, 3vw, 14px)"},children:[(0,r.jsx)("span",{className:"text-base",children:"⚠"}),(0,r.jsx)("span",{children:L("safetyTip")})]}),(0,r.jsxs)(m.z,{variant:"outline",className:"w-full border-white/10 text-gray-300 hover:bg-white/5 h-10 md:h-11 min-h-[44px] touch-manipulation",children:[(0,r.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),L("reportListing")]})]})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V,{listing:q}),(0,r.jsxs)("div",{className:"relative min-h-screen text-gray-100",children:[(0,r.jsx)("div",{className:"absolute inset-0 -z-10 overflow-hidden pointer-events-none",children:(0,r.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[1000px] h-[600px] bg-gradient-radial from-indigo-500/15 via-purple-500/10 to-transparent blur-3xl"})}),(0,r.jsx)(n(),{href:"/".concat(Z,"/buy-sell"),className:"!fixed md:!absolute top-20 left-4 md:top-6 md:left-6 !z-[100] group",children:(0,r.jsxs)("button",{className:"flex items-center gap-2 bg-slate-800/80 backdrop-blur-md hover:bg-slate-900/90 border border-white/30 hover:border-white/40 rounded-full px-4 py-2.5 shadow-xl hover:shadow-2xl transition-all duration-300 active:scale-95 min-w-[44px] min-h-[44px] touch-manipulation",children:[(0,r.jsx)(w.Z,{className:"w-5 h-5 text-white flex-shrink-0"}),(0,r.jsx)("span",{className:"hidden sm:inline text-white font-medium text-sm whitespace-nowrap",children:L("backToMarketplace")||"Back to Marketplace"})]})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 md:px-8 pt-0 ".concat(eZ?"pb-28 md:pb-16":"pb-12 md:pb-16"," md:pt-0 scroll-smooth"),style:eZ?{paddingBottom:"112px"}:void 0,children:[eA&&(0,r.jsx)("div",{className:"lg:hidden mb-6 mt-20 md:mt-0",children:(0,r.jsx)("div",{className:"backdrop-blur-sm bg-white/80 dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 shadow-sm",children:(0,r.jsx)(X,{listingId:q.id,isSold:eI,onMarkSold:()=>eo(!0),onMarkAvailable:()=>ec(!0),togglingSold:em})})}),(0,r.jsxs)("div",{className:"relative w-full mb-6 md:mb-10",children:[(0,r.jsxs)("div",{className:"relative aspect-video overflow-hidden rounded-2xl cursor-pointer group border border-white/10 shadow-2xl",onClick:()=>{ev.length>0&&ea(!0)},children:[eI&&(0,r.jsx)("div",{className:"absolute top-0 left-0 right-0 z-30 py-3 bg-red-600/95 text-white text-center font-bold text-lg shadow-lg backdrop-blur-sm","aria-hidden":!0,children:"SOLD"}),ey?eS?(0,r.jsx)("video",{src:ey,controls:!0,playsInline:!0,className:"w-full h-full object-cover",onClick:e=>e.stopPropagation()}):(0,r.jsx)("div",{className:"relative w-full h-full",children:ex?(0,r.jsx)(d(),{src:"/images/cars/default-car.jpg",alt:"Default car",fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 90vw, 80vw",className:"object-cover",quality:85},"fallback"):(0,r.jsx)(d(),{src:ey,alt:"".concat(q.year," ").concat(q.make," ").concat(q.model),fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 90vw, 80vw",className:"object-cover transition-transform duration-300 group-hover:scale-105",priority:!0,quality:90,unoptimized:ey.startsWith("blob:")||ey.startsWith("data:"),onError:()=>{console.error("[ListingDetail] Hero image load error:",ey),eu(!0)}},"".concat(T,"-").concat(ey))}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500 text-sm bg-gradient-to-br from-gray-900 to-black",children:L("noImageAvailable")}),ev.length>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),G(e=>(e-1+ev.length)%ev.length)},className:"absolute left-1 md:left-4 top-1/2 -translate-y-1/2 z-20 bg-black/60 hover:bg-black/80 active:bg-black/90 backdrop-blur-md text-white p-4 md:p-3 rounded-full touch-manipulation shadow-xl transition-all min-w-[56px] min-h-[56px] md:min-w-[48px] md:min-h-[48px] flex items-center justify-center","aria-label":L("previousImage"),children:(0,r.jsx)(w.Z,{className:"h-7 w-7 md:h-6 md:w-6"})}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),G(e=>(e+1)%ev.length)},className:"absolute right-1 md:right-4 top-1/2 -translate-y-1/2 z-20 bg-black/60 hover:bg-black/80 active:bg-black/90 backdrop-blur-md text-white p-4 md:p-3 rounded-full touch-manipulation shadow-xl transition-all min-w-[56px] min-h-[56px] md:min-w-[48px] md:min-h-[48px] flex items-center justify-center","aria-label":L("nextImage"),children:(0,r.jsx)(v.Z,{className:"h-7 w-7 md:h-6 md:w-6 rtl:rotate-180"})})]}),ev.length>1&&(0,r.jsxs)("div",{className:"absolute top-3 right-3 md:top-4 md:right-4 z-20 bg-black/60 backdrop-blur-md px-3 py-1.5 rounded-full text-white text-sm font-medium shadow-lg pointer-events-none",children:[Math.min(Q,ev.length-1)+1," / ",ev.length]}),(0,r.jsxs)("div",{className:"absolute bottom-2 left-2 right-2 md:bottom-4 md:left-4 md:right-4 z-10 backdrop-blur-xl bg-gradient-to-t from-black/60 to-black/40 border border-white/20 rounded-xl p-3 md:p-4 shadow-2xl space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2 md:gap-3",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("h1",{className:"text-lg md:text-2xl font-bold text-white tracking-tight leading-tight",children:[q.year," ",q.make," ",q.model,q.trim?" ".concat(q.trim):""]}),eI&&q.sold_at&&(0,r.jsxs)("p",{className:"text-red-400 text-xs md:text-sm mt-1",children:[L("soldOn"),": ",new Date(q.sold_at).toLocaleDateString()]})]}),(0,r.jsx)("div",{className:"flex-shrink-0",children:(null==q?void 0:q.id)&&(0,r.jsx)("div",{className:"[&>button]:bg-white/20 [&>button]:hover:bg-white/30 [&>button]:active:bg-white/40 [&>button]:backdrop-blur-md [&>button]:rounded-full [&>button]:p-2.5 md:[&>button]:p-3 [&>button]:min-w-[44px] [&>button]:min-h-[44px] [&>button]:border-0",children:(0,r.jsx)(C._,{listingId:q.id,initialFavorite:er,size:"md",onToggle:e=>el(e)})})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 md:gap-3",children:[(0,r.jsx)("div",{className:"flex-1 min-w-0",children:(0,r.jsxs)("p",{className:"text-2xl md:text-3xl font-bold text-emerald-400 leading-tight",style:{textShadow:"0 0 20px rgba(16, 185, 129, 0.5)"},children:["$",null===(t=q.price)||void 0===t?void 0:t.toLocaleString()]})}),(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"[&>button]:bg-white/20 [&>button]:hover:bg-white/30 [&>button]:active:bg-white/40 [&>button]:backdrop-blur-md [&>button]:rounded-lg [&>button]:p-2.5 md:[&>button]:p-3 [&>button]:min-w-[44px] [&>button]:min-h-[44px] [&>button]:border-0 [&>button]:text-white",children:(0,r.jsx)(P,{listing:{id:q.id,make:q.make,model:q.model,year:q.year,price:q.price},url:window.location.href})})})]})]})]}),ev.length>1&&(0,r.jsx)("div",{className:"w-full mt-4 py-4 flex gap-3 overflow-x-auto overflow-y-hidden bg-black/20 backdrop-blur-md rounded-2xl [&::-webkit-scrollbar]:h-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-white/10 [&::-webkit-scrollbar-thumb]:rounded-full hover:[&::-webkit-scrollbar-thumb]:bg-white/20 scroll-smooth snap-x snap-mandatory touch-pan-x",children:(0,r.jsx)("div",{className:"px-4 md:px-6 flex gap-3 min-w-max",children:ev.map((e,t)=>{let a=null==e?void 0:e.url,l=a?(0,_.wo)(a):"",s=(0,_.cb)(a),i=t===Q;return(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),G(t),ea(!0)},className:"flex-shrink-0 w-20 h-20 md:w-24 md:h-24 rounded-xl overflow-hidden transition-all duration-200 min-h-[80px] min-w-[80px] ".concat(i?"border-[3px] border-purple-500 ring-2 ring-purple-500/50 shadow-lg shadow-purple-500/50 scale-105":"border-2 border-white/20 hover:border-white/40 active:scale-95 md:hover:scale-105 shadow-md"),"aria-label":L("viewImage",{current:t+1,total:ev.length}),children:l?s?(0,r.jsx)("video",{src:l,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}):(0,r.jsx)("img",{src:l,alt:"",className:"w-full h-full object-cover",onError:e=>{e.target.src="/images/cars/default-car.jpg",e.target.onerror=null}}):(0,r.jsx)("div",{className:"w-full h-full bg-gray-700/50 flex items-center justify-center text-gray-400 text-xs",children:"—"})},t)})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-6 md:gap-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"lg:hidden mb-6",children:eD},"contact-seller-mobile"),(0,r.jsxs)("div",{className:"backdrop-blur-sm bg-white/80 dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 md:p-6 shadow-sm mb-6 lg:mb-0",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-slate-900 dark:text-white mb-5",children:L("carDetails")||"Car Details"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 md:gap-4",children:[(0,r.jsxs)("div",{className:"backdrop-blur-md bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl p-4 md:p-5 hover:bg-slate-50 dark:hover:bg-white/10 transition-all duration-300 group shadow-sm",children:[(0,r.jsx)("div",{className:"flex items-center gap-3 mb-2",children:(0,r.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-500/20 border border-indigo-500/30 flex items-center justify-center group-hover:bg-indigo-500/30 transition-colors",children:(0,r.jsx)(u.Z,{className:"h-4 w-4 md:h-5 md:w-5 text-indigo-400"})})}),(0,r.jsx)("p",{className:"text-slate-600 dark:text-gray-400 text-xs font-medium mb-1.5 uppercase tracking-wide",children:L("year")}),(0,r.jsx)("p",{className:"text-slate-900 dark:text-white font-bold text-lg md:text-xl",children:q.year})]}),(0,r.jsxs)("div",{className:"backdrop-blur-md bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl p-4 md:p-5 hover:bg-slate-50 dark:hover:bg-white/10 transition-all duration-300 group shadow-sm",children:[(0,r.jsx)("div",{className:"flex items-center gap-3 mb-2",children:(0,r.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-500/20 border border-indigo-500/30 flex items-center justify-center group-hover:bg-indigo-500/30 transition-colors",children:(0,r.jsx)(j.Z,{className:"h-4 w-4 md:h-5 md:w-5 text-indigo-400"})})}),(0,r.jsx)("p",{className:"text-slate-600 dark:text-gray-400 text-xs font-medium mb-1.5 uppercase tracking-wide",children:L("mileage")}),(0,r.jsxs)("p",{className:"text-slate-900 dark:text-white font-bold text-base md:text-xl leading-tight",children:[null===(a=q.mileage)||void 0===a?void 0:a.toLocaleString()," ",q.mileage_unit||"km"]})]}),(0,r.jsxs)("div",{className:"backdrop-blur-md bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl p-4 md:p-5 hover:bg-slate-50 dark:hover:bg-white/10 transition-all duration-300 group shadow-sm",children:[(0,r.jsx)("div",{className:"flex items-center gap-3 mb-2",children:(0,r.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-500/20 border border-indigo-500/30 flex items-center justify-center group-hover:bg-indigo-500/30 transition-colors",children:(0,r.jsx)(N.Z,{className:"h-4 w-4 md:h-5 md:w-5 text-indigo-400"})})}),(0,r.jsx)("p",{className:"text-slate-600 dark:text-gray-400 text-xs font-medium mb-1.5 uppercase tracking-wide",children:L("fuelType")}),(0,r.jsx)("p",{className:"text-slate-900 dark:text-white font-bold text-base md:text-xl",children:q.fuel_type||"—"})]}),(0,r.jsxs)("div",{className:"backdrop-blur-md bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl p-4 md:p-5 hover:bg-slate-50 dark:hover:bg-white/10 transition-all duration-300 group shadow-sm",children:[(0,r.jsx)("div",{className:"flex items-center gap-3 mb-2",children:(0,r.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-500/20 border border-indigo-500/30 flex items-center justify-center group-hover:bg-indigo-500/30 transition-colors",children:(0,r.jsx)(k.Z,{className:"h-4 w-4 md:h-5 md:w-5 text-indigo-400"})})}),(0,r.jsx)("p",{className:"text-slate-600 dark:text-gray-400 text-xs font-medium mb-1.5 uppercase tracking-wide",children:L("transmission")}),(0,r.jsx)("p",{className:"text-slate-900 dark:text-white font-bold text-base md:text-xl",children:q.transmission||"—"})]}),(0,r.jsxs)("div",{className:"backdrop-blur-md bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl p-4 md:p-5 hover:bg-slate-50 dark:hover:bg-white/10 transition-all duration-300 group shadow-sm",children:[(0,r.jsx)("div",{className:"flex items-center gap-3 mb-2",children:(0,r.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-500/20 border border-indigo-500/30 flex items-center justify-center group-hover:bg-indigo-500/30 transition-colors",children:(0,r.jsx)(y.Z,{className:"h-4 w-4 md:h-5 md:w-5 text-indigo-400"})})}),(0,r.jsx)("p",{className:"text-slate-600 dark:text-gray-400 text-xs font-medium mb-1.5 uppercase tracking-wide",children:L("condition")}),(0,r.jsx)("span",{className:"inline-block text-xs md:text-sm font-bold px-2.5 md:px-3 py-1.5 rounded-lg mt-1 ".concat("Excellent"===q.condition?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"Good"===q.condition?"bg-indigo-500/20 text-indigo-400 border border-indigo-500/30":"Fair"===q.condition?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-gray-500/20 text-gray-400 border border-gray-500/30"),children:q.condition})]}),q.color&&(0,r.jsxs)("div",{className:"backdrop-blur-md bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl p-4 md:p-5 hover:bg-slate-50 dark:hover:bg-white/10 transition-all duration-300 group shadow-sm",children:[(0,r.jsx)("div",{className:"flex items-center gap-3 mb-2",children:(0,r.jsx)("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-500/20 border border-indigo-500/30 flex items-center justify-center group-hover:bg-indigo-500/30 transition-colors",children:(0,r.jsx)(S.Z,{className:"h-4 w-4 md:h-5 md:w-5 text-indigo-400"})})}),(0,r.jsx)("p",{className:"text-slate-600 dark:text-gray-400 text-xs font-medium mb-1.5 uppercase tracking-wide",children:L("color")}),(0,r.jsx)("p",{className:"text-slate-900 dark:text-white font-bold text-base md:text-xl",children:q.color})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(null===(i=q.features)||void 0===i?void 0:i.length)>0&&(0,r.jsxs)("div",{className:"backdrop-blur-sm bg-white/80 dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 md:p-6 shadow-sm mb-6",children:[(0,r.jsx)("h3",{className:"text-slate-900 dark:text-white font-semibold text-lg mb-4",children:L("features")}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 md:gap-3",children:q.features.map((e,t)=>(0,r.jsx)("span",{className:"rounded-xl px-3 py-2 text-sm md:text-base backdrop-blur-md bg-slate-100 dark:bg-white/5 border border-slate-200 dark:border-white/10 text-slate-700 dark:text-gray-300 hover:bg-slate-200 dark:hover:bg-white/10 transition-colors",style:{fontSize:"clamp(14px, 4vw, 16px)"},children:e},t))})]}),e_&&(0,r.jsxs)("div",{className:"backdrop-blur-sm bg-white/80 dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 md:p-6 shadow-sm mb-6",children:[(0,r.jsx)("h3",{className:"text-slate-900 dark:text-white font-semibold text-lg mb-4",children:L("description")}),(0,r.jsx)("p",{className:"text-slate-700 dark:text-gray-300 text-sm md:text-base whitespace-pre-wrap leading-relaxed",style:{fontSize:"clamp(14px, 4vw, 16px)"},children:e_})]}),q.vin&&(0,r.jsxs)("div",{className:"backdrop-blur-sm bg-white/80 dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 md:p-6 shadow-sm",children:[(0,r.jsx)("h3",{className:"text-slate-900 dark:text-white font-semibold text-lg mb-3",children:L("vin")}),(0,r.jsx)("p",{className:"text-slate-700 dark:text-gray-300 font-mono text-sm md:text-base backdrop-blur-md bg-slate-100 dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl px-4 py-3 inline-block break-all",children:q.vin})]}),es.length>0&&(0,r.jsxs)("div",{className:"backdrop-blur-sm bg-white/5 border border-white/10 rounded-2xl p-5 md:p-6",children:[(0,r.jsx)("h3",{className:"text-white font-semibold text-lg mb-4",children:L("priceHistory")}),(0,r.jsx)("div",{className:"space-y-3",children:es.slice(-5).reverse().map((e,t)=>{var a;let l=t>0?null===(a=es[es.length-t])||void 0===a?void 0:a.price:q.price,s=l?e.price-l:0,i=l?(s/l*100).toFixed(1):"0";return(0,r.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 md:py-4 md:px-5 backdrop-blur-md bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl text-sm hover:bg-slate-50 dark:hover:bg-white/10 transition-colors shadow-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"text-slate-900 dark:text-white font-semibold",children:["$",e.price.toLocaleString()]}),(0,r.jsx)("span",{className:"text-slate-600 dark:text-gray-400 text-xs ml-3",children:new Date(e.timestamp).toLocaleDateString()})]}),0!==s&&(0,r.jsxs)("span",{className:"font-medium ".concat(s<0?"text-emerald-400":"text-red-400"),children:[s>0?"+":"","$",s.toLocaleString()," (",i,"%)"]})]},t)})})]})]}),!q.fromSupabase&&(0,r.jsx)(E,{listingId:parseInt(T,10),make:q.make,model:q.model,year:q.year,price:q.price})]}),(0,r.jsx)("div",{className:"hidden lg:block",children:(0,r.jsxs)("div",{className:"sticky top-24 space-y-6",children:[eA&&(0,r.jsx)("div",{className:"backdrop-blur-sm bg-white/80 dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 shadow-sm",children:(0,r.jsx)(X,{listingId:q.id,isSold:eI,onMarkSold:()=>eo(!0),onMarkAvailable:()=>ec(!0),togglingSold:em})},"manage-listing-desktop"),(0,r.jsx)("div",{children:eD},"contact-seller-desktop")]})},"right-sidebar-desktop")]})]}),eZ&&(0,r.jsx)("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 backdrop-blur-xl bg-gradient-to-t from-gray-900/98 via-gray-900/95 to-gray-900/95 border-t border-white/20 p-4 shadow-[0_-4px_20px_rgba(0,0,0,0.5)] safe-area-inset-bottom",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto flex gap-3",children:[eC&&(0,r.jsx)(m.z,{asChild:!0,className:"flex-1 bg-gradient-to-r from-emerald-600 to-emerald-500 hover:from-emerald-500 hover:to-emerald-400 active:scale-95 min-h-[52px] h-[52px] text-base font-semibold shadow-lg shadow-emerald-500/30 touch-manipulation rounded-xl",children:(0,r.jsxs)("a",{href:eL,className:"flex items-center justify-center",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5 mr-2"}),L("callNow")]})}),ez&&(0,r.jsx)(m.z,{asChild:!0,variant:"outline",className:"flex-1 border-emerald-500/50 text-emerald-400 hover:bg-emerald-500/10 active:scale-95 min-h-[52px] h-[52px] text-base font-semibold touch-manipulation rounded-xl",children:(0,r.jsxs)("a",{href:eE,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center",children:[(0,r.jsx)(p.Z,{className:"h-5 w-5 mr-2"}),"WhatsApp"]})})]})})]}),(0,r.jsx)(A.Vq,{open:en,onOpenChange:eo,children:(0,r.jsxs)(A.cZ,{children:[(0,r.jsxs)(A.fK,{children:[(0,r.jsx)(A.$N,{children:L("markAsSold")}),(0,r.jsx)(A.Be,{children:L("confirmMarkSold")})]}),(0,r.jsxs)(A.cN,{className:"gap-2 sm:gap-0",children:[(0,r.jsx)(m.z,{variant:"outline",className:"border-gray-600 text-gray-300",onClick:()=>eo(!1),disabled:em,children:"Cancel"}),(0,r.jsx)(m.z,{className:"bg-amber-600 hover:bg-amber-500",onClick:eF,disabled:em,children:em?L("updating"):L("markAsSold")})]})]})}),(0,r.jsx)(A.Vq,{open:ed,onOpenChange:ec,children:(0,r.jsxs)(A.cZ,{children:[(0,r.jsxs)(A.fK,{children:[(0,r.jsx)(A.$N,{children:L("markAsAvailable")}),(0,r.jsx)(A.Be,{children:L("confirmMarkAvailable")})]}),(0,r.jsxs)(A.cN,{className:"gap-2 sm:gap-0",children:[(0,r.jsx)(m.z,{variant:"outline",className:"border-gray-600 text-gray-300",onClick:()=>ec(!1),disabled:em,children:"Cancel"}),(0,r.jsx)(m.z,{className:"bg-emerald-600 hover:bg-emerald-500",onClick:eM,disabled:em,children:em?L("updating"):L("markAsAvailable")})]})]})}),ev.length>0&&(0,r.jsx)(K,{images:ev,currentIndex:Q,isOpen:J,onClose:()=>ea(!1),onNavigate:e=>G(e),getImageUrl:_.wo,isVideoUrl:_.cb})]})}},80048:function(e,t,a){"use strict";a.d(t,{MQ:function(){return n},Tb:function(){return i},YE:function(){return s}});var r=a(57437),l=a(27815);function s(){return(0,r.jsxs)(l.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29] animate-pulse",children:[(0,r.jsx)("div",{className:"h-48 bg-[#2a2d3a] rounded-t-lg"}),(0,r.jsxs)(l.Ol,{children:[(0,r.jsx)("div",{className:"h-6 bg-[#2a2d3a] rounded w-3/4 mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-[#2a2d3a] rounded w-1/2"})]}),(0,r.jsx)(l.aY,{children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-[#2a2d3a] rounded w-full"}),(0,r.jsx)("div",{className:"h-4 bg-[#2a2d3a] rounded w-5/6"}),(0,r.jsx)("div",{className:"h-10 bg-[#2a2d3a] rounded w-full mt-4"})]})})]})}function i(){return(0,r.jsxs)("div",{className:"space-y-6 animate-pulse",children:[(0,r.jsx)("div",{className:"h-96 bg-[#2a2d3a] rounded-lg"}),(0,r.jsxs)(l.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29]",children:[(0,r.jsxs)(l.Ol,{children:[(0,r.jsx)("div",{className:"h-8 bg-[#2a2d3a] rounded w-3/4 mb-2"}),(0,r.jsx)("div",{className:"h-6 bg-[#2a2d3a] rounded w-1/2"})]}),(0,r.jsx)(l.aY,{children:(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(e=>(0,r.jsx)("div",{className:"h-16 bg-[#2a2d3a] rounded"},e))})})]})]})}function n(){return(0,r.jsxs)(l.Zb,{className:"border-[#2a2d3a] bg-[#1a1d29] animate-pulse",children:[(0,r.jsx)(l.Ol,{children:(0,r.jsx)("div",{className:"h-6 bg-[#2a2d3a] rounded w-1/3"})}),(0,r.jsx)(l.aY,{children:(0,r.jsx)("div",{className:"h-64 bg-[#2a2d3a] rounded"})})]})}},27815:function(e,t,a){"use strict";a.d(t,{Ol:function(){return n},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},ll:function(){return o}});var r=a(57437),l=a(2265),s=a(1657);let i=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border border-slate-200 dark:border-[#2a2d3a] bg-white dark:bg-[#1a1d29] text-slate-900 dark:text-white shadow-sm",a),...l})});i.displayName="Card";let n=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",a),...l})});n.displayName="CardHeader";let o=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight text-slate-900 dark:text-white",a),...l})});o.displayName="CardTitle";let d=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-slate-600 dark:text-[#94a3b8]",a),...l})});d.displayName="CardDescription";let c=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",a),...l})});c.displayName="CardContent",l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",a),...l})}).displayName="CardFooter"},42706:function(e,t,a){"use strict";a.d(t,{$N:function(){return b},Be:function(){return g},Vq:function(){return o},cN:function(){return u},cZ:function(){return h},fK:function(){return x},hg:function(){return d}});var r=a(57437),l=a(2265),s=a(79515),i=a(82549),n=a(1657);let o=s.fC,d=s.xz,c=s.h_;s.x8;let m=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)(s.aV,{ref:t,className:(0,n.cn)("fixed inset-0 z-[1100] bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l})});m.displayName=s.aV.displayName;let h=l.forwardRef((e,t)=>{let{className:a,children:l,...o}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(m,{}),(0,r.jsxs)(s.VY,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-[1100] grid w-full max-w-lg max-h-[90vh] overflow-y-auto overscroll-contain translate-x-[-50%] translate-y-[-50%] gap-4 border border-slate-200 dark:border-[#2a2d3a] bg-white dark:bg-[#1a1d29] p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[l,(0,r.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 text-slate-600 dark:text-[#94a3b8]"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=s.VY.displayName;let x=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};x.displayName="DialogHeader";let u=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};u.displayName="DialogFooter";let b=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)(s.Dx,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight text-slate-900 dark:text-white",a),...l})});b.displayName=s.Dx.displayName;let g=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)(s.dk,{ref:t,className:(0,n.cn)("text-sm text-slate-600 dark:text-[#94a3b8]",a),...l})});g.displayName=s.dk.displayName}},function(e){e.O(0,[7895,116,263,4829,6376,3226,7169,1396,8777,8174,6298,3572,5237,2971,4938,1744],function(){return e(e.s=49039)}),_N_E=e.O()}]);