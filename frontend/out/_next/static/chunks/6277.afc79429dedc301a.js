"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6277,7270],{56224:function(e,t,a){a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(62898).Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},97542:function(e,t,a){a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(62898).Z)("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]])},76637:function(e,t,a){a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(62898).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},29764:function(e,t,a){a.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a(62898).Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},57270:function(e,t,a){a.r(t),a.d(t,{ShareExportMenu:function(){return _}});var r=a(57437),n=a(2265),o=a(85754),i=a(93930),l=a(83523),c=a(62442),s=a(56224),d=a(29764),u=a(76637),m=a(97542),f=a(25703),p=a(1657),h=a(63572),g=a(82302);let y="http://127.0.0.1:8000";async function w(e){try{let t=await fetch(e),a=await t.blob();return new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>{let t=r.result;e(t)},r.onerror=t,r.readAsDataURL(a)})}catch(e){throw console.error("Error converting image to base64:",e),e}}async function x(e,t){if(!e)return{original:null,processed:null};try{null==t||t("Loading car image...");let a=await w(e);null==t||t("Removing background... this may take a moment");let r=a.split(",")[1],n=atob(r),o=new Uint8Array(n.length);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);let i=new Blob([o],{type:"image/jpeg"}),l=await (0,g.X)(i,{model:"isnet_fp16",output:{format:"image/png"}}),c=await new Promise((e,t)=>{let a=new FileReader;a.onloadend=()=>{e(a.result)},a.onerror=t,a.readAsDataURL(l)});return null==t||t("Background removed! Generating PDF..."),{original:a,processed:c}}catch(t){console.warn("⚠️ Background removal failed, using original image:",t);try{return{original:await w(e),processed:null}}catch(e){return console.error("❌ Failed to load original image:",e),{original:null,processed:null}}}}async function v(){try{for(let e of["/behind_background.jpg","/behind_background.jpeg","/images/behind_background.jpg","/images/behind_background.jpeg"])try{return await w(e)}catch(e){continue}try{return await w("".concat(y,"/static/behind_background.jpg"))}catch(e){return console.warn("⚠️ Background image not found, PDF will use default background"),null}}catch(e){return console.warn("⚠️ Could not load background image:",e),null}}async function b(e,t,a){try{null==a||a("Preparing PDF generation...");let r=e.preview_image?e.preview_image:e.car_image_path?e.car_image_path.startsWith("http")?e.car_image_path:"".concat(y,"/api/car-images/").concat(e.car_image_path):e.similar_cars&&e.similar_cars.length>0&&e.similar_cars[0].image_url?e.similar_cars[0].image_url:null,n=null,o=null;if(r){let e=await x(r,a);n=e.processed,o=e.original}null==a||a("Loading background image...");let i=await v(),l={predicted_price:e.predicted_price,confidence_interval:e.confidence_interval,confidence_range:e.confidence_range,confidence_level:e.confidence_level,market_comparison:e.market_comparison,deal_score:e.deal_score,deal_analysis:e.deal_analysis,similar_cars:e.similar_cars,car_image_path:e.car_image_path,preview_image:e.preview_image,processed_car_image:n,original_car_image:o,background_image:i},c={year:t.year,make:t.make,model:t.model,trim:t.trim,mileage:t.mileage,condition:t.condition,location:t.location,fuel_type:t.fuel_type,engine_size:t.engine_size,cylinders:t.cylinders};null==a||a("Generating PDF certificate...");let s=await fetch("".concat(y,"/api/export/pdf"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prediction_result:l,car_features:c})});if(!s.ok){let e=await s.text();throw Error("PDF generation failed: ".concat(s.status," ").concat(e))}let d=await s.blob(),u=window.URL.createObjectURL(d),m=document.createElement("a");m.href=u;let f=t.make||"Car",p=t.model||"Model",h=Date.now();m.download="CarWiseIQ-Valuation-".concat(f,"-").concat(p,"-").concat(h,".pdf"),document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(u),null==a||a("PDF downloaded successfully!")}catch(e){throw console.error("❌ Error generating PDF:",e),e}}function _(e){let{result:t,carFeatures:a,showPdfExport:g=!0}=e,{toast:y}=(0,f.useToast)(),[w,x]=(0,n.useState)(!1),[v,_]=(0,n.useState)(!1),[k,j]=(0,n.useState)(""),N=()=>{let e="".concat(a.year," ").concat(a.make," ").concat(a.model),r=(0,p.xG)(t.predicted_price);return"\uD83D\uDE97 Car Price Prediction: ".concat(e,"\n\uD83D\uDCB0 Estimated Value: ").concat(r,"\n\nPredicted using CarWiseIQ")},F=()=>{let e=new URLSearchParams({make:a.make,model:a.model,year:a.year.toString(),mileage:a.mileage.toString(),condition:a.condition,price:t.predicted_price.toString()});return"".concat(window.location.origin,"/predict?").concat(e.toString())},C=async()=>{try{let e=N();await navigator.clipboard.writeText(e),x(!0),y({title:"Copied!",description:"Prediction details copied to clipboard"}),setTimeout(()=>x(!1),2e3)}catch(e){y({title:"Error",description:"Failed to copy to clipboard",variant:"destructive"})}},R=async()=>{let e={title:"Car Price Prediction",text:N(),url:F()};if(navigator.share)try{await navigator.share(e)}catch(e){}else C()},E=async()=>{try{var e,r,n,o;let i=[{Make:a.make,Model:a.model,Year:a.year,"Mileage (km)":a.mileage,Condition:a.condition,"Fuel Type":a.fuel_type,Location:a.location,"Predicted Price":t.predicted_price,"Lower CI":(null===(e=t.confidence_interval)||void 0===e?void 0:e.lower)||"","Upper CI":(null===(r=t.confidence_interval)||void 0===r?void 0:r.upper)||"","Market Average":(null===(n=t.market_comparison)||void 0===n?void 0:n.market_average)||"","Deal Score":(null===(o=t.deal_score)||void 0===o?void 0:o.label)||""}],l=await h.apiClient.exportExcel(i);h.apiClient.downloadBlob(l,"car-prediction-".concat(a.make,"-").concat(a.model,"-").concat(Date.now(),".xlsx")),y({title:"Success",description:"Excel file downloaded successfully"})}catch(e){y({title:"Error",description:"Failed to export Excel file",variant:"destructive"})}},D=async()=>{_(!0),j("Initializing...");try{await b(t,a,e=>{j(e)}),y({title:"Success",description:"Valuation certificate downloaded successfully"})}catch(e){console.error("PDF export error:",e),y({title:"Error",description:e instanceof Error?e.message:"Failed to export PDF file",variant:"destructive"})}finally{_(!1),j("")}};return(0,r.jsxs)(i.h_,{children:[(0,r.jsx)(i.$F,{asChild:!0,children:(0,r.jsxs)(o.z,{variant:"outline",size:"sm",className:"w-full sm:w-auto border-[#2a2d3a] bg-transparent hover:bg-[#2a2d3a] text-white hover:text-white",children:["Share / Export",(0,r.jsx)(l.Z,{className:"ml-2 h-4 w-4"})]})}),(0,r.jsxs)(i.AW,{align:"end",className:"w-48",children:[(0,r.jsx)(i.Xi,{onClick:C,children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Copied!"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{className:"mr-2 h-4 w-4"}),"Copy Results"]})}),"undefined"!=typeof navigator&&"share"in navigator&&"function"==typeof navigator.share&&(0,r.jsxs)(i.Xi,{onClick:R,children:[(0,r.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"Share"]}),(0,r.jsx)(i.VD,{}),g&&(0,r.jsxs)(i.Xi,{onClick:D,disabled:v,children:[(0,r.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),v?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"animate-spin mr-2",children:"⏳"}),k||"Processing Image..."]}):"Export PDF"]}),(0,r.jsxs)(i.Xi,{onClick:E,children:[(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Export Excel"]})]})]})}},93930:function(e,t,a){a.d(t,{$F:function(){return u},AW:function(){return m},VD:function(){return p},Xi:function(){return f},h_:function(){return d}});var r=a(57437),n=a(2265),o=a(20949),i=a(17158),l=a(62442),c=a(76369),s=a(1657);let d=o.fC,u=o.xz;o.ZA,o.Uv,o.Tr,o.Ee,n.forwardRef((e,t)=>{let{className:a,inset:n,children:l,...c}=e;return(0,r.jsxs)(o.fF,{ref:t,className:(0,s.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",a),...c,children:[l,(0,r.jsx)(i.Z,{className:"ml-auto h-4 w-4 rtl:rotate-180"})]})}).displayName=o.fF.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.tu,{ref:t,className:(0,s.cn)("z-[1000] min-w-[8rem] max-h-[60vh] overflow-y-auto overscroll-contain rounded-md border border-[#2a2d3a] bg-[#1a1d29] p-1 text-white shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})}).displayName=o.tu.displayName;let m=n.forwardRef((e,t)=>{let{className:a,sideOffset:n=4,...i}=e;return(0,r.jsx)(o.Uv,{children:(0,r.jsx)(o.VY,{ref:t,sideOffset:n,className:(0,s.cn)("z-[1000] min-w-[8rem] max-h-[60vh] overflow-y-auto overscroll-contain rounded-md border border-[#2a2d3a] bg-[#1a1d29] p-1 text-white shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})})});m.displayName=o.VY.displayName;let f=n.forwardRef((e,t)=>{let{className:a,inset:n,...i}=e;return(0,r.jsx)(o.ck,{ref:t,className:(0,s.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-[#2a2d3a] focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",a),...i})});f.displayName=o.ck.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,checked:i,...c}=e;return(0,r.jsxs)(o.oC,{ref:t,className:(0,s.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-[#2a2d3a] focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:i,...c,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(o.wU,{children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})}),n]})}).displayName=o.oC.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,...i}=e;return(0,r.jsxs)(o.Rk,{ref:t,className:(0,s.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-[#2a2d3a] focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(o.wU,{children:(0,r.jsx)(c.Z,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=o.Rk.displayName,n.forwardRef((e,t)=>{let{className:a,inset:n,...i}=e;return(0,r.jsx)(o.__,{ref:t,className:(0,s.cn)("px-2 py-1.5 text-sm font-semibold text-[#94a3b8]",n&&"pl-8",a),...i})}).displayName=o.__.displayName;let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(o.Z0,{ref:t,className:(0,s.cn)("-mx-1 my-1 h-px bg-[#2a2d3a]",a),...n})});p.displayName=o.Z0.displayName},82302:function(e,t,a){a.d(t,{X:function(){return r}});async function r(e,t){return new Promise((t,a)=>{let r=new Image;r.onload=()=>{let e=document.createElement("canvas");e.width=r.width,e.height=r.height;let n=e.getContext("2d");if(!n){a(Error("No canvas context"));return}n.drawImage(r,0,0),e.toBlob(e=>e?t(e):a(Error("toBlob failed")),"image/png",.9)},r.onerror=()=>a(Error("Image load failed")),r.src=URL.createObjectURL(e)})}},44356:function(e,t,a){a.d(t,{Pc:function(){return b},ck:function(){return P},fC:function(){return D}});var r=a(2265),n=a(85744),o=a(68086),i=a(42210),l=a(56989),c=a(20966),s=a(31033),d=a(16459),u=a(73763),m=a(65400),f=a(57437),p="rovingFocusGroup.onEntryFocus",h={bubbles:!1,cancelable:!0},g="RovingFocusGroup",[y,w,x]=(0,o.B)(g),[v,b]=(0,l.b)(g,[x]),[_,k]=v(g),j=r.forwardRef((e,t)=>(0,f.jsx)(y.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,f.jsx)(y.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,f.jsx)(N,{...e,ref:t})})}));j.displayName=g;var N=r.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:a,orientation:o,loop:l=!1,dir:c,currentTabStopId:y,defaultCurrentTabStopId:x,onCurrentTabStopIdChange:v,onEntryFocus:b,preventScrollOnEntryFocus:k=!1,...j}=e,N=r.useRef(null),F=(0,i.e)(t,N),C=(0,m.gm)(c),[R,D]=(0,u.T)({prop:y,defaultProp:x??null,onChange:v,caller:g}),[P,S]=r.useState(!1),M=(0,d.W)(b),I=w(a),A=r.useRef(!1),[L,T]=r.useState(0);return r.useEffect(()=>{let e=N.current;if(e)return e.addEventListener(p,M),()=>e.removeEventListener(p,M)},[M]),(0,f.jsx)(_,{scope:a,orientation:o,dir:C,loop:l,currentTabStopId:R,onItemFocus:r.useCallback(e=>D(e),[D]),onItemShiftTab:r.useCallback(()=>S(!0),[]),onFocusableItemAdd:r.useCallback(()=>T(e=>e+1),[]),onFocusableItemRemove:r.useCallback(()=>T(e=>e-1),[]),children:(0,f.jsx)(s.WV.div,{tabIndex:P||0===L?-1:0,"data-orientation":o,...j,ref:F,style:{outline:"none",...e.style},onMouseDown:(0,n.Mj)(e.onMouseDown,()=>{A.current=!0}),onFocus:(0,n.Mj)(e.onFocus,e=>{let t=!A.current;if(e.target===e.currentTarget&&t&&!P){let t=new CustomEvent(p,h);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=I().filter(e=>e.focusable);E([e.find(e=>e.active),e.find(e=>e.id===R),...e].filter(Boolean).map(e=>e.ref.current),k)}}A.current=!1}),onBlur:(0,n.Mj)(e.onBlur,()=>S(!1))})})}),F="RovingFocusGroupItem",C=r.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:a,focusable:o=!0,active:i=!1,tabStopId:l,children:d,...u}=e,m=(0,c.M)(),p=l||m,h=k(F,a),g=h.currentTabStopId===p,x=w(a),{onFocusableItemAdd:v,onFocusableItemRemove:b,currentTabStopId:_}=h;return r.useEffect(()=>{if(o)return v(),()=>b()},[o,v,b]),(0,f.jsx)(y.ItemSlot,{scope:a,id:p,focusable:o,active:i,children:(0,f.jsx)(s.WV.span,{tabIndex:g?0:-1,"data-orientation":h.orientation,...u,ref:t,onMouseDown:(0,n.Mj)(e.onMouseDown,e=>{o?h.onItemFocus(p):e.preventDefault()}),onFocus:(0,n.Mj)(e.onFocus,()=>h.onItemFocus(p)),onKeyDown:(0,n.Mj)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey){h.onItemShiftTab();return}if(e.target!==e.currentTarget)return;let t=function(e,t,a){var r;let n=(r=e.key,"rtl"!==a?r:"ArrowLeft"===r?"ArrowRight":"ArrowRight"===r?"ArrowLeft":r);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(n))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(n)))return R[n]}(e,h.orientation,h.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let n=x().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)n.reverse();else if("prev"===t||"next"===t){var a,r;"prev"===t&&n.reverse();let o=n.indexOf(e.currentTarget);n=h.loop?(a=n,r=o+1,a.map((e,t)=>a[(r+t)%a.length])):n.slice(o+1)}setTimeout(()=>E(n))}}),children:"function"==typeof d?d({isCurrentTabStop:g,hasTabStop:null!=_}):d})})});C.displayName=F;var R={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function E(e,t=!1){let a=document.activeElement;for(let r of e)if(r===a||(r.focus({preventScroll:t}),document.activeElement!==a))return}var D=j,P=C}}]);