(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1067,5922],{92753:function(e,t,r){Promise.resolve().then(r.bind(r,65557))},65557:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var s=r(57437),a=r(2265),n=r(24033),i=r(50116),l=r(61865),o=r(38110),c=r(93134),d=r(45179),u=r(49842),m=r(27815),f=r(54900),h=r(85754),x=r(77929),g=r(25703),b=r(48132),p=r(1295),v=r(5589),w=r(77216),y=r(99670),N=r(61396),j=r.n(N),k=r(42375),F=r(66909),C=r(86095),S=r(6678);let I=c.Ry({email:c.Z_().email("Please enter a valid email address"),password:c.Z_().min(1,"Password is required"),rememberMe:c.O7().optional()});function E(){let[e,t]=(0,a.useState)(!1),[c,N]=(0,a.useState)(!1),[E,R]=(0,a.useState)(null),[P,Z]=(0,a.useState)(!1),[_,L]=(0,a.useState)(!1),T=(0,i.useTranslations)("auth"),A=(0,i.useTranslations)("common"),B=(0,i.useLocale)()||"en",z=(0,n.useRouter)(),M=(0,n.useSearchParams)(),{toast:O}=(0,g.useToast)(),D=(null==M?void 0:M.get("returnUrl"))||"/".concat(B),{user:G,loading:J,login:U}=(0,C.a)(),{user:X,loading:V}=(0,S.useAuthContext)(),{register:W,handleSubmit:H,watch:Y,setValue:q,formState:{errors:K,isSubmitting:Q}}=(0,l.cI)({resolver:(0,o.F)(I),defaultValues:{rememberMe:!1}});(0,a.useEffect)(()=>{t(!0)},[]),(0,a.useEffect)(()=>{let e=G||X;!(J||V)&&e&&z.replace(D)},[J,V,G,X,D,z]);let $=async()=>{try{L(!0);let e="".concat(window.location.origin,"/").concat(B,"/auth/callback?returnUrl=").concat(encodeURIComponent(D)),{supabase:t}=await Promise.resolve().then(r.bind(r,45922)),{error:s}=await t.auth.signInWithOAuth({provider:"google",options:{redirectTo:e}});if(s){O({title:A("error"),description:s.message||"Google sign-in failed. Please try again.",variant:"destructive"});return}}catch(t){let e=t instanceof Error?t.message:"Google sign-in failed.";O({title:A("error"),description:e,variant:"destructive"})}finally{L(!1)}},ee=async()=>{O({title:A("error"),description:"Email resend is not yet available. Please contact support.",variant:"destructive"})},et=async e=>{try{let t=await U(e.email,e.password,e.rememberMe||!1);if(localStorage.getItem("auth_token"),await new Promise(e=>setTimeout(e,200)),!localStorage.getItem("auth_token")&&(null==t?void 0:t.token)&&(localStorage.setItem("auth_token",t.token),await new Promise(e=>setTimeout(e,100)),localStorage.getItem("auth_token")),!localStorage.getItem("auth_token")){console.error("========================================"),console.error("[Login] ❌ CRITICAL ERROR: TOKEN NOT SAVED!"),console.error("[Login] Response:",JSON.stringify(t,null,2)),console.error("[Login] localStorage:",{auth_token:localStorage.getItem("auth_token"),refresh_token:localStorage.getItem("refresh_token"),allKeys:Object.keys(localStorage)}),console.error("========================================"),O({title:A("error"),description:"Login succeeded but token was not saved. Check console for details.",variant:"destructive",duration:1e4});return}if(O({title:A("success"),description:"Welcome back!"}),await new Promise(e=>setTimeout(e,800)),!localStorage.getItem("auth_token")){console.error("[Login] ❌ Token disappeared before redirect!"),O({title:A("error"),description:"Token was lost. Please try logging in again.",variant:"destructive"});return}window.location.href=D}catch(s){var t;console.error("[Login] Login error:",s),console.error("[Login] Error response:",s.response);let e=s.message||T("loginError")||"Login failed.",r=null!==(t=null==e?void 0:e.toLowerCase())&&void 0!==t?t:"";r.includes("invalid")||r.includes("incorrect")||r.includes("credentials")?e="Incorrect email or password. If you're sure they're correct, try Forgot password to reset.":(r.includes("rate limit")||r.includes("rate limit exceeded"))&&(e="Too many attempts. Please wait a few minutes before trying again."),O({title:A("error"),description:e,variant:"destructive"})}},er=(e,t)=>{try{return T(e)||t}catch(e){return t}};return e?!J&&G?(0,s.jsx)("div",{className:"flex min-h-[calc(100vh-200px)] items-center justify-center p-6 bg-[#0f1117]",children:(0,s.jsx)("div",{className:"text-[#94a3b8]",children:"Redirecting..."})}):(0,s.jsx)(k.ErrorBoundary,{children:(0,s.jsx)("div",{className:"flex min-h-[calc(100vh-200px)] items-center justify-center p-6 bg-[#0f1117]",children:(0,s.jsxs)(m.Zb,{className:"w-full max-w-md border-[#2a2d3a] bg-[#1a1d29] text-white",children:[(0,s.jsxs)(m.Ol,{className:"space-y-1",children:[(0,s.jsx)(m.ll,{className:"text-2xl font-bold text-white",children:er("login","Login")}),(0,s.jsx)(m.SZ,{className:"text-[#94a3b8]",children:er("loginDescription","Sign in to your account")})]}),(0,s.jsxs)(m.aY,{children:[(0,s.jsxs)("form",{onSubmit:H(et),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u._,{htmlFor:"email",className:"text-white",children:er("email","Email")}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(p.Z,{className:"absolute left-3 top-3 h-4 w-4 text-[#94a3b8] rtl:left-auto rtl:right-3"}),(0,s.jsx)(d.I,{id:"email",type:"email",placeholder:er("emailPlaceholder","Enter your email"),className:"ps-10 border-[#2a2d3a] bg-[#0f1117] text-white placeholder:text-[#94a3b8] ".concat(K.email?"border-red-500 focus:border-red-500":"focus:border-[#5B7FFF]"),...W("email"),disabled:Q})]}),K.email&&(0,s.jsx)("p",{className:"text-sm text-red-400",children:K.email.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-y-1",children:[(0,s.jsx)(u._,{htmlFor:"password",className:"text-white",children:er("password","Password")}),(0,s.jsx)(j(),{href:"/".concat(B,"/forgot-password"),className:"text-sm text-[#5B7FFF] hover:underline text-end",children:T("forgotPassword")})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(v.Z,{className:"absolute left-3 top-3 h-4 w-4 text-[#94a3b8] rtl:left-auto rtl:right-3"}),(0,s.jsx)(d.I,{id:"password",type:c?"text":"password",placeholder:er("passwordPlaceholder","Enter your password"),className:"ps-10 pe-10 border-[#2a2d3a] bg-[#0f1117] text-white placeholder:text-[#94a3b8] ".concat(K.password?"border-red-500 focus:border-red-500":"focus:border-[#5B7FFF]"),...W("password"),disabled:Q}),(0,s.jsx)("button",{type:"button",onClick:()=>N(!c),className:"absolute right-3 top-3 text-[#94a3b8] hover:text-white rtl:right-auto rtl:left-3",tabIndex:-1,children:c?(0,s.jsx)(w.Z,{className:"h-4 w-4"}):(0,s.jsx)(y.Z,{className:"h-4 w-4"})})]}),K.password&&(0,s.jsx)("p",{className:"text-sm text-red-400",children:K.password.message})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.X,{id:"rememberMe",checked:!!Y("rememberMe"),onCheckedChange:e=>q("rememberMe",!!e),disabled:Q,className:"border-[#2a2d3a]"}),(0,s.jsx)(u._,{htmlFor:"rememberMe",className:"text-sm text-[#94a3b8] cursor-pointer",children:T("rememberMe")})]}),(0,s.jsx)(b.f,{type:"submit",loading:Q,loadingText:er("loggingIn","Logging in..."),className:"w-full bg-[#5B7FFF] hover:bg-[#5B7FFF]/90 text-white",children:er("login","Login")}),E&&(0,s.jsx)(x.bZ,{className:"mt-4 border-amber-500/50 bg-amber-500/10",children:(0,s.jsxs)(x.X,{className:"text-[#94a3b8]",children:["Check your inbox and spam. If you didn’t get it,"," ",(0,s.jsx)(h.z,{type:"button",variant:"link",className:"h-auto p-0 text-[#5B7FFF]",onClick:ee,disabled:P,children:P?"Sending…":"Resend verification email"})]})})]}),(0,s.jsxs)("div",{className:"relative my-6",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,s.jsx)("span",{className:"w-full border-t border-[#2a2d3a]"})}),(0,s.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,s.jsx)("span",{className:"bg-[#1a1d29] px-2 text-[#94a3b8]",children:"Or continue with"})})]}),(0,s.jsxs)(h.z,{type:"button",variant:"outline",className:"w-full border-[#2a2d3a] bg-[#0f1117] text-white hover:bg-[#2a2d3a]",onClick:$,disabled:Q||_,children:[(0,s.jsx)(F._,{className:"mr-2 h-4 w-4 shrink-0"}),_?"Redirecting…":"Sign in with Google"]}),(0,s.jsxs)("p",{className:"mt-4 text-center text-sm text-[#94a3b8]",children:[er("noAccount","Don't have an account?")," ",(0,s.jsx)(j(),{href:"/".concat(B,"/register"),className:"text-[#5B7FFF] hover:underline font-medium",children:er("register","Register")})]})]})]})})}):(0,s.jsx)("div",{className:"flex min-h-[calc(100vh-200px)] items-center justify-center p-6 bg-[#0f1117]",children:(0,s.jsx)("div",{className:"text-[#94a3b8]",children:"Loading..."})})}},42375:function(e,t,r){"use strict";r.r(t),r.d(t,{ErrorBoundary:function(){return m}});var s=r(57437),a=r(2265),n=r(85754),i=r(27815),l=r(11981),o=r(64280),c=r(77480),d=r(61396),u=r.n(d);class m extends a.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t})}render(){if(this.state.hasError){var e;return this.props.fallback?this.props.fallback:(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-[#0f1117] p-4",children:(0,s.jsxs)(i.Zb,{className:"max-w-2xl w-full border-red-500/50 bg-[#1a1d29]",children:[(0,s.jsxs)(i.Ol,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.Z,{className:"h-6 w-6 text-red-500"}),(0,s.jsx)(i.ll,{className:"text-red-400",children:"Something went wrong"})]}),(0,s.jsx)(i.SZ,{className:"text-[#94a3b8]",children:"An error occurred while rendering this component"})]}),(0,s.jsxs)(i.aY,{className:"space-y-4",children:[this.state.error&&(0,s.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-red-400 font-mono break-all",children:this.state.error.message||"Unknown error"}),!1]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(n.z,{onClick:this.handleReset,className:"bg-[#5B7FFF] hover:bg-[#4a6fe6]",children:[(0,s.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"Try again"]}),(0,s.jsx)(u(),{href:null!==(e=this.props.homeHref)&&void 0!==e?e:"/",children:(0,s.jsxs)(n.z,{variant:"outline",className:"border-[#2a2d3a]",children:[(0,s.jsx)(c.Z,{className:"mr-2 h-4 w-4"}),"Go home"]})})]})]})]})})}return this.props.children}constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.state={hasError:!1,error:null,errorInfo:null}}}},66909:function(e,t,r){"use strict";r.d(t,{_:function(){return a}});var s=r(57437);function a(e){let{className:t}=e;return(0,s.jsxs)("svg",{className:t,viewBox:"0 0 24 24","aria-hidden":!0,children:[(0,s.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,s.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,s.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,s.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}},48132:function(e,t,r){"use strict";r.d(t,{f:function(){return i}});var s=r(57437),a=r(85754),n=r(58148);function i(e){let{loading:t=!1,loadingText:r,children:i,disabled:l,...o}=e;return(0,s.jsx)(a.z,{disabled:l||t,...o,className:o.className,children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.T,{size:"sm",className:"mr-2"}),r||i]}):i})}},58148:function(e,t,r){"use strict";r.d(t,{T:function(){return l}});var s=r(57437),a=r(86264),n=r(1657);let i={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"};function l(e){let{size:t="md",className:r,color:l="text-[#5B7FFF]"}=e;return(0,s.jsx)(a.Z,{className:(0,n.cn)("animate-spin",i[t],l,r)})}},77929:function(e,t,r){"use strict";r.d(t,{Cd:function(){return c},X:function(){return d},bZ:function(){return o}});var s=r(57437),a=r(2265),n=r(96061),i=r(1657);let l=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-red-500/50 text-red-200 dark:border-red-500 [&>svg]:text-red-500",warning:"border-yellow-500/50 bg-yellow-500/10 text-yellow-200 [&>svg]:text-yellow-500",info:"border-blue-500/50 bg-blue-500/10 text-blue-200 [&>svg]:text-blue-500",success:"border-green-500/50 bg-green-500/10 text-green-200 [&>svg]:text-green-500"}},defaultVariants:{variant:"default"}}),o=a.forwardRef((e,t)=>{let{className:r,variant:a,...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:a}),r),...n})});o.displayName="Alert";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})});c.displayName="AlertTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...a})});d.displayName="AlertDescription"},85754:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var s=r(57437),a=r(2265),n=r(67256),i=r(1657);let l=a.forwardRef((e,t)=>{let{className:r,variant:a="default",size:l="default",asChild:o=!1,...c}=e,d=o?n.g7:"button";return(0,s.jsx)(d,{className:(0,i.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{default:"bg-[#5B7FFF] text-white hover:bg-[#4a6fff]",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-slate-300 dark:border-[#2a2d3a] bg-transparent hover:bg-slate-100 dark:hover:bg-[#2a2d3a] text-slate-900 dark:text-white",secondary:"bg-slate-100 dark:bg-[#2a2d3a] text-slate-900 dark:text-white hover:bg-slate-200 dark:hover:bg-[#3a3d4a]",ghost:"hover:bg-slate-100 dark:hover:bg-[#2a2d3a] text-slate-900 dark:text-white",link:"text-[#5B7FFF] underline-offset-4 hover:underline"}[a],{default:"h-10 sm:h-10 px-4 py-2 min-h-[48px] sm:min-h-[40px]",sm:"h-9 sm:h-9 rounded-md px-3 min-h-[48px] sm:min-h-[36px]",lg:"h-11 sm:h-11 rounded-md px-8 min-h-[48px] sm:min-h-[44px]",icon:"h-10 w-10 sm:h-10 sm:w-10 min-h-[48px] min-w-[48px] sm:min-h-[40px] sm:min-w-[40px]"}[l],r),ref:t,...c})});l.displayName="Button"},27815:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},ll:function(){return o}});var s=r(57437),a=r(2265),n=r(1657);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border border-slate-200 dark:border-[#2a2d3a] bg-white dark:bg-[#1a1d29] text-slate-900 dark:text-white shadow-sm",r),...a})});i.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight text-slate-900 dark:text-white",r),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-slate-600 dark:text-[#94a3b8]",r),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},54900:function(e,t,r){"use strict";r.d(t,{X:function(){return o}});var s=r(57437),a=r(2265),n=r(66062),i=r(1657),l=r(62442);let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.fC,{ref:t,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-[#2a2d3a] bg-[#0f1117] ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#5B7FFF] focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-[#5B7FFF] data-[state=checked]:text-white data-[state=checked]:border-[#5B7FFF]",r),...a,children:(0,s.jsx)(n.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(l.Z,{className:"h-4 w-4"})})})});o.displayName=n.fC.displayName},45179:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var s=r(57437),a=r(2265),n=r(1657);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex w-full rounded-lg border border-slate-200 dark:border-white/10 bg-white dark:bg-white/[0.03] backdrop-blur-sm px-4 py-3 min-h-[48px] text-base text-start text-slate-900 dark:text-white/90 ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-slate-400 dark:placeholder:text-white/40 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500/30 focus-visible:ring-offset-2 focus-visible:border-indigo-500 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-300 hover:border-indigo-500/50 dark:hover:border-indigo-500/50 hover:bg-slate-50 dark:hover:bg-white/[0.05] touch-manipulation",r),ref:t,...i})});i.displayName="Input"},49842:function(e,t,r){"use strict";r.d(t,{_:function(){return i}});var s=r(57437),a=r(2265),n=r(1657);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("label",{ref:t,className:(0,n.cn)("text-sm font-medium leading-none text-white peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),...a})});i.displayName="Label"},6678:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return l},useAuthContext:function(){return o}});var s=r(57437),a=r(2265),n=r(45922);let i=(0,a.createContext)(null);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[m,f]=(0,a.useState)(!0),h=(0,a.useCallback)(async e=>{var t;let{data:r,error:s}=await n.supabase.from("users").select("role").eq("id",e).maybeSingle();return s||!r?null:null!==(t=r.role)&&void 0!==t?t:null},[]),x=(0,a.useCallback)(async()=>{try{let{data:{session:e},error:t}=await n.supabase.auth.getSession();if(t||!e){c(null),l(null),u(null);return}c(e),l(e.user),f(!1);try{let t=await h(e.user.id);u(t)}catch(e){u(null)}}catch(e){c(null),l(null),u(null)}finally{f(!1)}},[h]);(0,a.useEffect)(()=>{x();let{data:{subscription:e}}=n.supabase.auth.onAuthStateChange(async(e,t)=>{if("SIGNED_OUT"===e||!t){c(null),l(null),u(null),f(!1);return}c(t),l(t.user);try{let e=await h(t.user.id);u(e)}finally{f(!1)}}),t=setTimeout(()=>{f(e=>!e&&e)},8e3);return()=>{clearTimeout(t),e.unsubscribe()}},[x,h]);let g=(0,a.useCallback)(async()=>{f(!0),await n.supabase.auth.signOut(),c(null),l(null),u(null),f(!1)},[]),b=(0,a.useMemo)(()=>({user:r,session:o,role:d,isAdmin:"admin"===d,loading:m,signOut:g}),[r,o,d,m,g]);return(0,s.jsx)(i.Provider,{value:b,children:t})}function o(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e}},86095:function(e,t,r){"use strict";r.d(t,{a:function(){return n}});var s=r(2265),a=r(63572);function n(){let[e,t]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0),l=(0,s.useRef)(!1),o=(0,s.useRef)(!1),c=(0,s.useCallback)(async()=>{if(!l.current)try{l.current=!0;try{let{supabase:e}=await Promise.all([r.e(3226),r.e(5922)]).then(r.bind(r,45922)),{data:{session:s}}=await e.auth.getSession();if(null==s?void 0:s.user){t({id:0,email:s.user.email||""}),i(!1);return}}catch(e){}if(!(0,a.LP)()){t(null),i(!1);return}try{let e=await a.apiClient.getMe();if(e&&"object"==typeof e&&e.email)t(e);else throw Error("Invalid user data received")}catch(r){var e,s;((null==r?void 0:null===(e=r.response)||void 0===e?void 0:e.status)===401||(null==r?void 0:null===(s=r.response)||void 0===s?void 0:s.status)===403)&&((0,a.gy)(),t(null))}}catch(e){(0,a.LP)()&&(0,a.gy)(),t(null)}finally{i(!1),l.current=!1}},[]);return(0,s.useEffect)(()=>{o.current||(o.current=!0,c())},[]),(0,s.useEffect)(()=>{let e=()=>{l.current||c()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[c]),{user:e,loading:n,login:async function(e,r){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{if(!e||!r)throw Error("Email and password are required");let n=await a.apiClient.login(e,r,s||!1);if(n&&n.user&&"object"==typeof n.user)t(n.user);else throw Error("Invalid user data in response");return await c(),n}catch(e){throw console.error("[useAuth.login] Login error:",e),e}},register:async function(e,r,s,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];try{if(!e||!r)throw Error("Email and password are required");let l=await a.apiClient.register(e,r,s,n,i);return l&&l.user&&"object"==typeof l.user&&t(l.user),l}catch(e){throw console.error("Register error:",e),e}},logout:async()=>{try{t(null),await a.apiClient.logout(),(0,a.gy)()}catch(e){console.error("Logout error:",e),t(null),(0,a.gy)()}},checkAuth:c,verify:async()=>{try{let e=await a.apiClient.verifyToken();if(e&&e.valid&&e.user&&"object"==typeof e.user)return t(e.user),!0;return!1}catch(e){return console.error("Verify error:",e),t(null),!1}},isAuthenticated:!!e}}},25703:function(e,t,r){"use strict";r.r(t),r.d(t,{ToastProvider:function(){return l},useToast:function(){return o}});var s=r(57437),a=r(2265),n=r(1657);let i=a.createContext({toast:()=>{}});function l(e){let{children:t}=e,[r,l]=a.useState([]),o=a.useCallback(e=>{var t;let r=Math.random().toString(36).substring(7);l(t=>[...t,{...e,id:r}]),setTimeout(()=>{l(e=>e.filter(e=>e.id!==r))},null!==(t=e.duration)&&void 0!==t?t:5e3)},[]);return(0,s.jsxs)(i.Provider,{value:{toast:o},children:[t,(0,s.jsx)("div",{className:"fixed bottom-0 right-0 z-[1200] flex w-full flex-col-reverse gap-2 p-4 sm:flex-col md:max-w-[420px]",children:r.map(e=>(0,s.jsxs)("div",{className:(0,n.cn)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md p-6 pr-8 shadow-lg transition-all","destructive"===e.variant?"border border-red-500/50 bg-red-950/30":"border border-[#2a2d3a] bg-[#1a1d29]"),children:[(0,s.jsxs)("div",{className:"grid gap-1",children:[e.title&&(0,s.jsx)("div",{className:(0,n.cn)("text-sm font-semibold","destructive"===e.variant?"text-red-200":"text-white"),children:e.title}),e.description&&(0,s.jsx)("div",{className:(0,n.cn)("text-sm","destructive"===e.variant?"text-red-300/90":"text-[#94a3b8]"),children:e.description})]}),(0,s.jsx)("button",{onClick:()=>l(t=>t.filter(t=>t.id!==e.id)),className:"absolute right-2 top-2 rounded-md p-1 text-[#94a3b8] opacity-0 transition-opacity hover:text-white focus:opacity-100 focus:outline-none group-hover:opacity-100",children:"\xd7"})]},e.id))})]})}function o(){return a.useContext(i)||{toast:e=>{"destructive"===e.variant&&console.error("Error:",e.description)}}}},45922:function(e,t,r){"use strict";r.d(t,{supabase:function(){return s}});let s=(0,r(33226).eI)("https://fehkzrrahgyesxzrwlme.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZlaGt6cnJhaGd5ZXN4enJ3bG1lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkxNzcwNjEsImV4cCI6MjA4NDc1MzA2MX0.AI8QaX8nOP8UwcfmgbGN2EN4jmK94i98Kpd3ZtPDZRQ",{auth:{lock:(e,t,r)=>r()}})},1657:function(e,t,r){"use strict";r.d(t,{cb:function(){return d},cn:function(){return n},gQ:function(){return c},uf:function(){return l},wo:function(){return u},xG:function(){return i}});var s=r(57042),a=r(74769);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function l(e){return new Intl.NumberFormat("en-US").format(e)}function o(e){return e<=0||!isFinite(e)?0:Math.round(235.214583/e*10)/10}function c(e,t){let r=o(e),s=o(t);return"".concat(r," / ").concat(s," L/100km")}function d(e){return null!=e&&"string"==typeof e&&/\.(mp4|mov|avi)(\?|$)/i.test(e)}function u(e,t){var r;if(null==e||"string"!=typeof e||!e)return"";if(e.startsWith("http://")||e.startsWith("https://"))return e;let s=(null!==(r=null!=t?t:"http://localhost:8000")&&void 0!==r?r:"").replace(/\/$/,"");return s?s+(e.startsWith("/")?e:"/"+e):e}}},function(e){e.O(0,[7895,116,263,4829,6376,3226,1396,3802,337,3572,2971,4938,1744],function(){return e(e.s=92753)}),_N_E=e.O()}]);